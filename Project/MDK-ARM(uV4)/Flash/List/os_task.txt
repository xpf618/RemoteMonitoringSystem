; generated by Component: ARM Compiler 5.06 update 3 (build 300) Tool: ArmCC [4d35f0]
; commandline ArmCC [--list --split_sections --debug -c --asm --interleave -o.\flash\obj\os_task.o --asm_dir=.\Flash\List\ --list_dir=.\Flash\List\ --depend=.\flash\obj\os_task.d --cpu=Cortex-M3 --apcs=interwork -O0 --diag_suppress=9931,870 -I..\..\Libraries\CMSIS\Device\ST\STM32F10x\Include -I..\..\Libraries\STM32F10x_StdPeriph_Driver\inc -I..\..\User\bsp -I..\..\User\bsp\inc -I..\..\User -I..\..\Libraries\CMSIS\Include -I..\..\uCOS-III\uC-CPU -I..\..\uCOS-III\uC-CPU\ARM-Cortex-M3\RealView -I..\..\uCOS-III\uC-LIB -I..\..\uCOS-III\uC-LIB\Ports\ARM-Cortex-M3\RealView -I..\..\uCOS-III\uCOS-III\Source -I..\..\uCOS-III\uCOS-III\Ports\ARM-Cortex-M3\RealView -IH:\½øÐÐÊ±\CS_System_Program\Project\MDK-ARM(uV4)\RTE -ID:\Keil_v5\ARM\PACK\ARM\CMSIS\4.5.0\CMSIS\Include -ID:\Keil_v5\ARM\PACK\Keil\STM32F1xx_DFP\2.0.0\Device\Include -D__MICROLIB -D__UVISION_VERSION=521 -D_RTE_ -DSTM32F10X_HD -DUSE_STDPERIPH_DRIVER -DSTM32F10X_HD --omf_browse=.\flash\obj\os_task.crf ..\..\uCOS-III\uCOS-III\Source\os_task.c]
                          THUMB

                          AREA ||i.OSTaskChangePrio||, CODE, READONLY, ALIGN=2

                  OSTaskChangePrio PROC
;;;70     #if (OS_CFG_TASK_CHANGE_PRIO_EN == DEF_ENABLED)
;;;71     void  OSTaskChangePrio (OS_TCB   *p_tcb,
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;72                             OS_PRIO   prio_new,
;;;73                             OS_ERR   *p_err)
;;;74     {
000004  4604              MOV      r4,r0
000006  460e              MOV      r6,r1
000008  4615              MOV      r5,r2
;;;75     #if (OS_CFG_MUTEX_EN == DEF_ENABLED)
;;;76         OS_PRIO  prio_high;
;;;77     #endif
;;;78         CPU_SR_ALLOC();
00000a  f04f0800          MOV      r8,#0
;;;79     
;;;80     
;;;81     #ifdef OS_SAFETY_CRITICAL
;;;82         if (p_err == DEF_NULL) {
;;;83             OS_SAFETY_CRITICAL_EXCEPTION();
;;;84             return;
;;;85         }
;;;86     #endif
;;;87     
;;;88     #if (OS_CFG_ARG_CHK_EN == DEF_ENABLED)
;;;89         if ((p_tcb != DEF_NULL) && (p_tcb->TaskState == OS_TASK_STATE_DEL)) {
00000e  b144              CBZ      r4,|L1.34|
000010  f8940036          LDRB     r0,[r4,#0x36]
000014  28ff              CMP      r0,#0xff
000016  d104              BNE      |L1.34|
;;;90            *p_err = OS_ERR_STATE_INVALID;
000018  f646602d          MOV      r0,#0x6e2d
00001c  8028              STRH     r0,[r5,#0]
                  |L1.30|
;;;91             return;
;;;92         }
;;;93     #endif
;;;94     
;;;95     #if (OS_CFG_CALLED_FROM_ISR_CHK_EN == DEF_ENABLED)
;;;96         if (OSIntNestingCtr > 0u) {                                 /* Not allowed to call from an ISR                      */
;;;97            *p_err = OS_ERR_TASK_CHANGE_PRIO_ISR;
;;;98             return;
;;;99         }
;;;100    #endif
;;;101    
;;;102    #if (OS_CFG_ISR_POST_DEFERRED_EN == DEF_ENABLED)
;;;103        if (prio_new == 0u) {                                        /* Cannot set to IntQueue Task priority                 */
;;;104           *p_err = OS_ERR_PRIO_INVALID;
;;;105            return;
;;;106        }
;;;107    #endif
;;;108    
;;;109        if (prio_new >= (OS_CFG_PRIO_MAX - 1u)) {                   /* Cannot set to Idle Task priority                     */
;;;110           *p_err = OS_ERR_PRIO_INVALID;
;;;111            return;
;;;112        }
;;;113    
;;;114        OS_CRITICAL_ENTER();
;;;115    
;;;116        if (p_tcb == DEF_NULL) {                                    /* Are we changing the priority of 'self'?              */
;;;117            if (OSRunning != OS_STATE_OS_RUNNING) {
;;;118                OS_CRITICAL_EXIT();
;;;119               *p_err = OS_ERR_OS_NOT_RUNNING;
;;;120                return;
;;;121            }
;;;122            p_tcb = OSTCBCurPtr;
;;;123        }
;;;124    
;;;125    #if (OS_CFG_MUTEX_EN == DEF_ENABLED)
;;;126        p_tcb->BasePrio = prio_new;                                 /* Update base priority                                 */
;;;127    
;;;128        if (p_tcb->MutexGrpHeadPtr != DEF_NULL) {                   /* Owning a mutex?                                      */
;;;129            if (prio_new > p_tcb->Prio) {
;;;130                prio_high = OS_MutexGrpPrioFindHighest(p_tcb);
;;;131                if (prio_new > prio_high) {
;;;132                    prio_new = prio_high;
;;;133                }
;;;134            }
;;;135        }
;;;136    #endif
;;;137    
;;;138        OS_TaskChangePrio(p_tcb, prio_new);
;;;139    
;;;140        OS_CRITICAL_EXIT_NO_SCHED();
;;;141    
;;;142        if (OSRunning == OS_STATE_OS_RUNNING) {
;;;143            OSSched();                                              /* Run highest priority task ready                      */
;;;144        }
;;;145    
;;;146       *p_err = OS_ERR_NONE;
;;;147    }
00001e  e8bd81f0          POP      {r4-r8,pc}
                  |L1.34|
000022  4828              LDR      r0,|L1.196|
000024  7800              LDRB     r0,[r0,#0]            ;96  ; OSIntNestingCtr
000026  b118              CBZ      r0,|L1.48|
000028  f2471049          MOV      r0,#0x7149            ;97
00002c  8028              STRH     r0,[r5,#0]            ;97
00002e  e7f6              B        |L1.30|
                  |L1.48|
000030  2e1f              CMP      r6,#0x1f              ;109
000032  d303              BCC      |L1.60|
000034  f2462073          MOV      r0,#0x6273            ;110
000038  8028              STRH     r0,[r5,#0]            ;110
00003a  e7f0              B        |L1.30|
                  |L1.60|
00003c  bf00              NOP                            ;114
00003e  bf00              NOP                            ;114
000040  f7fffffe          BL       CPU_SR_Save
000044  4680              MOV      r8,r0                 ;114
000046  bf00              NOP                            ;114
000048  f7fffffe          BL       CPU_IntDisMeasStart
00004c  bf00              NOP                            ;114
00004e  b994              CBNZ     r4,|L1.118|
000050  481d              LDR      r0,|L1.200|
000052  7800              LDRB     r0,[r0,#0]            ;117  ; OSRunning
000054  2801              CMP      r0,#1                 ;117
000056  d00c              BEQ      |L1.114|
000058  bf00              NOP                            ;118
00005a  f7fffffe          BL       CPU_IntDisMeasStop
00005e  bf00              NOP                            ;118
000060  4640              MOV      r0,r8                 ;118
000062  f7fffffe          BL       CPU_SR_Restore
000066  bf00              NOP                            ;118
000068  bf00              NOP                            ;118
00006a  f6456089          MOV      r0,#0x5e89            ;119
00006e  8028              STRH     r0,[r5,#0]            ;119
000070  e7d5              B        |L1.30|
                  |L1.114|
000072  4816              LDR      r0,|L1.204|
000074  6804              LDR      r4,[r0,#0]            ;122  ; OSTCBCurPtr
                  |L1.118|
000076  f8846038          STRB     r6,[r4,#0x38]         ;126
00007a  6be0              LDR      r0,[r4,#0x3c]         ;128
00007c  b150              CBZ      r0,|L1.148|
00007e  f8940037          LDRB     r0,[r4,#0x37]         ;129
000082  42b0              CMP      r0,r6                 ;129
000084  da06              BGE      |L1.148|
000086  4620              MOV      r0,r4                 ;130
000088  f7fffffe          BL       OS_MutexGrpPrioFindHighest
00008c  4607              MOV      r7,r0                 ;130
00008e  42be              CMP      r6,r7                 ;131
000090  dd00              BLE      |L1.148|
000092  463e              MOV      r6,r7                 ;132
                  |L1.148|
000094  4631              MOV      r1,r6                 ;138
000096  4620              MOV      r0,r4                 ;138
000098  f7fffffe          BL       OS_TaskChangePrio
00009c  bf00              NOP                            ;140
00009e  f7fffffe          BL       CPU_IntDisMeasStop
0000a2  bf00              NOP                            ;140
0000a4  4640              MOV      r0,r8                 ;140
0000a6  f7fffffe          BL       CPU_SR_Restore
0000aa  bf00              NOP                            ;140
0000ac  bf00              NOP                            ;140
0000ae  4806              LDR      r0,|L1.200|
0000b0  7800              LDRB     r0,[r0,#0]            ;142  ; OSRunning
0000b2  2801              CMP      r0,#1                 ;142
0000b4  d101              BNE      |L1.186|
0000b6  f7fffffe          BL       OSSched
                  |L1.186|
0000ba  2000              MOVS     r0,#0                 ;146
0000bc  8028              STRH     r0,[r5,#0]            ;146
0000be  bf00              NOP      
0000c0  e7ad              B        |L1.30|
;;;148    #endif
                          ENDP

0000c2  0000              DCW      0x0000
                  |L1.196|
                          DCD      OSIntNestingCtr
                  |L1.200|
                          DCD      OSRunning
                  |L1.204|
                          DCD      OSTCBCurPtr

                          AREA ||i.OSTaskCreate||, CODE, READONLY, ALIGN=2

                  OSTaskCreate PROC
;;;239    
;;;240    void  OSTaskCreate (OS_TCB        *p_tcb,
000000  e92d4fff          PUSH     {r0-r11,lr}
;;;241                        CPU_CHAR      *p_name,
;;;242                        OS_TASK_PTR    p_task,
;;;243                        void          *p_arg,
;;;244                        OS_PRIO        prio,
;;;245                        CPU_STK       *p_stk_base,
;;;246                        CPU_STK_SIZE   stk_limit,
;;;247                        CPU_STK_SIZE   stk_size,
;;;248                        OS_MSG_QTY     q_size,
;;;249                        OS_TICK        time_quanta,
;;;250                        void          *p_ext,
;;;251                        OS_OPT         opt,
;;;252                        OS_ERR        *p_err)
;;;253    {
000004  b087              SUB      sp,sp,#0x1c
000006  4604              MOV      r4,r0
000008  4692              MOV      r10,r2
00000a  e9ddb614          LDRD     r11,r6,[sp,#0x50]
00000e  e9dd851b          LDRD     r8,r5,[sp,#0x6c]
000012  9f17              LDR      r7,[sp,#0x5c]
;;;254        CPU_STK_SIZE   i;
;;;255    #if (OS_CFG_TASK_REG_TBL_SIZE > 0u)
;;;256        OS_REG_ID      reg_nbr;
;;;257    #endif
;;;258    #if defined(OS_CFG_TLS_TBL_SIZE) && (OS_CFG_TLS_TBL_SIZE > 0u)
;;;259        OS_TLS_ID      id;
;;;260    #endif
;;;261    
;;;262        CPU_STK       *p_sp;
;;;263        CPU_STK       *p_stk_limit;
;;;264        CPU_SR_ALLOC();
000014  2000              MOVS     r0,#0
000016  9003              STR      r0,[sp,#0xc]
;;;265    
;;;266    
;;;267    
;;;268    #ifdef OS_SAFETY_CRITICAL
;;;269        if (p_err == DEF_NULL) {
;;;270            OS_SAFETY_CRITICAL_EXCEPTION();
;;;271            return;
;;;272        }
;;;273    #endif
;;;274    
;;;275    #ifdef OS_SAFETY_CRITICAL_IEC61508
;;;276        if (OSSafetyCriticalStartFlag == DEF_TRUE) {
;;;277           *p_err = OS_ERR_ILLEGAL_CREATE_RUN_TIME;
;;;278            return;
;;;279        }
;;;280    #endif
;;;281    
;;;282    #if (OS_CFG_CALLED_FROM_ISR_CHK_EN == DEF_ENABLED)
;;;283        if (OSIntNestingCtr > 0u) {                                 /* --------- CANNOT CREATE A TASK FROM AN ISR --------- */
000018  4864              LDR      r0,|L2.428|
00001a  7800              LDRB     r0,[r0,#0]  ; OSIntNestingCtr
00001c  b128              CBZ      r0,|L2.42|
;;;284    #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;285            TRACE_OS_TASK_CREATE_FAILED(p_tcb);                     /* Record the event.                                    */
;;;286    #endif
;;;287           *p_err = OS_ERR_TASK_CREATE_ISR;
00001e  f247104a          MOV      r0,#0x714a
000022  8028              STRH     r0,[r5,#0]
                  |L2.36|
;;;288            return;
;;;289        }
;;;290    #endif
;;;291    
;;;292    #if (OS_CFG_ARG_CHK_EN == DEF_ENABLED)                          /* ---------------- VALIDATE ARGUMENTS ---------------- */
;;;293        if (p_tcb == DEF_NULL) {                                    /* User must supply a valid OS_TCB                      */
;;;294    #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;295            TRACE_OS_TASK_CREATE_FAILED(p_tcb);                     /* Record the event.                                    */
;;;296    #endif
;;;297           *p_err = OS_ERR_TCB_INVALID;
;;;298            return;
;;;299        }
;;;300        if (p_task == 0u) {                                         /* User must supply a valid task                        */
;;;301    #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;302            TRACE_OS_TASK_CREATE_FAILED(p_tcb);                     /* Record the event.                                    */
;;;303    #endif
;;;304           *p_err = OS_ERR_TASK_INVALID;
;;;305            return;
;;;306        }
;;;307        if (p_stk_base == DEF_NULL) {                               /* User must supply a valid stack base address          */
;;;308    #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;309            TRACE_OS_TASK_CREATE_FAILED(p_tcb);                     /* Record the event.                                    */
;;;310    #endif
;;;311           *p_err = OS_ERR_STK_INVALID;
;;;312            return;
;;;313        }
;;;314        if (stk_size < OSCfg_StkSizeMin) {                          /* User must supply a valid minimum stack size          */
;;;315    #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;316            TRACE_OS_TASK_CREATE_FAILED(p_tcb);                     /* Record the event.                                    */
;;;317    #endif
;;;318           *p_err = OS_ERR_STK_SIZE_INVALID;
;;;319            return;
;;;320        }
;;;321        if (stk_limit >= stk_size) {                                /* User must supply a valid stack limit                 */
;;;322    #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;323            TRACE_OS_TASK_CREATE_FAILED(p_tcb);                     /* Record the event.                                    */
;;;324    #endif
;;;325           *p_err = OS_ERR_STK_LIMIT_INVALID;
;;;326            return;
;;;327        }
;;;328        if (prio >= OS_CFG_PRIO_MAX) {                              /* Priority must be within 0 and OS_CFG_PRIO_MAX-1      */
;;;329    #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;330            TRACE_OS_TASK_CREATE_FAILED(p_tcb);                     /* Record the event.                                    */
;;;331    #endif
;;;332           *p_err = OS_ERR_PRIO_INVALID;
;;;333            return;
;;;334        }
;;;335    #endif
;;;336    
;;;337    #if (OS_CFG_ISR_POST_DEFERRED_EN == DEF_ENABLED)
;;;338        if (prio == 0u) {
;;;339            if (p_tcb != &OSIntQTaskTCB) {
;;;340    #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;341                TRACE_OS_TASK_CREATE_FAILED(p_tcb);                 /* Record the event.                                    */
;;;342    #endif
;;;343               *p_err = OS_ERR_PRIO_INVALID;                        /* Not allowed to use priority 0                        */
;;;344                return;
;;;345            }
;;;346        }
;;;347    #endif
;;;348    
;;;349        if (prio == (OS_CFG_PRIO_MAX - 1u)) {
;;;350    #if (OS_CFG_TASK_IDLE_EN == DEF_ENABLED)
;;;351            if (p_tcb != &OSIdleTaskTCB) {
;;;352    #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;353                TRACE_OS_TASK_CREATE_FAILED(p_tcb);                 /* Record the event.                                    */
;;;354    #endif
;;;355               *p_err = OS_ERR_PRIO_INVALID;                        /* Not allowed to use same priority as idle task        */
;;;356                return;
;;;357            }
;;;358    #else
;;;359    #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;360            TRACE_OS_TASK_CREATE_FAILED(p_tcb);                     /* Record the event.                                    */
;;;361    #endif
;;;362           *p_err = OS_ERR_PRIO_INVALID;                            /* Not allowed to use same priority as idle task        */
;;;363            return;
;;;364    #endif
;;;365        }
;;;366    
;;;367        OS_TaskInitTCB(p_tcb);                                      /* Initialize the TCB to default values                 */
;;;368    
;;;369       *p_err = OS_ERR_NONE;
;;;370                                                                    /* -------------- CLEAR THE TASK'S STACK -------------- */
;;;371        if (((opt & OS_OPT_TASK_STK_CHK) != 0u) ||                  /* See if stack checking has been enabled               */
;;;372            ((opt & OS_OPT_TASK_STK_CLR) != 0u)) {                  /* See if stack needs to be cleared                     */
;;;373            if ((opt & OS_OPT_TASK_STK_CLR) != 0u) {
;;;374                p_sp = p_stk_base;
;;;375                for (i = 0u; i < stk_size; i++) {                   /* Stack grows from HIGH to LOW memory                  */
;;;376                   *p_sp = 0u;                                      /* Clear from bottom of stack and up!                   */
;;;377                    p_sp++;
;;;378                }
;;;379            }
;;;380        }
;;;381                                                                    /* ------ INITIALIZE THE STACK FRAME OF THE TASK ------ */
;;;382    #if (CPU_CFG_STK_GROWTH == CPU_STK_GROWTH_HI_TO_LO)
;;;383        p_stk_limit = p_stk_base + stk_limit;
;;;384    #else
;;;385        p_stk_limit = p_stk_base + (stk_size - 1u) - stk_limit;
;;;386    #endif
;;;387    
;;;388        p_sp = OSTaskStkInit(p_task,
;;;389                             p_arg,
;;;390                             p_stk_base,
;;;391                             p_stk_limit,
;;;392                             stk_size,
;;;393                             opt);
;;;394    
;;;395    #if (CPU_CFG_STK_GROWTH == CPU_STK_GROWTH_HI_TO_LO)             /* Check if we overflown the stack during init          */
;;;396        if (p_sp < p_stk_base) {
;;;397           *p_err = OS_ERR_STAT_STK_SIZE_INVALID;
;;;398            return;
;;;399        }
;;;400    #else
;;;401        if (p_sp > p_stk_base + stk_size) {
;;;402           *p_err = OS_ERR_STAT_STK_SIZE_INVALID;
;;;403            return;
;;;404        }
;;;405    #endif
;;;406    
;;;407    #if (OS_CFG_TASK_STK_REDZONE_EN == DEF_ENABLED)                 /* Initialize Redzoned stack                            */
;;;408        OS_TaskStkRedzoneInit(p_stk_base, stk_size);
;;;409    #endif
;;;410    
;;;411                                                                    /* ------------ INITIALIZE THE TCB FIELDS ------------- */
;;;412    #if (OS_CFG_DBG_EN == DEF_ENABLED)
;;;413        p_tcb->TaskEntryAddr = p_task;                              /* Save task entry point address                        */
;;;414        p_tcb->TaskEntryArg  = p_arg;                               /* Save task entry argument                             */
;;;415    #endif
;;;416    
;;;417    #if (OS_CFG_DBG_EN == DEF_ENABLED)
;;;418        p_tcb->NamePtr       = p_name;                              /* Save task name                                       */
;;;419    #else
;;;420        (void)&p_name;
;;;421    #endif
;;;422    
;;;423        p_tcb->Prio          = prio;                                /* Save the task's priority                             */
;;;424    
;;;425    #if (OS_CFG_MUTEX_EN == DEF_ENABLED)
;;;426        p_tcb->BasePrio      = prio;                                /* Set the base priority                                */
;;;427    #endif
;;;428    
;;;429        p_tcb->StkPtr        = p_sp;                                /* Save the new top-of-stack pointer                    */
;;;430    #if ((OS_CFG_DBG_EN == DEF_ENABLED) || (OS_CFG_STAT_TASK_STK_CHK_EN == DEF_ENABLED))
;;;431        p_tcb->StkLimitPtr   = p_stk_limit;                         /* Save the stack limit pointer                         */
;;;432    #endif
;;;433    
;;;434    #if (OS_CFG_SCHED_ROUND_ROBIN_EN == DEF_ENABLED)
;;;435        p_tcb->TimeQuanta    = time_quanta;                         /* Save the #ticks for time slice (0 means not sliced)  */
;;;436        if (time_quanta == 0u) {
;;;437            p_tcb->TimeQuantaCtr = OSSchedRoundRobinDfltTimeQuanta;
;;;438        } else {
;;;439            p_tcb->TimeQuantaCtr = time_quanta;
;;;440        }
;;;441    #else
;;;442        (void)&time_quanta;
;;;443    #endif
;;;444    
;;;445        p_tcb->ExtPtr        = p_ext;                               /* Save pointer to TCB extension                        */
;;;446    #if ((OS_CFG_DBG_EN == DEF_ENABLED) || (OS_CFG_STAT_TASK_STK_CHK_EN == DEF_ENABLED) || (OS_CFG_TASK_STK_REDZONE_EN == DEF_ENABLED))
;;;447        p_tcb->StkBasePtr    = p_stk_base;                          /* Save pointer to the base address of the stack        */
;;;448        p_tcb->StkSize       = stk_size;                            /* Save the stack size (in number of CPU_STK elements)  */
;;;449    #endif
;;;450        p_tcb->Opt           = opt;                                 /* Save task options                                    */
;;;451    
;;;452    #if (OS_CFG_TASK_REG_TBL_SIZE > 0u)
;;;453        for (reg_nbr = 0u; reg_nbr < OS_CFG_TASK_REG_TBL_SIZE; reg_nbr++) {
;;;454            p_tcb->RegTbl[reg_nbr] = 0u;
;;;455        }
;;;456    #endif
;;;457    
;;;458    #if (OS_CFG_TASK_Q_EN == DEF_ENABLED)
;;;459        OS_MsgQInit(&p_tcb->MsgQ,                                   /* Initialize the task's message queue                  */
;;;460                    q_size);
;;;461    #else
;;;462        (void)&q_size;
;;;463    #endif
;;;464    
;;;465        OSTaskCreateHook(p_tcb);                                    /* Call user defined hook                               */
;;;466    
;;;467    #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;468        TRACE_OS_TASK_CREATE(p_tcb);                                /* Record the event.                                    */
;;;469        TRACE_OS_TASK_SEM_CREATE(p_tcb, p_name);                    /* Record the event.                                    */
;;;470    #if (OS_CFG_TASK_Q_EN == DEF_ENABLED)
;;;471        TRACE_OS_TASK_MSG_Q_CREATE(&p_tcb->MsgQ, p_name);           /* Record the event.                                    */
;;;472    #endif
;;;473    #endif
;;;474    
;;;475    #if defined(OS_CFG_TLS_TBL_SIZE) && (OS_CFG_TLS_TBL_SIZE > 0u)
;;;476        for (id = 0u; id < OS_CFG_TLS_TBL_SIZE; id++) {
;;;477            p_tcb->TLS_Tbl[id] = 0u;
;;;478        }
;;;479        OS_TLS_TaskCreate(p_tcb);                                   /* Call TLS hook                                        */
;;;480    #endif
;;;481                                                                    /* -------------- ADD TASK TO READY LIST -------------- */
;;;482        OS_CRITICAL_ENTER();
;;;483        OS_PrioInsert(p_tcb->Prio);
;;;484        OS_RdyListInsertTail(p_tcb);
;;;485    
;;;486    #if (OS_CFG_DBG_EN == DEF_ENABLED)
;;;487        OS_TaskDbgListAdd(p_tcb);
;;;488    #endif
;;;489    
;;;490        OSTaskQty++;                                                /* Increment the #tasks counter                         */
;;;491    
;;;492        if (OSRunning != OS_STATE_OS_RUNNING) {                     /* Return if multitasking has not started               */
;;;493            OS_CRITICAL_EXIT();
;;;494            return;
;;;495        }
;;;496    
;;;497        OS_CRITICAL_EXIT_NO_SCHED();
;;;498    
;;;499        OSSched();
;;;500    }
000024  b00b              ADD      sp,sp,#0x2c
000026  e8bd8ff0          POP      {r4-r11,pc}
                  |L2.42|
00002a  b91c              CBNZ     r4,|L2.52|
00002c  f24710ad          MOV      r0,#0x71ad            ;297
000030  8028              STRH     r0,[r5,#0]            ;297
000032  e7f7              B        |L2.36|
                  |L2.52|
000034  f1ba0f00          CMP      r10,#0                ;300
000038  d103              BNE      |L2.66|
00003a  f247104f          MOV      r0,#0x714f            ;304
00003e  8028              STRH     r0,[r5,#0]            ;304
000040  e7f0              B        |L2.36|
                  |L2.66|
000042  b91e              CBNZ     r6,|L2.76|
000044  f646602f          MOV      r0,#0x6e2f            ;311
000048  8028              STRH     r0,[r5,#0]            ;311
00004a  e7eb              B        |L2.36|
                  |L2.76|
00004c  4858              LDR      r0,|L2.432|
00004e  6800              LDR      r0,[r0,#0]            ;314  ; OSCfg_StkSizeMin
000050  4287              CMP      r7,r0                 ;314
000052  d203              BCS      |L2.92|
000054  f6466030          MOV      r0,#0x6e30            ;318
000058  8028              STRH     r0,[r5,#0]            ;318
00005a  e7e3              B        |L2.36|
                  |L2.92|
00005c  9816              LDR      r0,[sp,#0x58]         ;321
00005e  42b8              CMP      r0,r7                 ;321
000060  d303              BCC      |L2.106|
000062  f6466031          MOV      r0,#0x6e31            ;325
000066  8028              STRH     r0,[r5,#0]            ;325
000068  e7dc              B        |L2.36|
                  |L2.106|
00006a  f1bb0f20          CMP      r11,#0x20             ;328
00006e  d303              BCC      |L2.120|
000070  f2462073          MOV      r0,#0x6273            ;332
000074  8028              STRH     r0,[r5,#0]            ;332
000076  e7d5              B        |L2.36|
                  |L2.120|
000078  f1bb0f1f          CMP      r11,#0x1f             ;349
00007c  d106              BNE      |L2.140|
00007e  484d              LDR      r0,|L2.436|
000080  4284              CMP      r4,r0                 ;351
000082  d003              BEQ      |L2.140|
000084  f2462073          MOV      r0,#0x6273            ;355
000088  8028              STRH     r0,[r5,#0]            ;355
00008a  e7cb              B        |L2.36|
                  |L2.140|
00008c  4620              MOV      r0,r4                 ;367
00008e  f7fffffe          BL       OS_TaskInitTCB
000092  2000              MOVS     r0,#0                 ;369
000094  8028              STRH     r0,[r5,#0]            ;369
000096  f0080001          AND      r0,r8,#1              ;371
00009a  b910              CBNZ     r0,|L2.162|
00009c  f0080002          AND      r0,r8,#2              ;372
0000a0  b188              CBZ      r0,|L2.198|
                  |L2.162|
0000a2  f0080002          AND      r0,r8,#2              ;373
0000a6  b170              CBZ      r0,|L2.198|
0000a8  46b1              MOV      r9,r6                 ;374
0000aa  2000              MOVS     r0,#0                 ;375
0000ac  9006              STR      r0,[sp,#0x18]         ;375
0000ae  e007              B        |L2.192|
                  |L2.176|
0000b0  2000              MOVS     r0,#0                 ;376
0000b2  f8c90000          STR      r0,[r9,#0]            ;376
0000b6  f1090904          ADD      r9,r9,#4              ;377
0000ba  9806              LDR      r0,[sp,#0x18]         ;375
0000bc  1c40              ADDS     r0,r0,#1              ;375
0000be  9006              STR      r0,[sp,#0x18]         ;375
                  |L2.192|
0000c0  9806              LDR      r0,[sp,#0x18]         ;375
0000c2  42b8              CMP      r0,r7                 ;375
0000c4  d3f4              BCC      |L2.176|
                  |L2.198|
0000c6  9816              LDR      r0,[sp,#0x58]         ;383
0000c8  eb060080          ADD      r0,r6,r0,LSL #2       ;383
0000cc  9004              STR      r0,[sp,#0x10]         ;383
0000ce  e9cd7800          STRD     r7,r8,[sp,#0]         ;388
0000d2  4632              MOV      r2,r6                 ;388
0000d4  4650              MOV      r0,r10                ;388
0000d6  9b04              LDR      r3,[sp,#0x10]         ;388
0000d8  990a              LDR      r1,[sp,#0x28]         ;388
0000da  f7fffffe          BL       OSTaskStkInit
0000de  4681              MOV      r9,r0                 ;388
0000e0  45b1              CMP      r9,r6                 ;396
0000e2  d203              BCS      |L2.236|
0000e4  f646602c          MOV      r0,#0x6e2c            ;397
0000e8  8028              STRH     r0,[r5,#0]            ;397
0000ea  e79b              B        |L2.36|
                  |L2.236|
0000ec  f8c4a028          STR      r10,[r4,#0x28]        ;413
0000f0  980a              LDR      r0,[sp,#0x28]         ;414
0000f2  62e0              STR      r0,[r4,#0x2c]         ;414
0000f4  9808              LDR      r0,[sp,#0x20]         ;418
0000f6  60a0              STR      r0,[r4,#8]            ;418
0000f8  f884b037          STRB     r11,[r4,#0x37]        ;423
0000fc  f884b038          STRB     r11,[r4,#0x38]        ;426
000100  f8c49000          STR      r9,[r4,#0]            ;429
000104  9804              LDR      r0,[sp,#0x10]         ;431
000106  60e0              STR      r0,[r4,#0xc]          ;431
000108  981a              LDR      r0,[sp,#0x68]         ;445
00010a  6060              STR      r0,[r4,#4]            ;445
00010c  6266              STR      r6,[r4,#0x24]         ;447
00010e  6427              STR      r7,[r4,#0x40]         ;448
000110  f8a48044          STRH     r8,[r4,#0x44]         ;450
000114  2000              MOVS     r0,#0                 ;453
000116  9005              STR      r0,[sp,#0x14]         ;453
000118  e009              B        |L2.302|
                  |L2.282|
00011a  2200              MOVS     r2,#0                 ;454
00011c  f1040078          ADD      r0,r4,#0x78           ;454
000120  9905              LDR      r1,[sp,#0x14]         ;454
000122  f8402021          STR      r2,[r0,r1,LSL #2]     ;454
000126  9805              LDR      r0,[sp,#0x14]         ;453
000128  1c40              ADDS     r0,r0,#1              ;453
00012a  b2c0              UXTB     r0,r0                 ;453
00012c  9005              STR      r0,[sp,#0x14]         ;453
                  |L2.302|
00012e  9805              LDR      r0,[sp,#0x14]         ;453
000130  2800              CMP      r0,#0                 ;453
000132  d0f2              BEQ      |L2.282|
000134  f1040060          ADD      r0,r4,#0x60           ;459
000138  9918              LDR      r1,[sp,#0x60]         ;459
00013a  f7fffffe          BL       OS_MsgQInit
00013e  4620              MOV      r0,r4                 ;465
000140  f7fffffe          BL       OSTaskCreateHook
000144  bf00              NOP                            ;482
000146  bf00              NOP                            ;482
000148  f7fffffe          BL       CPU_SR_Save
00014c  9003              STR      r0,[sp,#0xc]          ;482
00014e  bf00              NOP                            ;482
000150  f7fffffe          BL       CPU_IntDisMeasStart
000154  bf00              NOP                            ;482
000156  f8940037          LDRB     r0,[r4,#0x37]         ;483
00015a  f7fffffe          BL       OS_PrioInsert
00015e  4620              MOV      r0,r4                 ;484
000160  f7fffffe          BL       OS_RdyListInsertTail
000164  4620              MOV      r0,r4                 ;487
000166  f7fffffe          BL       OS_TaskDbgListAdd
00016a  4813              LDR      r0,|L2.440|
00016c  8800              LDRH     r0,[r0,#0]            ;490  ; OSTaskQty
00016e  1c40              ADDS     r0,r0,#1              ;490
000170  4911              LDR      r1,|L2.440|
000172  8008              STRH     r0,[r1,#0]            ;490
000174  4811              LDR      r0,|L2.444|
000176  7800              LDRB     r0,[r0,#0]            ;492  ; OSRunning
000178  2801              CMP      r0,#1                 ;492
00017a  d009              BEQ      |L2.400|
00017c  bf00              NOP                            ;493
00017e  f7fffffe          BL       CPU_IntDisMeasStop
000182  bf00              NOP                            ;493
000184  9803              LDR      r0,[sp,#0xc]          ;493
000186  f7fffffe          BL       CPU_SR_Restore
00018a  bf00              NOP                            ;493
00018c  bf00              NOP                            ;493
00018e  e749              B        |L2.36|
                  |L2.400|
000190  bf00              NOP                            ;497
000192  f7fffffe          BL       CPU_IntDisMeasStop
000196  bf00              NOP                            ;497
000198  9803              LDR      r0,[sp,#0xc]          ;497
00019a  f7fffffe          BL       CPU_SR_Restore
00019e  bf00              NOP                            ;497
0001a0  bf00              NOP                            ;497
0001a2  f7fffffe          BL       OSSched
0001a6  bf00              NOP      
0001a8  e73c              B        |L2.36|
;;;501    
                          ENDP

0001aa  0000              DCW      0x0000
                  |L2.428|
                          DCD      OSIntNestingCtr
                  |L2.432|
                          DCD      OSCfg_StkSizeMin
                  |L2.436|
                          DCD      OSIdleTaskTCB
                  |L2.440|
                          DCD      OSTaskQty
                  |L2.444|
                          DCD      OSRunning

                          AREA ||i.OSTaskQFlush||, CODE, READONLY, ALIGN=2

                  OSTaskQFlush PROC
;;;728    #if (OS_CFG_TASK_Q_EN == DEF_ENABLED)
;;;729    OS_MSG_QTY  OSTaskQFlush (OS_TCB  *p_tcb,
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;730                              OS_ERR  *p_err)
;;;731    {
000004  4604              MOV      r4,r0
000006  460d              MOV      r5,r1
;;;732        OS_MSG_QTY  entries;
;;;733        CPU_SR_ALLOC();
000008  2600              MOVS     r6,#0
;;;734    
;;;735    
;;;736    
;;;737    #ifdef OS_SAFETY_CRITICAL
;;;738        if (p_err == DEF_NULL) {
;;;739            OS_SAFETY_CRITICAL_EXCEPTION();
;;;740            return (0u);
;;;741        }
;;;742    #endif
;;;743    
;;;744    #if (OS_CFG_CALLED_FROM_ISR_CHK_EN == DEF_ENABLED)
;;;745        if (OSIntNestingCtr > 0u) {                                 /* Can't flush a message queue from an ISR              */
00000a  481c              LDR      r0,|L3.124|
00000c  7800              LDRB     r0,[r0,#0]  ; OSIntNestingCtr
00000e  b128              CBZ      r0,|L3.28|
;;;746           *p_err = OS_ERR_FLUSH_ISR;
000010  f44f506c          MOV      r0,#0x3b00
000014  8028              STRH     r0,[r5,#0]
;;;747            return (0u);
000016  2000              MOVS     r0,#0
                  |L3.24|
;;;748        }
;;;749    #endif
;;;750    
;;;751    #if (OS_CFG_INVALID_OS_CALLS_CHK_EN == DEF_ENABLED)             /* Is the kernel running?                               */
;;;752        if (OSRunning != OS_STATE_OS_RUNNING) {
;;;753           *p_err = OS_ERR_OS_NOT_RUNNING;
;;;754            return (0u);
;;;755        }
;;;756    #endif
;;;757    
;;;758        if (p_tcb == DEF_NULL) {                                    /* Flush message queue of calling task?                 */
;;;759            CPU_CRITICAL_ENTER();
;;;760            p_tcb = OSTCBCurPtr;
;;;761            CPU_CRITICAL_EXIT();
;;;762        }
;;;763    
;;;764        OS_CRITICAL_ENTER();
;;;765        entries = OS_MsgQFreeAll(&p_tcb->MsgQ);                     /* Return all OS_MSGs to the OS_MSG pool                */
;;;766        OS_CRITICAL_EXIT();
;;;767       *p_err   = OS_ERR_NONE;
;;;768        return (entries);
;;;769    }
000018  e8bd81f0          POP      {r4-r8,pc}
                  |L3.28|
00001c  b99c              CBNZ     r4,|L3.70|
00001e  bf00              NOP                            ;759
000020  bf00              NOP                            ;759
000022  f7fffffe          BL       CPU_SR_Save
000026  4606              MOV      r6,r0                 ;759
000028  bf00              NOP                            ;759
00002a  f7fffffe          BL       CPU_IntDisMeasStart
00002e  bf00              NOP                            ;759
000030  4813              LDR      r0,|L3.128|
000032  6804              LDR      r4,[r0,#0]            ;760  ; OSTCBCurPtr
000034  bf00              NOP                            ;761
000036  f7fffffe          BL       CPU_IntDisMeasStop
00003a  bf00              NOP                            ;761
00003c  4630              MOV      r0,r6                 ;761
00003e  f7fffffe          BL       CPU_SR_Restore
000042  bf00              NOP                            ;761
000044  bf00              NOP                            ;761
                  |L3.70|
000046  bf00              NOP                            ;764
000048  bf00              NOP                            ;764
00004a  f7fffffe          BL       CPU_SR_Save
00004e  4606              MOV      r6,r0                 ;764
000050  bf00              NOP                            ;764
000052  f7fffffe          BL       CPU_IntDisMeasStart
000056  bf00              NOP                            ;764
000058  f1040060          ADD      r0,r4,#0x60           ;765
00005c  f7fffffe          BL       OS_MsgQFreeAll
000060  4607              MOV      r7,r0                 ;765
000062  bf00              NOP                            ;766
000064  f7fffffe          BL       CPU_IntDisMeasStop
000068  bf00              NOP                            ;766
00006a  4630              MOV      r0,r6                 ;766
00006c  f7fffffe          BL       CPU_SR_Restore
000070  bf00              NOP                            ;766
000072  bf00              NOP                            ;766
000074  2000              MOVS     r0,#0                 ;767
000076  8028              STRH     r0,[r5,#0]            ;767
000078  4638              MOV      r0,r7                 ;768
00007a  e7cd              B        |L3.24|
;;;770    #endif
                          ENDP

                  |L3.124|
                          DCD      OSIntNestingCtr
                  |L3.128|
                          DCD      OSTCBCurPtr

                          AREA ||i.OSTaskQPend||, CODE, READONLY, ALIGN=2

                  OSTaskQPend PROC
;;;815    #if (OS_CFG_TASK_Q_EN == DEF_ENABLED)
;;;816    void  *OSTaskQPend (OS_TICK       timeout,
000000  e92d5ff0          PUSH     {r4-r12,lr}
;;;817                        OS_OPT        opt,
;;;818                        OS_MSG_SIZE  *p_msg_size,
;;;819                        CPU_TS       *p_ts,
;;;820                        OS_ERR       *p_err)
;;;821    {
000004  4680              MOV      r8,r0
000006  460f              MOV      r7,r1
000008  4616              MOV      r6,r2
00000a  461c              MOV      r4,r3
00000c  9d0a              LDR      r5,[sp,#0x28]
;;;822        OS_MSG_Q     *p_msg_q;
;;;823        void         *p_void;
;;;824        CPU_SR_ALLOC();
00000e  f04f0b00          MOV      r11,#0
;;;825    
;;;826    
;;;827    #ifdef OS_SAFETY_CRITICAL
;;;828        if (p_err == DEF_NULL) {
;;;829            OS_SAFETY_CRITICAL_EXCEPTION();
;;;830            return (DEF_NULL);
;;;831        }
;;;832    #endif
;;;833    
;;;834    #if (OS_CFG_CALLED_FROM_ISR_CHK_EN == DEF_ENABLED)
;;;835        if (OSIntNestingCtr > 0u) {                                 /* Can't Pend from an ISR                               */
000012  4874              LDR      r0,|L4.484|
000014  7800              LDRB     r0,[r0,#0]  ; OSIntNestingCtr
000016  b128              CBZ      r0,|L4.36|
;;;836           *p_err = OS_ERR_PEND_ISR;
000018  f24610ae          MOV      r0,#0x61ae
00001c  8028              STRH     r0,[r5,#0]
;;;837            return (DEF_NULL);
00001e  2000              MOVS     r0,#0
                  |L4.32|
;;;838        }
;;;839    #endif
;;;840    
;;;841    #if (OS_CFG_INVALID_OS_CALLS_CHK_EN == DEF_ENABLED)             /* Is the kernel running?                               */
;;;842        if (OSRunning != OS_STATE_OS_RUNNING) {
;;;843           *p_err = OS_ERR_OS_NOT_RUNNING;
;;;844            return (DEF_NULL);
;;;845        }
;;;846    #endif
;;;847    
;;;848    #if (OS_CFG_ARG_CHK_EN == DEF_ENABLED)                          /* ---------------- VALIDATE ARGUMENTS ---------------- */
;;;849        if (p_msg_size == DEF_NULL) {                               /* User must supply a valid destination for msg size    */
;;;850           *p_err = OS_ERR_PTR_INVALID;
;;;851            return (DEF_NULL);
;;;852        }
;;;853        switch (opt) {                                              /* User must supply a valid option                      */
;;;854            case OS_OPT_PEND_BLOCKING:
;;;855            case OS_OPT_PEND_NON_BLOCKING:
;;;856                 break;
;;;857    
;;;858            default:
;;;859                *p_err = OS_ERR_OPT_INVALID;
;;;860                 return (DEF_NULL);
;;;861        }
;;;862    #endif
;;;863    
;;;864        if (p_ts != DEF_NULL) {
;;;865           *p_ts = 0u;                                              /* Initialize the returned timestamp                    */
;;;866        }
;;;867    
;;;868        CPU_CRITICAL_ENTER();
;;;869        p_msg_q = &OSTCBCurPtr->MsgQ;                               /* Any message waiting in the message queue?            */
;;;870        p_void  = OS_MsgQGet(p_msg_q,
;;;871                             p_msg_size,
;;;872                             p_ts,
;;;873                             p_err);
;;;874        if (*p_err == OS_ERR_NONE) {
;;;875    #if (OS_CFG_TASK_PROFILE_EN == DEF_ENABLED)
;;;876    #if (OS_CFG_TS_EN == DEF_ENABLED)
;;;877            if (p_ts != DEF_NULL) {
;;;878                OSTCBCurPtr->MsgQPendTime = OS_TS_GET() - *p_ts;
;;;879                if (OSTCBCurPtr->MsgQPendTimeMax < OSTCBCurPtr->MsgQPendTime) {
;;;880                    OSTCBCurPtr->MsgQPendTimeMax = OSTCBCurPtr->MsgQPendTime;
;;;881                }
;;;882            }
;;;883    #endif
;;;884    #endif
;;;885            CPU_CRITICAL_EXIT();
;;;886    #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;887            TRACE_OS_TASK_MSG_Q_PEND(p_msg_q);                      /* Record the event.                                    */
;;;888    #endif
;;;889            return (p_void);                                        /* Yes, Return oldest message received                  */
;;;890        }
;;;891    
;;;892        if ((opt & OS_OPT_PEND_NON_BLOCKING) != 0u) {               /* Caller wants to block if not available?              */
;;;893           *p_err = OS_ERR_PEND_WOULD_BLOCK;                        /* No                                                   */
;;;894            CPU_CRITICAL_EXIT();
;;;895    #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;896            TRACE_OS_TASK_MSG_Q_PEND_FAILED(p_msg_q);               /* Record the event.                                    */
;;;897    #endif
;;;898            return (DEF_NULL);
;;;899        } else {                                                    /* Yes                                                  */
;;;900            if (OSSchedLockNestingCtr > 0u) {                       /* Can't block when the scheduler is locked             */
;;;901                CPU_CRITICAL_EXIT();
;;;902    #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;903                TRACE_OS_TASK_MSG_Q_PEND_FAILED(p_msg_q);           /* Record the event.                                    */
;;;904    #endif
;;;905               *p_err = OS_ERR_SCHED_LOCKED;
;;;906                return (DEF_NULL);
;;;907            }
;;;908        }
;;;909                                                                    /* Lock the scheduler/re-enable interrupts              */
;;;910        OS_CRITICAL_ENTER_CPU_EXIT();
;;;911        OS_Pend(DEF_NULL,                                           /* Block task pending on Message                        */
;;;912                DEF_NULL,
;;;913                OS_TASK_PEND_ON_TASK_Q,
;;;914                timeout);
;;;915        OS_CRITICAL_EXIT_NO_SCHED();
;;;916    #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;917        TRACE_OS_TASK_MSG_Q_PEND_BLOCK(p_msg_q);                    /* Record the event.                                    */
;;;918    #endif
;;;919        OSSched();                                                  /* Find the next highest priority task ready to run     */
;;;920    
;;;921        CPU_CRITICAL_ENTER();
;;;922        switch (OSTCBCurPtr->PendStatus) {
;;;923            case OS_STATUS_PEND_OK:                                 /* Extract message from TCB (Put there by Post)         */
;;;924                 p_void      = OSTCBCurPtr->MsgPtr;
;;;925                *p_msg_size  = OSTCBCurPtr->MsgSize;
;;;926    #if (OS_CFG_TS_EN == DEF_ENABLED)
;;;927                 if (p_ts != DEF_NULL) {
;;;928                    *p_ts = OSTCBCurPtr->TS;
;;;929    #if (OS_CFG_TASK_PROFILE_EN == DEF_ENABLED)
;;;930                    OSTCBCurPtr->MsgQPendTime = OS_TS_GET() - OSTCBCurPtr->TS;
;;;931                    if (OSTCBCurPtr->MsgQPendTimeMax < OSTCBCurPtr->MsgQPendTime) {
;;;932                        OSTCBCurPtr->MsgQPendTimeMax = OSTCBCurPtr->MsgQPendTime;
;;;933                    }
;;;934    #endif
;;;935                 }
;;;936    #endif
;;;937    #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;938                 TRACE_OS_TASK_MSG_Q_PEND(p_msg_q);                 /* Record the event.                                    */
;;;939    #endif
;;;940                *p_err = OS_ERR_NONE;
;;;941                 break;
;;;942    
;;;943            case OS_STATUS_PEND_ABORT:                              /* Indicate that we aborted                             */
;;;944                 p_void     = DEF_NULL;
;;;945                *p_msg_size = 0u;
;;;946                 if (p_ts != DEF_NULL) {
;;;947                    *p_ts = 0u;
;;;948                 }
;;;949    #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;950                 TRACE_OS_TASK_MSG_Q_PEND_FAILED(p_msg_q);          /* Record the event.                                    */
;;;951    #endif
;;;952                *p_err      =  OS_ERR_PEND_ABORT;
;;;953                 break;
;;;954    
;;;955            case OS_STATUS_PEND_TIMEOUT:                            /* Indicate that we didn't get event within TO          */
;;;956            default:
;;;957                 p_void     = DEF_NULL;
;;;958                *p_msg_size = 0u;
;;;959    #if (OS_CFG_TS_EN == DEF_ENABLED)
;;;960                 if (p_ts  != DEF_NULL) {
;;;961                    *p_ts = OSTCBCurPtr->TS;
;;;962                 }
;;;963    #endif
;;;964    #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;965                 TRACE_OS_TASK_MSG_Q_PEND_FAILED(p_msg_q);          /* Record the event.                                    */
;;;966    #endif
;;;967                *p_err      =  OS_ERR_TIMEOUT;
;;;968                 break;
;;;969        }
;;;970        CPU_CRITICAL_EXIT();
;;;971        return (p_void);                                            /* Return received message                              */
;;;972    }
000020  e8bd9ff0          POP      {r4-r12,pc}
                  |L4.36|
000024  b926              CBNZ     r6,|L4.48|
000026  f24620d5          MOV      r0,#0x62d5            ;850
00002a  8028              STRH     r0,[r5,#0]            ;850
00002c  2000              MOVS     r0,#0                 ;851
00002e  e7f7              B        |L4.32|
                  |L4.48|
000030  b11f              CBZ      r7,|L4.58|
000032  f5b74f00          CMP      r7,#0x8000            ;853
000036  d102              BNE      |L4.62|
000038  e000              B        |L4.60|
                  |L4.58|
00003a  bf00              NOP                            ;855
                  |L4.60|
00003c  e004              B        |L4.72|
                  |L4.62|
00003e  f6456025          MOV      r0,#0x5e25            ;859
000042  8028              STRH     r0,[r5,#0]            ;859
000044  2000              MOVS     r0,#0                 ;860
000046  e7eb              B        |L4.32|
                  |L4.72|
000048  bf00              NOP                            ;856
00004a  b10c              CBZ      r4,|L4.80|
00004c  2000              MOVS     r0,#0                 ;865
00004e  6020              STR      r0,[r4,#0]            ;865
                  |L4.80|
000050  bf00              NOP                            ;868
000052  bf00              NOP                            ;868
000054  f7fffffe          BL       CPU_SR_Save
000058  4683              MOV      r11,r0                ;868
00005a  bf00              NOP                            ;868
00005c  f7fffffe          BL       CPU_IntDisMeasStart
000060  bf00              NOP                            ;868
000062  4861              LDR      r0,|L4.488|
000064  6800              LDR      r0,[r0,#0]            ;869  ; OSTCBCurPtr
000066  f1000960          ADD      r9,r0,#0x60           ;869
00006a  462b              MOV      r3,r5                 ;870
00006c  4622              MOV      r2,r4                 ;870
00006e  4631              MOV      r1,r6                 ;870
000070  4648              MOV      r0,r9                 ;870
000072  f7fffffe          BL       OS_MsgQGet
000076  4682              MOV      r10,r0                ;870
000078  8828              LDRH     r0,[r5,#0]            ;874
00007a  bb00              CBNZ     r0,|L4.190|
00007c  b1a4              CBZ      r4,|L4.168|
00007e  f7fffffe          BL       CPU_TS_TmrRd
000082  6821              LDR      r1,[r4,#0]            ;878
000084  1a40              SUBS     r0,r0,r1              ;878
000086  4958              LDR      r1,|L4.488|
000088  6809              LDR      r1,[r1,#0]            ;878  ; OSTCBCurPtr
00008a  6708              STR      r0,[r1,#0x70]         ;878
00008c  4856              LDR      r0,|L4.488|
00008e  6800              LDR      r0,[r0,#0]            ;879  ; OSTCBCurPtr
000090  6f40              LDR      r0,[r0,#0x74]         ;879
000092  4955              LDR      r1,|L4.488|
000094  6809              LDR      r1,[r1,#0]            ;879  ; OSTCBCurPtr
000096  6f09              LDR      r1,[r1,#0x70]         ;879
000098  4288              CMP      r0,r1                 ;879
00009a  d205              BCS      |L4.168|
00009c  4852              LDR      r0,|L4.488|
00009e  6800              LDR      r0,[r0,#0]            ;880  ; OSTCBCurPtr
0000a0  6f00              LDR      r0,[r0,#0x70]         ;880
0000a2  4951              LDR      r1,|L4.488|
0000a4  6809              LDR      r1,[r1,#0]            ;880  ; OSTCBCurPtr
0000a6  6748              STR      r0,[r1,#0x74]         ;880
                  |L4.168|
0000a8  bf00              NOP                            ;885
0000aa  f7fffffe          BL       CPU_IntDisMeasStop
0000ae  bf00              NOP                            ;885
0000b0  4658              MOV      r0,r11                ;885
0000b2  f7fffffe          BL       CPU_SR_Restore
0000b6  bf00              NOP                            ;885
0000b8  bf00              NOP                            ;885
0000ba  4650              MOV      r0,r10                ;889
0000bc  e7b0              B        |L4.32|
                  |L4.190|
0000be  f4074000          AND      r0,r7,#0x8000         ;892
0000c2  b168              CBZ      r0,|L4.224|
0000c4  f24610b0          MOV      r0,#0x61b0            ;893
0000c8  8028              STRH     r0,[r5,#0]            ;893
0000ca  bf00              NOP                            ;894
0000cc  f7fffffe          BL       CPU_IntDisMeasStop
0000d0  bf00              NOP                            ;894
0000d2  4658              MOV      r0,r11                ;894
0000d4  f7fffffe          BL       CPU_SR_Restore
0000d8  bf00              NOP                            ;894
0000da  bf00              NOP                            ;894
0000dc  2000              MOVS     r0,#0                 ;898
0000de  e79f              B        |L4.32|
                  |L4.224|
0000e0  4842              LDR      r0,|L4.492|
0000e2  7800              LDRB     r0,[r0,#0]            ;900  ; OSSchedLockNestingCtr
0000e4  b168              CBZ      r0,|L4.258|
0000e6  bf00              NOP                            ;901
0000e8  f7fffffe          BL       CPU_IntDisMeasStop
0000ec  bf00              NOP                            ;901
0000ee  4658              MOV      r0,r11                ;901
0000f0  f7fffffe          BL       CPU_SR_Restore
0000f4  bf00              NOP                            ;901
0000f6  bf00              NOP                            ;901
0000f8  f6465063          MOV      r0,#0x6d63            ;905
0000fc  8028              STRH     r0,[r5,#0]            ;905
0000fe  2000              MOVS     r0,#0                 ;906
000100  e78e              B        |L4.32|
                  |L4.258|
000102  4643              MOV      r3,r8                 ;911
000104  2202              MOVS     r2,#2                 ;911
000106  2100              MOVS     r1,#0                 ;911
000108  4608              MOV      r0,r1                 ;911
00010a  f7fffffe          BL       OS_Pend
00010e  bf00              NOP                            ;915
000110  f7fffffe          BL       CPU_IntDisMeasStop
000114  bf00              NOP                            ;915
000116  4658              MOV      r0,r11                ;915
000118  f7fffffe          BL       CPU_SR_Restore
00011c  bf00              NOP                            ;915
00011e  bf00              NOP                            ;915
000120  f7fffffe          BL       OSSched
000124  bf00              NOP                            ;921
000126  bf00              NOP                            ;921
000128  f7fffffe          BL       CPU_SR_Save
00012c  4683              MOV      r11,r0                ;921
00012e  bf00              NOP                            ;921
000130  f7fffffe          BL       CPU_IntDisMeasStart
000134  bf00              NOP                            ;921
000136  482c              LDR      r0,|L4.488|
000138  6800              LDR      r0,[r0,#0]            ;922  ; OSTCBCurPtr
00013a  f8900035          LDRB     r0,[r0,#0x35]         ;922
00013e  b120              CBZ      r0,|L4.330|
000140  2801              CMP      r0,#1                 ;922
000142  d02a              BEQ      |L4.410|
000144  2803              CMP      r0,#3                 ;922
000146  d132              BNE      |L4.430|
000148  e032              B        |L4.432|
                  |L4.330|
00014a  4827              LDR      r0,|L4.488|
00014c  6800              LDR      r0,[r0,#0]            ;924  ; OSTCBCurPtr
00014e  f8d0a058          LDR      r10,[r0,#0x58]        ;924
000152  4825              LDR      r0,|L4.488|
000154  6800              LDR      r0,[r0,#0]            ;925  ; OSTCBCurPtr
000156  f8b0005c          LDRH     r0,[r0,#0x5c]         ;925
00015a  8030              STRH     r0,[r6,#0]            ;925
00015c  b1d4              CBZ      r4,|L4.404|
00015e  4822              LDR      r0,|L4.488|
000160  6800              LDR      r0,[r0,#0]            ;928  ; OSTCBCurPtr
000162  6c80              LDR      r0,[r0,#0x48]         ;928
000164  6020              STR      r0,[r4,#0]            ;928
000166  f7fffffe          BL       CPU_TS_TmrRd
00016a  491f              LDR      r1,|L4.488|
00016c  6809              LDR      r1,[r1,#0]            ;930  ; OSTCBCurPtr
00016e  6c89              LDR      r1,[r1,#0x48]         ;930
000170  1a40              SUBS     r0,r0,r1              ;930
000172  491d              LDR      r1,|L4.488|
000174  6809              LDR      r1,[r1,#0]            ;930  ; OSTCBCurPtr
000176  6708              STR      r0,[r1,#0x70]         ;930
000178  481b              LDR      r0,|L4.488|
00017a  6800              LDR      r0,[r0,#0]            ;931  ; OSTCBCurPtr
00017c  6f40              LDR      r0,[r0,#0x74]         ;931
00017e  491a              LDR      r1,|L4.488|
000180  6809              LDR      r1,[r1,#0]            ;931  ; OSTCBCurPtr
000182  6f09              LDR      r1,[r1,#0x70]         ;931
000184  4288              CMP      r0,r1                 ;931
000186  d205              BCS      |L4.404|
000188  4817              LDR      r0,|L4.488|
00018a  6800              LDR      r0,[r0,#0]            ;932  ; OSTCBCurPtr
00018c  6f00              LDR      r0,[r0,#0x70]         ;932
00018e  4916              LDR      r1,|L4.488|
000190  6809              LDR      r1,[r1,#0]            ;932  ; OSTCBCurPtr
000192  6748              STR      r0,[r1,#0x74]         ;932
                  |L4.404|
000194  2000              MOVS     r0,#0                 ;940
000196  8028              STRH     r0,[r5,#0]            ;940
000198  e017              B        |L4.458|
                  |L4.410|
00019a  f04f0a00          MOV      r10,#0                ;944
00019e  2000              MOVS     r0,#0                 ;945
0001a0  8030              STRH     r0,[r6,#0]            ;945
0001a2  b104              CBZ      r4,|L4.422|
0001a4  6020              STR      r0,[r4,#0]            ;947
                  |L4.422|
0001a6  f24610a9          MOV      r0,#0x61a9            ;952
0001aa  8028              STRH     r0,[r5,#0]            ;952
0001ac  e00d              B        |L4.458|
                  |L4.430|
0001ae  bf00              NOP                            ;955
                  |L4.432|
0001b0  f04f0a00          MOV      r10,#0                ;957
0001b4  2000              MOVS     r0,#0                 ;958
0001b6  8030              STRH     r0,[r6,#0]            ;958
0001b8  b11c              CBZ      r4,|L4.450|
0001ba  480b              LDR      r0,|L4.488|
0001bc  6800              LDR      r0,[r0,#0]            ;961  ; OSTCBCurPtr
0001be  6c80              LDR      r0,[r0,#0x48]         ;961
0001c0  6020              STR      r0,[r4,#0]            ;961
                  |L4.450|
0001c2  f24720d9          MOV      r0,#0x72d9            ;967
0001c6  8028              STRH     r0,[r5,#0]            ;967
0001c8  bf00              NOP                            ;968
                  |L4.458|
0001ca  bf00              NOP                            ;941
0001cc  bf00              NOP                            ;970
0001ce  f7fffffe          BL       CPU_IntDisMeasStop
0001d2  bf00              NOP                            ;970
0001d4  4658              MOV      r0,r11                ;970
0001d6  f7fffffe          BL       CPU_SR_Restore
0001da  bf00              NOP                            ;970
0001dc  bf00              NOP                            ;970
0001de  4650              MOV      r0,r10                ;971
0001e0  e71e              B        |L4.32|
;;;973    #endif
                          ENDP

0001e2  0000              DCW      0x0000
                  |L4.484|
                          DCD      OSIntNestingCtr
                  |L4.488|
                          DCD      OSTCBCurPtr
                  |L4.492|
                          DCD      OSSchedLockNestingCtr

                          AREA ||i.OSTaskQPost||, CODE, READONLY, ALIGN=1

                  OSTaskQPost PROC
;;;1127   #if (OS_CFG_TASK_Q_EN == DEF_ENABLED)
;;;1128   void  OSTaskQPost (OS_TCB       *p_tcb,
000000  e92d47fc          PUSH     {r2-r10,lr}
;;;1129                      void         *p_void,
;;;1130                      OS_MSG_SIZE   msg_size,
;;;1131                      OS_OPT        opt,
;;;1132                      OS_ERR       *p_err)
;;;1133   {
000004  4607              MOV      r7,r0
000006  4688              MOV      r8,r1
000008  4691              MOV      r9,r2
00000a  461c              MOV      r4,r3
00000c  9d0a              LDR      r5,[sp,#0x28]
;;;1134       CPU_TS   ts;
;;;1135   
;;;1136   
;;;1137   
;;;1138   #ifdef OS_SAFETY_CRITICAL
;;;1139       if (p_err == DEF_NULL) {
;;;1140           OS_SAFETY_CRITICAL_EXCEPTION();
;;;1141           return;
;;;1142       }
;;;1143   #endif
;;;1144   
;;;1145   #if (OS_CFG_INVALID_OS_CALLS_CHK_EN == DEF_ENABLED)             /* Is the kernel running?                               */
;;;1146       if (OSRunning != OS_STATE_OS_RUNNING) {
;;;1147          *p_err = OS_ERR_OS_NOT_RUNNING;
;;;1148           return;
;;;1149       }
;;;1150   #endif
;;;1151   
;;;1152   #if (OS_CFG_ARG_CHK_EN == DEF_ENABLED)                          /* ---------------- VALIDATE ARGUMENTS ---------------- */
;;;1153       switch (opt) {                                              /* User must supply a valid option                      */
00000e  b14c              CBZ      r4,|L5.36|
000010  2c10              CMP      r4,#0x10
000012  d008              BEQ      |L5.38|
000014  f5b44f00          CMP      r4,#0x8000
000018  d006              BEQ      |L5.40|
00001a  f5a44000          SUB      r0,r4,#0x8000
00001e  3810              SUBS     r0,r0,#0x10
000020  b920              CBNZ     r0,|L5.44|
000022  e002              B        |L5.42|
                  |L5.36|
;;;1154           case OS_OPT_POST_FIFO:
;;;1155           case OS_OPT_POST_LIFO:
000024  bf00              NOP      
                  |L5.38|
;;;1156           case OS_OPT_POST_FIFO | OS_OPT_POST_NO_SCHED:
000026  bf00              NOP      
                  |L5.40|
;;;1157           case OS_OPT_POST_LIFO | OS_OPT_POST_NO_SCHED:
000028  bf00              NOP      
                  |L5.42|
;;;1158                break;
00002a  e004              B        |L5.54|
                  |L5.44|
;;;1159   
;;;1160           default:
;;;1161   #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;1162                TRACE_OS_TASK_MSG_Q_POST_FAILED(&p_tcb->MsgQ);     /* Record the event.                                    */
;;;1163   #endif
;;;1164               *p_err = OS_ERR_OPT_INVALID;
00002c  f6456025          MOV      r0,#0x5e25
000030  8028              STRH     r0,[r5,#0]
                  |L5.50|
;;;1165                return;
;;;1166       }
;;;1167   #endif
;;;1168   
;;;1169   #if (OS_CFG_TS_EN == DEF_ENABLED)
;;;1170       ts = OS_TS_GET();                                           /* Get timestamp                                        */
;;;1171   #else
;;;1172       ts = 0u;
;;;1173   #endif
;;;1174   
;;;1175   #if (OS_CFG_ISR_POST_DEFERRED_EN == DEF_ENABLED)
;;;1176       if (OSIntNestingCtr > 0u) {
;;;1177           OS_IntQPost(OS_OBJ_TYPE_TASK_MSG,                       /* Post to ISR queue                                    */
;;;1178                       p_tcb,
;;;1179                       p_void,
;;;1180                       msg_size,
;;;1181                       0u,
;;;1182                       opt,
;;;1183                       ts,
;;;1184                       p_err);
;;;1185           return;
;;;1186       }
;;;1187   #endif
;;;1188   
;;;1189   #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;1190       TRACE_OS_TASK_MSG_Q_POST(&p_tcb->MsgQ);                     /* Record the event.                                    */
;;;1191   #endif
;;;1192   
;;;1193       OS_TaskQPost(p_tcb,
;;;1194                    p_void,
;;;1195                    msg_size,
;;;1196                    opt,
;;;1197                    ts,
;;;1198                    p_err);
;;;1199   }
000032  e8bd87fc          POP      {r2-r10,pc}
                  |L5.54|
000036  bf00              NOP                            ;1158
000038  f7fffffe          BL       CPU_TS_TmrRd
00003c  4606              MOV      r6,r0                 ;1170
00003e  4623              MOV      r3,r4                 ;1193
000040  464a              MOV      r2,r9                 ;1193
000042  4641              MOV      r1,r8                 ;1193
000044  4638              MOV      r0,r7                 ;1193
000046  e9cd6500          STRD     r6,r5,[sp,#0]         ;1193
00004a  f7fffffe          BL       OS_TaskQPost
00004e  bf00              NOP      
000050  e7ef              B        |L5.50|
;;;1200   #endif
                          ENDP


                          AREA ||i.OSTaskRegGet||, CODE, READONLY, ALIGN=2

                  OSTaskRegGet PROC
;;;1228   #if (OS_CFG_TASK_REG_TBL_SIZE > 0u)
;;;1229   OS_REG  OSTaskRegGet (OS_TCB     *p_tcb,
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;1230                         OS_REG_ID   id,
;;;1231                         OS_ERR     *p_err)
;;;1232   {
000004  4604              MOV      r4,r0
000006  460d              MOV      r5,r1
000008  4616              MOV      r6,r2
;;;1233       OS_REG     value;
;;;1234       CPU_SR_ALLOC();
00000a  f04f0800          MOV      r8,#0
;;;1235   
;;;1236   
;;;1237   
;;;1238   #ifdef OS_SAFETY_CRITICAL
;;;1239       if (p_err == DEF_NULL) {
;;;1240           OS_SAFETY_CRITICAL_EXCEPTION();
;;;1241           return (0u);
;;;1242       }
;;;1243   #endif
;;;1244   
;;;1245   #if (OS_CFG_ARG_CHK_EN == DEF_ENABLED)
;;;1246       if (id >= OS_CFG_TASK_REG_TBL_SIZE) {
00000e  b12d              CBZ      r5,|L6.28|
;;;1247          *p_err = OS_ERR_REG_ID_INVALID;
000010  f6461079          MOV      r0,#0x6979
000014  8030              STRH     r0,[r6,#0]
;;;1248           return (0u);
000016  2000              MOVS     r0,#0
                  |L6.24|
;;;1249       }
;;;1250   #endif
;;;1251   
;;;1252       CPU_CRITICAL_ENTER();
;;;1253       if (p_tcb == DEF_NULL) {
;;;1254           p_tcb = OSTCBCurPtr;
;;;1255       }
;;;1256       value = p_tcb->RegTbl[id];
;;;1257       CPU_CRITICAL_EXIT();
;;;1258      *p_err = OS_ERR_NONE;
;;;1259       return (value);
;;;1260   }
000018  e8bd81f0          POP      {r4-r8,pc}
                  |L6.28|
00001c  bf00              NOP                            ;1252
00001e  bf00              NOP                            ;1252
000020  f7fffffe          BL       CPU_SR_Save
000024  4680              MOV      r8,r0                 ;1252
000026  bf00              NOP                            ;1252
000028  f7fffffe          BL       CPU_IntDisMeasStart
00002c  bf00              NOP                            ;1252
00002e  b90c              CBNZ     r4,|L6.52|
000030  4809              LDR      r0,|L6.88|
000032  6804              LDR      r4,[r0,#0]            ;1254  ; OSTCBCurPtr
                  |L6.52|
000034  f1040078          ADD      r0,r4,#0x78           ;1256
000038  f8507025          LDR      r7,[r0,r5,LSL #2]     ;1256
00003c  bf00              NOP                            ;1257
00003e  f7fffffe          BL       CPU_IntDisMeasStop
000042  bf00              NOP                            ;1257
000044  4640              MOV      r0,r8                 ;1257
000046  f7fffffe          BL       CPU_SR_Restore
00004a  bf00              NOP                            ;1257
00004c  bf00              NOP                            ;1257
00004e  2000              MOVS     r0,#0                 ;1258
000050  8030              STRH     r0,[r6,#0]            ;1258
000052  4638              MOV      r0,r7                 ;1259
000054  e7e0              B        |L6.24|
;;;1261   #endif
                          ENDP

000056  0000              DCW      0x0000
                  |L6.88|
                          DCD      OSTCBCurPtr

                          AREA ||i.OSTaskRegGetID||, CODE, READONLY, ALIGN=2

                  OSTaskRegGetID PROC
;;;1283   #if (OS_CFG_TASK_REG_TBL_SIZE > 0u)
;;;1284   OS_REG_ID  OSTaskRegGetID (OS_ERR  *p_err)
000000  b570              PUSH     {r4-r6,lr}
;;;1285   {
000002  4604              MOV      r4,r0
;;;1286       OS_REG_ID  id;
;;;1287       CPU_SR_ALLOC();
000004  2600              MOVS     r6,#0
;;;1288   
;;;1289   
;;;1290   
;;;1291   #ifdef OS_SAFETY_CRITICAL
;;;1292       if (p_err == DEF_NULL) {
;;;1293           OS_SAFETY_CRITICAL_EXCEPTION();
;;;1294           return ((OS_REG_ID)OS_CFG_TASK_REG_TBL_SIZE);
;;;1295       }
;;;1296   #endif
;;;1297   
;;;1298       CPU_CRITICAL_ENTER();
000006  bf00              NOP      
000008  bf00              NOP      
00000a  f7fffffe          BL       CPU_SR_Save
00000e  4606              MOV      r6,r0
000010  bf00              NOP      
000012  f7fffffe          BL       CPU_IntDisMeasStart
000016  bf00              NOP      
;;;1299       if (OSTaskRegNextAvailID >= OS_CFG_TASK_REG_TBL_SIZE) {     /* See if we exceeded the number of IDs available       */
000018  4811              LDR      r0,|L7.96|
00001a  7800              LDRB     r0,[r0,#0]  ; OSTaskRegNextAvailID
00001c  b168              CBZ      r0,|L7.58|
;;;1300          *p_err = OS_ERR_NO_MORE_ID_AVAIL;                        /* Yes, cannot allocate more task register IDs          */
00001e  f64510da          MOV      r0,#0x59da
000022  8020              STRH     r0,[r4,#0]
;;;1301           CPU_CRITICAL_EXIT();
000024  bf00              NOP      
000026  f7fffffe          BL       CPU_IntDisMeasStop
00002a  bf00              NOP      
00002c  4630              MOV      r0,r6
00002e  f7fffffe          BL       CPU_SR_Restore
000032  bf00              NOP      
000034  bf00              NOP      
;;;1302           return (OS_CFG_TASK_REG_TBL_SIZE);
000036  2001              MOVS     r0,#1
                  |L7.56|
;;;1303       }
;;;1304   
;;;1305       id    = OSTaskRegNextAvailID;                               /* Assign the next available ID                         */
;;;1306       OSTaskRegNextAvailID++;                                     /* Increment available ID for next request              */
;;;1307       CPU_CRITICAL_EXIT();
;;;1308      *p_err = OS_ERR_NONE;
;;;1309       return (id);
;;;1310   }
000038  bd70              POP      {r4-r6,pc}
                  |L7.58|
00003a  4809              LDR      r0,|L7.96|
00003c  7805              LDRB     r5,[r0,#0]            ;1305  ; OSTaskRegNextAvailID
00003e  7800              LDRB     r0,[r0,#0]            ;1306  ; OSTaskRegNextAvailID
000040  1c40              ADDS     r0,r0,#1              ;1306
000042  4907              LDR      r1,|L7.96|
000044  7008              STRB     r0,[r1,#0]            ;1306
000046  bf00              NOP                            ;1307
000048  f7fffffe          BL       CPU_IntDisMeasStop
00004c  bf00              NOP                            ;1307
00004e  4630              MOV      r0,r6                 ;1307
000050  f7fffffe          BL       CPU_SR_Restore
000054  bf00              NOP                            ;1307
000056  bf00              NOP                            ;1307
000058  2000              MOVS     r0,#0                 ;1308
00005a  8020              STRH     r0,[r4,#0]            ;1308
00005c  4628              MOV      r0,r5                 ;1309
00005e  e7eb              B        |L7.56|
;;;1311   #endif
                          ENDP

                  |L7.96|
                          DCD      OSTaskRegNextAvailID

                          AREA ||i.OSTaskRegSet||, CODE, READONLY, ALIGN=2

                  OSTaskRegSet PROC
;;;1341   #if (OS_CFG_TASK_REG_TBL_SIZE > 0u)
;;;1342   void  OSTaskRegSet (OS_TCB     *p_tcb,
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;1343                       OS_REG_ID   id,
;;;1344                       OS_REG      value,
;;;1345                       OS_ERR     *p_err)
;;;1346   {
000004  4604              MOV      r4,r0
000006  460d              MOV      r5,r1
000008  4617              MOV      r7,r2
00000a  461e              MOV      r6,r3
;;;1347       CPU_SR_ALLOC();
00000c  f04f0800          MOV      r8,#0
;;;1348   
;;;1349   
;;;1350   
;;;1351   #ifdef OS_SAFETY_CRITICAL
;;;1352       if (p_err == DEF_NULL) {
;;;1353           OS_SAFETY_CRITICAL_EXCEPTION();
;;;1354           return;
;;;1355       }
;;;1356   #endif
;;;1357   
;;;1358   #if (OS_CFG_ARG_CHK_EN == DEF_ENABLED)
;;;1359       if (id >= OS_CFG_TASK_REG_TBL_SIZE) {
000010  b125              CBZ      r5,|L8.28|
;;;1360          *p_err = OS_ERR_REG_ID_INVALID;
000012  f6461079          MOV      r0,#0x6979
000016  8030              STRH     r0,[r6,#0]
                  |L8.24|
;;;1361           return;
;;;1362       }
;;;1363   #endif
;;;1364   
;;;1365       CPU_CRITICAL_ENTER();
;;;1366       if (p_tcb == DEF_NULL) {
;;;1367           p_tcb = OSTCBCurPtr;
;;;1368       }
;;;1369       p_tcb->RegTbl[id] = value;
;;;1370       CPU_CRITICAL_EXIT();
;;;1371      *p_err             = OS_ERR_NONE;
;;;1372   }
000018  e8bd81f0          POP      {r4-r8,pc}
                  |L8.28|
00001c  bf00              NOP                            ;1365
00001e  bf00              NOP                            ;1365
000020  f7fffffe          BL       CPU_SR_Save
000024  4680              MOV      r8,r0                 ;1365
000026  bf00              NOP                            ;1365
000028  f7fffffe          BL       CPU_IntDisMeasStart
00002c  bf00              NOP                            ;1365
00002e  b90c              CBNZ     r4,|L8.52|
000030  4809              LDR      r0,|L8.88|
000032  6804              LDR      r4,[r0,#0]            ;1367  ; OSTCBCurPtr
                  |L8.52|
000034  f1040078          ADD      r0,r4,#0x78           ;1369
000038  f8407025          STR      r7,[r0,r5,LSL #2]     ;1369
00003c  bf00              NOP                            ;1370
00003e  f7fffffe          BL       CPU_IntDisMeasStop
000042  bf00              NOP                            ;1370
000044  4640              MOV      r0,r8                 ;1370
000046  f7fffffe          BL       CPU_SR_Restore
00004a  bf00              NOP                            ;1370
00004c  bf00              NOP                            ;1370
00004e  2000              MOVS     r0,#0                 ;1371
000050  8030              STRH     r0,[r6,#0]            ;1371
000052  bf00              NOP      
000054  e7e0              B        |L8.24|
;;;1373   #endif
                          ENDP

000056  0000              DCW      0x0000
                  |L8.88|
                          DCD      OSTCBCurPtr

                          AREA ||i.OSTaskResume||, CODE, READONLY, ALIGN=2

                  OSTaskResume PROC
;;;1401   #if (OS_CFG_TASK_SUSPEND_EN == DEF_ENABLED)
;;;1402   void  OSTaskResume (OS_TCB  *p_tcb,
000000  b570              PUSH     {r4-r6,lr}
;;;1403                       OS_ERR  *p_err)
;;;1404   {
000002  4604              MOV      r4,r0
000004  460d              MOV      r5,r1
;;;1405       CPU_SR_ALLOC();
000006  2600              MOVS     r6,#0
;;;1406   
;;;1407   
;;;1408   
;;;1409   #ifdef OS_SAFETY_CRITICAL
;;;1410       if (p_err == DEF_NULL) {
;;;1411           OS_SAFETY_CRITICAL_EXCEPTION();
;;;1412           return;
;;;1413       }
;;;1414   #endif
;;;1415   
;;;1416   #if (OS_CFG_ISR_POST_DEFERRED_EN   == DEF_DISABLED) && \
;;;1417       (OS_CFG_CALLED_FROM_ISR_CHK_EN == DEF_ENABLED)
;;;1418       if (OSIntNestingCtr > 0u) {                                 /* Not allowed to call from an ISR                      */
000008  4818              LDR      r0,|L9.108|
00000a  7800              LDRB     r0,[r0,#0]  ; OSIntNestingCtr
00000c  b118              CBZ      r0,|L9.22|
;;;1419          *p_err = OS_ERR_TASK_RESUME_ISR;
00000e  f2471055          MOV      r0,#0x7155
000012  8028              STRH     r0,[r5,#0]
                  |L9.20|
;;;1420           return;
;;;1421       }
;;;1422   #endif
;;;1423   
;;;1424   #if (OS_CFG_INVALID_OS_CALLS_CHK_EN == DEF_ENABLED)             /* Is the kernel running?                               */
;;;1425       if (OSRunning != OS_STATE_OS_RUNNING) {
;;;1426          *p_err = OS_ERR_OS_NOT_RUNNING;
;;;1427           return;
;;;1428       }
;;;1429   #endif
;;;1430   
;;;1431   
;;;1432       CPU_CRITICAL_ENTER();
;;;1433   #if (OS_CFG_ARG_CHK_EN == DEF_ENABLED)
;;;1434       if ((p_tcb == DEF_NULL) ||                                  /* We cannot resume 'self'                              */
;;;1435           (p_tcb == OSTCBCurPtr)) {
;;;1436           CPU_CRITICAL_EXIT();
;;;1437          *p_err  = OS_ERR_TASK_RESUME_SELF;
;;;1438           return;
;;;1439       }
;;;1440   #endif
;;;1441       CPU_CRITICAL_EXIT();
;;;1442   
;;;1443   #if (OS_CFG_ISR_POST_DEFERRED_EN == DEF_ENABLED)
;;;1444       if (OSIntNestingCtr > 0u) {                                 /* See if called from an ISR                            */
;;;1445           OS_IntQPost(OS_OBJ_TYPE_TASK_RESUME,                    /* Post to ISR queue                                    */
;;;1446                       (void *)p_tcb,
;;;1447                       DEF_NULL,
;;;1448                       0u,
;;;1449                       0u,
;;;1450                       0u,
;;;1451                       0u,
;;;1452                       p_err);
;;;1453           return;
;;;1454       }
;;;1455   #endif
;;;1456   
;;;1457       OS_TaskResume(p_tcb, p_err);
;;;1458   
;;;1459   #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;1460       TRACE_OS_TASK_RESUME(p_tcb);                                /* Record the event.                                    */
;;;1461   #endif
;;;1462   }
000014  bd70              POP      {r4-r6,pc}
                  |L9.22|
000016  bf00              NOP                            ;1432
000018  bf00              NOP                            ;1432
00001a  f7fffffe          BL       CPU_SR_Save
00001e  4606              MOV      r6,r0                 ;1432
000020  bf00              NOP                            ;1432
000022  f7fffffe          BL       CPU_IntDisMeasStart
000026  bf00              NOP                            ;1432
000028  b11c              CBZ      r4,|L9.50|
00002a  4811              LDR      r0,|L9.112|
00002c  6800              LDR      r0,[r0,#0]            ;1435  ; OSTCBCurPtr
00002e  4284              CMP      r4,r0                 ;1435
000030  d10c              BNE      |L9.76|
                  |L9.50|
000032  bf00              NOP                            ;1436
000034  f7fffffe          BL       CPU_IntDisMeasStop
000038  bf00              NOP                            ;1436
00003a  4630              MOV      r0,r6                 ;1436
00003c  f7fffffe          BL       CPU_SR_Restore
000040  bf00              NOP                            ;1436
000042  bf00              NOP                            ;1436
000044  f2471057          MOV      r0,#0x7157            ;1437
000048  8028              STRH     r0,[r5,#0]            ;1437
00004a  e7e3              B        |L9.20|
                  |L9.76|
00004c  bf00              NOP                            ;1441
00004e  f7fffffe          BL       CPU_IntDisMeasStop
000052  bf00              NOP                            ;1441
000054  4630              MOV      r0,r6                 ;1441
000056  f7fffffe          BL       CPU_SR_Restore
00005a  bf00              NOP                            ;1441
00005c  bf00              NOP                            ;1441
00005e  4629              MOV      r1,r5                 ;1457
000060  4620              MOV      r0,r4                 ;1457
000062  f7fffffe          BL       OS_TaskResume
000066  bf00              NOP      
000068  e7d4              B        |L9.20|
;;;1463   #endif
                          ENDP

00006a  0000              DCW      0x0000
                  |L9.108|
                          DCD      OSIntNestingCtr
                  |L9.112|
                          DCD      OSTCBCurPtr

                          AREA ||i.OSTaskSemPend||, CODE, READONLY, ALIGN=2

                  OSTaskSemPend PROC
;;;1501   
;;;1502   OS_SEM_CTR  OSTaskSemPend (OS_TICK   timeout,
000000  e92d47f0          PUSH     {r4-r10,lr}
;;;1503                              OS_OPT    opt,
;;;1504                              CPU_TS   *p_ts,
;;;1505                              OS_ERR   *p_err)
;;;1506   {
000004  4680              MOV      r8,r0
000006  460e              MOV      r6,r1
000008  4614              MOV      r4,r2
00000a  461d              MOV      r5,r3
;;;1507       OS_SEM_CTR    ctr;
;;;1508       CPU_SR_ALLOC();
00000c  f04f0900          MOV      r9,#0
;;;1509   
;;;1510   
;;;1511   #if (OS_CFG_TS_EN == DEF_DISABLED)
;;;1512       (void)&p_ts;                                                /* Prevent compiler warning for not using 'ts'          */
;;;1513   #endif
;;;1514   
;;;1515   #ifdef OS_SAFETY_CRITICAL
;;;1516       if (p_err == DEF_NULL) {
;;;1517           OS_SAFETY_CRITICAL_EXCEPTION();
;;;1518           return (0u);
;;;1519       }
;;;1520   #endif
;;;1521   
;;;1522   #if (OS_CFG_CALLED_FROM_ISR_CHK_EN == DEF_ENABLED)
;;;1523       if (OSIntNestingCtr > 0u) {                                 /* Not allowed to call from an ISR                      */
000010  4877              LDR      r0,|L10.496|
000012  7800              LDRB     r0,[r0,#0]  ; OSIntNestingCtr
000014  b128              CBZ      r0,|L10.34|
;;;1524   #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;1525           TRACE_OS_TASK_SEM_PEND_FAILED(OSTCBCurPtr);             /* Record the event.                                    */
;;;1526   #endif
;;;1527          *p_err = OS_ERR_PEND_ISR;
000016  f24610ae          MOV      r0,#0x61ae
00001a  8028              STRH     r0,[r5,#0]
;;;1528           return (0u);
00001c  2000              MOVS     r0,#0
                  |L10.30|
;;;1529       }
;;;1530   #endif
;;;1531   
;;;1532   #if (OS_CFG_INVALID_OS_CALLS_CHK_EN == DEF_ENABLED)             /* Is the kernel running?                               */
;;;1533       if (OSRunning != OS_STATE_OS_RUNNING) {
;;;1534          *p_err = OS_ERR_OS_NOT_RUNNING;
;;;1535           return (0u);
;;;1536       }
;;;1537   #endif
;;;1538   
;;;1539   #if (OS_CFG_ARG_CHK_EN == DEF_ENABLED)
;;;1540       switch (opt) {                                              /* Validate 'opt'                                       */
;;;1541           case OS_OPT_PEND_BLOCKING:
;;;1542           case OS_OPT_PEND_NON_BLOCKING:
;;;1543                break;
;;;1544   
;;;1545           default:
;;;1546   #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;1547                TRACE_OS_TASK_SEM_PEND_FAILED(OSTCBCurPtr);        /* Record the event.                                    */
;;;1548   #endif
;;;1549               *p_err = OS_ERR_OPT_INVALID;
;;;1550                return (0u);
;;;1551       }
;;;1552   #endif
;;;1553   
;;;1554       CPU_CRITICAL_ENTER();
;;;1555       if (OSTCBCurPtr->SemCtr > 0u) {                             /* See if task already been signaled                    */
;;;1556           OSTCBCurPtr->SemCtr--;
;;;1557           ctr = OSTCBCurPtr->SemCtr;
;;;1558   #if (OS_CFG_TS_EN == DEF_ENABLED)
;;;1559           if (p_ts != DEF_NULL) {
;;;1560              *p_ts  = OSTCBCurPtr->TS;
;;;1561           }
;;;1562   #if (OS_CFG_TASK_PROFILE_EN == DEF_ENABLED)
;;;1563   #if (OS_CFG_TS_EN == DEF_ENABLED)
;;;1564           OSTCBCurPtr->SemPendTime = OS_TS_GET() - OSTCBCurPtr->TS;
;;;1565           if (OSTCBCurPtr->SemPendTimeMax < OSTCBCurPtr->SemPendTime) {
;;;1566               OSTCBCurPtr->SemPendTimeMax = OSTCBCurPtr->SemPendTime;
;;;1567           }
;;;1568   #endif
;;;1569   #endif
;;;1570   #endif
;;;1571           CPU_CRITICAL_EXIT();
;;;1572   #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;1573           TRACE_OS_TASK_SEM_PEND(OSTCBCurPtr);                    /* Record the event.                                    */
;;;1574   #endif
;;;1575          *p_err = OS_ERR_NONE;
;;;1576           return (ctr);
;;;1577       }
;;;1578   
;;;1579       if ((opt & OS_OPT_PEND_NON_BLOCKING) != 0u) {               /* Caller wants to block if not available?              */
;;;1580           CPU_CRITICAL_EXIT();
;;;1581   #if (OS_CFG_TS_EN == DEF_ENABLED)
;;;1582           if (p_ts != DEF_NULL) {
;;;1583               *p_ts  = 0u;
;;;1584           }
;;;1585   #endif
;;;1586          *p_err = OS_ERR_PEND_WOULD_BLOCK;                        /* No                                                   */
;;;1587   #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;1588           TRACE_OS_TASK_SEM_PEND_FAILED(OSTCBCurPtr);             /* Record the event.                                    */
;;;1589   #endif
;;;1590           return (0u);
;;;1591       } else {                                                    /* Yes                                                  */
;;;1592           if (OSSchedLockNestingCtr > 0u) {                       /* Can't pend when the scheduler is locked              */
;;;1593   #if (OS_CFG_TS_EN == DEF_ENABLED)
;;;1594               if (p_ts != DEF_NULL) {
;;;1595                  *p_ts  = 0u;
;;;1596               }
;;;1597   #endif
;;;1598               CPU_CRITICAL_EXIT();
;;;1599   #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;1600               TRACE_OS_TASK_SEM_PEND_FAILED(OSTCBCurPtr);         /* Record the event.                                    */
;;;1601   #endif
;;;1602              *p_err = OS_ERR_SCHED_LOCKED;
;;;1603               return (0u);
;;;1604           }
;;;1605       }
;;;1606                                                                   /* Lock the scheduler/re-enable interrupts              */
;;;1607       OS_CRITICAL_ENTER_CPU_EXIT();
;;;1608       OS_Pend(DEF_NULL,                                           /* Block task pending on Signal                         */
;;;1609               DEF_NULL,
;;;1610               OS_TASK_PEND_ON_TASK_SEM,
;;;1611               timeout);
;;;1612       OS_CRITICAL_EXIT_NO_SCHED();
;;;1613   #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;1614       TRACE_OS_TASK_SEM_PEND_BLOCK(OSTCBCurPtr);                  /* Record the event.                                    */
;;;1615   #endif
;;;1616       OSSched();                                                  /* Find next highest priority task ready to run         */
;;;1617   
;;;1618       CPU_CRITICAL_ENTER();
;;;1619       switch (OSTCBCurPtr->PendStatus) {                          /* See if we timed-out or aborted                       */
;;;1620           case OS_STATUS_PEND_OK:
;;;1621   #if (OS_CFG_TS_EN == DEF_ENABLED)
;;;1622                if (p_ts != DEF_NULL) {
;;;1623                   *p_ts                    =  OSTCBCurPtr->TS;
;;;1624   #if (OS_CFG_TASK_PROFILE_EN == DEF_ENABLED)
;;;1625   #if (OS_CFG_TS_EN == DEF_ENABLED)
;;;1626                   OSTCBCurPtr->SemPendTime = OS_TS_GET() - OSTCBCurPtr->TS;
;;;1627                   if (OSTCBCurPtr->SemPendTimeMax < OSTCBCurPtr->SemPendTime) {
;;;1628                       OSTCBCurPtr->SemPendTimeMax = OSTCBCurPtr->SemPendTime;
;;;1629                   }
;;;1630   #endif
;;;1631   #endif
;;;1632                }
;;;1633   #endif
;;;1634   #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;1635                TRACE_OS_TASK_SEM_PEND(OSTCBCurPtr);               /* Record the event.                                    */
;;;1636   #endif
;;;1637               *p_err = OS_ERR_NONE;
;;;1638                break;
;;;1639   
;;;1640           case OS_STATUS_PEND_ABORT:
;;;1641   #if (OS_CFG_TS_EN == DEF_ENABLED)
;;;1642                if (p_ts != DEF_NULL) {
;;;1643                   *p_ts = OSTCBCurPtr->TS;
;;;1644                }
;;;1645   #endif
;;;1646   #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;1647                TRACE_OS_TASK_SEM_PEND_FAILED(OSTCBCurPtr);        /* Record the event.                                    */
;;;1648   #endif
;;;1649               *p_err = OS_ERR_PEND_ABORT;                         /* Indicate that we aborted                             */
;;;1650                break;
;;;1651   
;;;1652           case OS_STATUS_PEND_TIMEOUT:
;;;1653   #if (OS_CFG_TS_EN == DEF_ENABLED)
;;;1654                if (p_ts != DEF_NULL) {
;;;1655                   *p_ts = 0u;
;;;1656                }
;;;1657   #endif
;;;1658   #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;1659                TRACE_OS_TASK_SEM_PEND_FAILED(OSTCBCurPtr);        /* Record the event.                                    */
;;;1660   #endif
;;;1661               *p_err = OS_ERR_TIMEOUT;                            /* Indicate that we didn't get event within TO          */
;;;1662                break;
;;;1663   
;;;1664           default:
;;;1665   #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;1666                TRACE_OS_TASK_SEM_PEND_FAILED(OSTCBCurPtr);        /* Record the event.                                    */
;;;1667   #endif
;;;1668               *p_err = OS_ERR_STATUS_INVALID;
;;;1669                break;
;;;1670       }
;;;1671       ctr = OSTCBCurPtr->SemCtr;
;;;1672       CPU_CRITICAL_EXIT();
;;;1673       return (ctr);
;;;1674   }
00001e  e8bd87f0          POP      {r4-r10,pc}
                  |L10.34|
000022  b11e              CBZ      r6,|L10.44|
000024  f5b64f00          CMP      r6,#0x8000            ;1540
000028  d102              BNE      |L10.48|
00002a  e000              B        |L10.46|
                  |L10.44|
00002c  bf00              NOP                            ;1542
                  |L10.46|
00002e  e004              B        |L10.58|
                  |L10.48|
000030  f6456025          MOV      r0,#0x5e25            ;1549
000034  8028              STRH     r0,[r5,#0]            ;1549
000036  2000              MOVS     r0,#0                 ;1550
000038  e7f1              B        |L10.30|
                  |L10.58|
00003a  bf00              NOP                            ;1543
00003c  bf00              NOP                            ;1554
00003e  bf00              NOP                            ;1554
000040  f7fffffe          BL       CPU_SR_Save
000044  4681              MOV      r9,r0                 ;1554
000046  bf00              NOP                            ;1554
000048  f7fffffe          BL       CPU_IntDisMeasStart
00004c  bf00              NOP                            ;1554
00004e  4869              LDR      r0,|L10.500|
000050  6800              LDR      r0,[r0,#0]            ;1555  ; OSTCBCurPtr
000052  6cc0              LDR      r0,[r0,#0x4c]         ;1555
000054  b3b8              CBZ      r0,|L10.198|
000056  4867              LDR      r0,|L10.500|
000058  6800              LDR      r0,[r0,#0]            ;1556  ; OSTCBCurPtr
00005a  6cc0              LDR      r0,[r0,#0x4c]         ;1556
00005c  1e40              SUBS     r0,r0,#1              ;1556
00005e  4965              LDR      r1,|L10.500|
000060  6809              LDR      r1,[r1,#0]            ;1556  ; OSTCBCurPtr
000062  64c8              STR      r0,[r1,#0x4c]         ;1556
000064  4863              LDR      r0,|L10.500|
000066  6800              LDR      r0,[r0,#0]            ;1557  ; OSTCBCurPtr
000068  6cc7              LDR      r7,[r0,#0x4c]         ;1557
00006a  b11c              CBZ      r4,|L10.116|
00006c  4861              LDR      r0,|L10.500|
00006e  6800              LDR      r0,[r0,#0]            ;1560  ; OSTCBCurPtr
000070  6c80              LDR      r0,[r0,#0x48]         ;1560
000072  6020              STR      r0,[r4,#0]            ;1560
                  |L10.116|
000074  f7fffffe          BL       CPU_TS_TmrRd
000078  495e              LDR      r1,|L10.500|
00007a  6809              LDR      r1,[r1,#0]            ;1564  ; OSTCBCurPtr
00007c  6c89              LDR      r1,[r1,#0x48]         ;1564
00007e  1a40              SUBS     r0,r0,r1              ;1564
000080  495c              LDR      r1,|L10.500|
000082  6809              LDR      r1,[r1,#0]            ;1564  ; OSTCBCurPtr
000084  f8c100a0          STR      r0,[r1,#0xa0]         ;1564
000088  485a              LDR      r0,|L10.500|
00008a  6800              LDR      r0,[r0,#0]            ;1565  ; OSTCBCurPtr
00008c  f8d000a4          LDR      r0,[r0,#0xa4]         ;1565
000090  4958              LDR      r1,|L10.500|
000092  6809              LDR      r1,[r1,#0]            ;1565  ; OSTCBCurPtr
000094  f8d110a0          LDR      r1,[r1,#0xa0]         ;1565
000098  4288              CMP      r0,r1                 ;1565
00009a  d207              BCS      |L10.172|
00009c  4855              LDR      r0,|L10.500|
00009e  6800              LDR      r0,[r0,#0]            ;1566  ; OSTCBCurPtr
0000a0  f8d000a0          LDR      r0,[r0,#0xa0]         ;1566
0000a4  4953              LDR      r1,|L10.500|
0000a6  6809              LDR      r1,[r1,#0]            ;1566  ; OSTCBCurPtr
0000a8  f8c100a4          STR      r0,[r1,#0xa4]         ;1566
                  |L10.172|
0000ac  bf00              NOP                            ;1571
0000ae  f7fffffe          BL       CPU_IntDisMeasStop
0000b2  bf00              NOP                            ;1571
0000b4  4648              MOV      r0,r9                 ;1571
0000b6  f7fffffe          BL       CPU_SR_Restore
0000ba  bf00              NOP                            ;1571
0000bc  bf00              NOP                            ;1571
0000be  2000              MOVS     r0,#0                 ;1575
0000c0  8028              STRH     r0,[r5,#0]            ;1575
0000c2  4638              MOV      r0,r7                 ;1576
0000c4  e7ab              B        |L10.30|
                  |L10.198|
0000c6  e7ff              B        |L10.200|
                  |L10.200|
0000c8  f4064000          AND      r0,r6,#0x8000         ;1579
0000cc  b180              CBZ      r0,|L10.240|
0000ce  bf00              NOP                            ;1580
0000d0  f7fffffe          BL       CPU_IntDisMeasStop
0000d4  bf00              NOP                            ;1580
0000d6  4648              MOV      r0,r9                 ;1580
0000d8  f7fffffe          BL       CPU_SR_Restore
0000dc  bf00              NOP                            ;1580
0000de  bf00              NOP                            ;1580
0000e0  b10c              CBZ      r4,|L10.230|
0000e2  2000              MOVS     r0,#0                 ;1583
0000e4  6020              STR      r0,[r4,#0]            ;1583
                  |L10.230|
0000e6  f24610b0          MOV      r0,#0x61b0            ;1586
0000ea  8028              STRH     r0,[r5,#0]            ;1586
0000ec  2000              MOVS     r0,#0                 ;1590
0000ee  e796              B        |L10.30|
                  |L10.240|
0000f0  4841              LDR      r0,|L10.504|
0000f2  7800              LDRB     r0,[r0,#0]            ;1592  ; OSSchedLockNestingCtr
0000f4  b180              CBZ      r0,|L10.280|
0000f6  b10c              CBZ      r4,|L10.252|
0000f8  2000              MOVS     r0,#0                 ;1595
0000fa  6020              STR      r0,[r4,#0]            ;1595
                  |L10.252|
0000fc  bf00              NOP                            ;1598
0000fe  f7fffffe          BL       CPU_IntDisMeasStop
000102  bf00              NOP                            ;1598
000104  4648              MOV      r0,r9                 ;1598
000106  f7fffffe          BL       CPU_SR_Restore
00010a  bf00              NOP                            ;1598
00010c  bf00              NOP                            ;1598
00010e  f6465063          MOV      r0,#0x6d63            ;1602
000112  8028              STRH     r0,[r5,#0]            ;1602
000114  2000              MOVS     r0,#0                 ;1603
000116  e782              B        |L10.30|
                  |L10.280|
000118  4643              MOV      r3,r8                 ;1608
00011a  2207              MOVS     r2,#7                 ;1608
00011c  2100              MOVS     r1,#0                 ;1608
00011e  4608              MOV      r0,r1                 ;1608
000120  f7fffffe          BL       OS_Pend
000124  bf00              NOP                            ;1612
000126  f7fffffe          BL       CPU_IntDisMeasStop
00012a  bf00              NOP                            ;1612
00012c  4648              MOV      r0,r9                 ;1612
00012e  f7fffffe          BL       CPU_SR_Restore
000132  bf00              NOP                            ;1612
000134  bf00              NOP                            ;1612
000136  f7fffffe          BL       OSSched
00013a  bf00              NOP                            ;1618
00013c  bf00              NOP                            ;1618
00013e  f7fffffe          BL       CPU_SR_Save
000142  4681              MOV      r9,r0                 ;1618
000144  bf00              NOP                            ;1618
000146  f7fffffe          BL       CPU_IntDisMeasStart
00014a  bf00              NOP                            ;1618
00014c  4829              LDR      r0,|L10.500|
00014e  6800              LDR      r0,[r0,#0]            ;1619  ; OSTCBCurPtr
000150  f8900035          LDRB     r0,[r0,#0x35]         ;1619
000154  b120              CBZ      r0,|L10.352|
000156  2801              CMP      r0,#1                 ;1619
000158  d026              BEQ      |L10.424|
00015a  2803              CMP      r0,#3                 ;1619
00015c  d134              BNE      |L10.456|
00015e  e02c              B        |L10.442|
                  |L10.352|
000160  b1fc              CBZ      r4,|L10.418|
000162  4824              LDR      r0,|L10.500|
000164  6800              LDR      r0,[r0,#0]            ;1623  ; OSTCBCurPtr
000166  6c80              LDR      r0,[r0,#0x48]         ;1623
000168  6020              STR      r0,[r4,#0]            ;1623
00016a  f7fffffe          BL       CPU_TS_TmrRd
00016e  4921              LDR      r1,|L10.500|
000170  6809              LDR      r1,[r1,#0]            ;1626  ; OSTCBCurPtr
000172  6c89              LDR      r1,[r1,#0x48]         ;1626
000174  1a40              SUBS     r0,r0,r1              ;1626
000176  491f              LDR      r1,|L10.500|
000178  6809              LDR      r1,[r1,#0]            ;1626  ; OSTCBCurPtr
00017a  f8c100a0          STR      r0,[r1,#0xa0]         ;1626
00017e  481d              LDR      r0,|L10.500|
000180  6800              LDR      r0,[r0,#0]            ;1627  ; OSTCBCurPtr
000182  f8d000a4          LDR      r0,[r0,#0xa4]         ;1627
000186  491b              LDR      r1,|L10.500|
000188  6809              LDR      r1,[r1,#0]            ;1627  ; OSTCBCurPtr
00018a  f8d110a0          LDR      r1,[r1,#0xa0]         ;1627
00018e  4288              CMP      r0,r1                 ;1627
000190  d207              BCS      |L10.418|
000192  4818              LDR      r0,|L10.500|
000194  6800              LDR      r0,[r0,#0]            ;1628  ; OSTCBCurPtr
000196  f8d000a0          LDR      r0,[r0,#0xa0]         ;1628
00019a  4916              LDR      r1,|L10.500|
00019c  6809              LDR      r1,[r1,#0]            ;1628  ; OSTCBCurPtr
00019e  f8c100a4          STR      r0,[r1,#0xa4]         ;1628
                  |L10.418|
0001a2  2000              MOVS     r0,#0                 ;1637
0001a4  8028              STRH     r0,[r5,#0]            ;1637
0001a6  e013              B        |L10.464|
                  |L10.424|
0001a8  b11c              CBZ      r4,|L10.434|
0001aa  4812              LDR      r0,|L10.500|
0001ac  6800              LDR      r0,[r0,#0]            ;1643  ; OSTCBCurPtr
0001ae  6c80              LDR      r0,[r0,#0x48]         ;1643
0001b0  6020              STR      r0,[r4,#0]            ;1643
                  |L10.434|
0001b2  f24610a9          MOV      r0,#0x61a9            ;1649
0001b6  8028              STRH     r0,[r5,#0]            ;1649
0001b8  e00a              B        |L10.464|
                  |L10.442|
0001ba  b10c              CBZ      r4,|L10.448|
0001bc  2000              MOVS     r0,#0                 ;1655
0001be  6020              STR      r0,[r4,#0]            ;1655
                  |L10.448|
0001c0  f24720d9          MOV      r0,#0x72d9            ;1661
0001c4  8028              STRH     r0,[r5,#0]            ;1661
0001c6  e003              B        |L10.464|
                  |L10.456|
0001c8  f646602e          MOV      r0,#0x6e2e            ;1668
0001cc  8028              STRH     r0,[r5,#0]            ;1668
0001ce  bf00              NOP                            ;1669
                  |L10.464|
0001d0  bf00              NOP                            ;1638
0001d2  4808              LDR      r0,|L10.500|
0001d4  6800              LDR      r0,[r0,#0]            ;1671  ; OSTCBCurPtr
0001d6  6cc7              LDR      r7,[r0,#0x4c]         ;1671
0001d8  bf00              NOP                            ;1672
0001da  f7fffffe          BL       CPU_IntDisMeasStop
0001de  bf00              NOP                            ;1672
0001e0  4648              MOV      r0,r9                 ;1672
0001e2  f7fffffe          BL       CPU_SR_Restore
0001e6  bf00              NOP                            ;1672
0001e8  bf00              NOP                            ;1672
0001ea  4638              MOV      r0,r7                 ;1673
0001ec  e717              B        |L10.30|
;;;1675   
                          ENDP

0001ee  0000              DCW      0x0000
                  |L10.496|
                          DCD      OSIntNestingCtr
                  |L10.500|
                          DCD      OSTCBCurPtr
                  |L10.504|
                          DCD      OSSchedLockNestingCtr

                          AREA ||i.OSTaskSemPendAbort||, CODE, READONLY, ALIGN=2

                  OSTaskSemPendAbort PROC
;;;1709   #if (OS_CFG_TASK_SEM_PEND_ABORT_EN == DEF_ENABLED)
;;;1710   CPU_BOOLEAN  OSTaskSemPendAbort (OS_TCB  *p_tcb,
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;1711                                    OS_OPT   opt,
;;;1712                                    OS_ERR  *p_err)
;;;1713   {
000004  4605              MOV      r5,r0
000006  460e              MOV      r6,r1
000008  4614              MOV      r4,r2
;;;1714       CPU_TS  ts;
;;;1715       CPU_SR_ALLOC();
00000a  2700              MOVS     r7,#0
;;;1716   
;;;1717   
;;;1718   
;;;1719   #ifdef OS_SAFETY_CRITICAL
;;;1720       if (p_err == DEF_NULL) {
;;;1721           OS_SAFETY_CRITICAL_EXCEPTION();
;;;1722           return (DEF_FALSE);
;;;1723       }
;;;1724   #endif
;;;1725   
;;;1726   #if (OS_CFG_CALLED_FROM_ISR_CHK_EN == DEF_ENABLED)
;;;1727       if (OSIntNestingCtr > 0u) {                                 /* See if called from ISR ...                           */
00000c  4837              LDR      r0,|L11.236|
00000e  7800              LDRB     r0,[r0,#0]  ; OSIntNestingCtr
000010  b128              CBZ      r0,|L11.30|
;;;1728          *p_err = OS_ERR_PEND_ABORT_ISR;                          /* ... can't Pend Abort from an ISR                     */
000012  f24610aa          MOV      r0,#0x61aa
000016  8020              STRH     r0,[r4,#0]
;;;1729           return (DEF_FALSE);
000018  2000              MOVS     r0,#0
                  |L11.26|
;;;1730       }
;;;1731   #endif
;;;1732   
;;;1733   #if (OS_CFG_INVALID_OS_CALLS_CHK_EN == DEF_ENABLED)             /* Is the kernel running?                               */
;;;1734       if (OSRunning != OS_STATE_OS_RUNNING) {
;;;1735          *p_err = OS_ERR_OS_NOT_RUNNING;
;;;1736           return (DEF_FALSE);
;;;1737       }
;;;1738   #endif
;;;1739   
;;;1740   #if (OS_CFG_ARG_CHK_EN == DEF_ENABLED)
;;;1741       switch (opt) {                                              /* Validate 'opt'                                       */
;;;1742           case OS_OPT_POST_NONE:
;;;1743           case OS_OPT_POST_NO_SCHED:
;;;1744                break;
;;;1745   
;;;1746           default:
;;;1747               *p_err = OS_ERR_OPT_INVALID;
;;;1748                return (DEF_FALSE);
;;;1749       }
;;;1750   #endif
;;;1751   
;;;1752       CPU_CRITICAL_ENTER();
;;;1753       if ((p_tcb == DEF_NULL) ||                                  /* Pend abort self?                                     */
;;;1754           (p_tcb == OSTCBCurPtr)) {
;;;1755           CPU_CRITICAL_EXIT();                                    /* ... doesn't make sense!                              */
;;;1756          *p_err = OS_ERR_PEND_ABORT_SELF;
;;;1757           return (DEF_FALSE);
;;;1758       }
;;;1759   
;;;1760       if (p_tcb->PendOn != OS_TASK_PEND_ON_TASK_SEM) {            /* Is task waiting for a signal?                        */
;;;1761           CPU_CRITICAL_EXIT();
;;;1762          *p_err = OS_ERR_PEND_ABORT_NONE;
;;;1763           return (DEF_FALSE);
;;;1764       }
;;;1765       CPU_CRITICAL_EXIT();
;;;1766   
;;;1767       OS_CRITICAL_ENTER();
;;;1768   #if (OS_CFG_TS_EN == DEF_ENABLED)
;;;1769       ts = OS_TS_GET();
;;;1770   #else
;;;1771       ts = 0u;
;;;1772   #endif
;;;1773       OS_PendAbort(DEF_NULL,
;;;1774                    p_tcb,
;;;1775                    ts);
;;;1776       OS_CRITICAL_EXIT_NO_SCHED();
;;;1777       if ((opt & OS_OPT_POST_NO_SCHED) == 0u) {
;;;1778           OSSched();                                              /* Run the scheduler                                    */
;;;1779       }
;;;1780      *p_err = OS_ERR_NONE;
;;;1781       return (DEF_TRUE);
;;;1782   }
00001a  e8bd81f0          POP      {r4-r8,pc}
                  |L11.30|
00001e  b11e              CBZ      r6,|L11.40|
000020  f5b64f00          CMP      r6,#0x8000            ;1741
000024  d102              BNE      |L11.44|
000026  e000              B        |L11.42|
                  |L11.40|
000028  bf00              NOP                            ;1743
                  |L11.42|
00002a  e004              B        |L11.54|
                  |L11.44|
00002c  f6456025          MOV      r0,#0x5e25            ;1747
000030  8020              STRH     r0,[r4,#0]            ;1747
000032  2000              MOVS     r0,#0                 ;1748
000034  e7f1              B        |L11.26|
                  |L11.54|
000036  bf00              NOP                            ;1744
000038  bf00              NOP                            ;1752
00003a  bf00              NOP                            ;1752
00003c  f7fffffe          BL       CPU_SR_Save
000040  4607              MOV      r7,r0                 ;1752
000042  bf00              NOP                            ;1752
000044  f7fffffe          BL       CPU_IntDisMeasStart
000048  bf00              NOP                            ;1752
00004a  b11d              CBZ      r5,|L11.84|
00004c  4828              LDR      r0,|L11.240|
00004e  6800              LDR      r0,[r0,#0]            ;1754  ; OSTCBCurPtr
000050  4285              CMP      r5,r0                 ;1754
000052  d10d              BNE      |L11.112|
                  |L11.84|
000054  bf00              NOP                            ;1755
000056  f7fffffe          BL       CPU_IntDisMeasStop
00005a  bf00              NOP                            ;1755
00005c  4638              MOV      r0,r7                 ;1755
00005e  f7fffffe          BL       CPU_SR_Restore
000062  bf00              NOP                            ;1755
000064  bf00              NOP                            ;1755
000066  f24610ac          MOV      r0,#0x61ac            ;1756
00006a  8020              STRH     r0,[r4,#0]            ;1756
00006c  2000              MOVS     r0,#0                 ;1757
00006e  e7d4              B        |L11.26|
                  |L11.112|
000070  f8950034          LDRB     r0,[r5,#0x34]         ;1760
000074  2807              CMP      r0,#7                 ;1760
000076  d00d              BEQ      |L11.148|
000078  bf00              NOP                            ;1761
00007a  f7fffffe          BL       CPU_IntDisMeasStop
00007e  bf00              NOP                            ;1761
000080  4638              MOV      r0,r7                 ;1761
000082  f7fffffe          BL       CPU_SR_Restore
000086  bf00              NOP                            ;1761
000088  bf00              NOP                            ;1761
00008a  f24610ab          MOV      r0,#0x61ab            ;1762
00008e  8020              STRH     r0,[r4,#0]            ;1762
000090  2000              MOVS     r0,#0                 ;1763
000092  e7c2              B        |L11.26|
                  |L11.148|
000094  bf00              NOP                            ;1765
000096  f7fffffe          BL       CPU_IntDisMeasStop
00009a  bf00              NOP                            ;1765
00009c  4638              MOV      r0,r7                 ;1765
00009e  f7fffffe          BL       CPU_SR_Restore
0000a2  bf00              NOP                            ;1765
0000a4  bf00              NOP                            ;1765
0000a6  bf00              NOP                            ;1767
0000a8  bf00              NOP                            ;1767
0000aa  f7fffffe          BL       CPU_SR_Save
0000ae  4607              MOV      r7,r0                 ;1767
0000b0  bf00              NOP                            ;1767
0000b2  f7fffffe          BL       CPU_IntDisMeasStart
0000b6  bf00              NOP                            ;1767
0000b8  f7fffffe          BL       CPU_TS_TmrRd
0000bc  4680              MOV      r8,r0                 ;1769
0000be  4642              MOV      r2,r8                 ;1773
0000c0  4629              MOV      r1,r5                 ;1773
0000c2  2000              MOVS     r0,#0                 ;1773
0000c4  f7fffffe          BL       OS_PendAbort
0000c8  bf00              NOP                            ;1776
0000ca  f7fffffe          BL       CPU_IntDisMeasStop
0000ce  bf00              NOP                            ;1776
0000d0  4638              MOV      r0,r7                 ;1776
0000d2  f7fffffe          BL       CPU_SR_Restore
0000d6  bf00              NOP                            ;1776
0000d8  bf00              NOP                            ;1776
0000da  f4064000          AND      r0,r6,#0x8000         ;1777
0000de  b908              CBNZ     r0,|L11.228|
0000e0  f7fffffe          BL       OSSched
                  |L11.228|
0000e4  2000              MOVS     r0,#0                 ;1780
0000e6  8020              STRH     r0,[r4,#0]            ;1780
0000e8  2001              MOVS     r0,#1                 ;1781
0000ea  e796              B        |L11.26|
;;;1783   #endif
                          ENDP

                  |L11.236|
                          DCD      OSIntNestingCtr
                  |L11.240|
                          DCD      OSTCBCurPtr

                          AREA ||i.OSTaskSemPost||, CODE, READONLY, ALIGN=1

                  OSTaskSemPost PROC
;;;1815   
;;;1816   OS_SEM_CTR  OSTaskSemPost (OS_TCB  *p_tcb,
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;1817                              OS_OPT   opt,
;;;1818                              OS_ERR  *p_err)
;;;1819   {
000004  4606              MOV      r6,r0
000006  460d              MOV      r5,r1
000008  4614              MOV      r4,r2
;;;1820       OS_SEM_CTR  ctr;
;;;1821       CPU_TS      ts;
;;;1822   
;;;1823   
;;;1824   
;;;1825   #ifdef OS_SAFETY_CRITICAL
;;;1826       if (p_err == DEF_NULL) {
;;;1827           OS_SAFETY_CRITICAL_EXCEPTION();
;;;1828           return (0u);
;;;1829       }
;;;1830   #endif
;;;1831   
;;;1832   #if (OS_CFG_INVALID_OS_CALLS_CHK_EN == DEF_ENABLED)             /* Is the kernel running?                               */
;;;1833       if (OSRunning != OS_STATE_OS_RUNNING) {
;;;1834          *p_err = OS_ERR_OS_NOT_RUNNING;
;;;1835           return (0u);
;;;1836       }
;;;1837   #endif
;;;1838   
;;;1839   #if (OS_CFG_ARG_CHK_EN == DEF_ENABLED)
;;;1840       switch (opt) {                                              /* Validate 'opt'                                       */
00000a  b11d              CBZ      r5,|L12.20|
00000c  f5b54f00          CMP      r5,#0x8000
000010  d102              BNE      |L12.24|
000012  e000              B        |L12.22|
                  |L12.20|
;;;1841           case OS_OPT_POST_NONE:
;;;1842           case OS_OPT_POST_NO_SCHED:
000014  bf00              NOP      
                  |L12.22|
;;;1843                break;
000016  e005              B        |L12.36|
                  |L12.24|
;;;1844   
;;;1845           default:
;;;1846   #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;1847                TRACE_OS_TASK_SEM_POST_FAILED(p_tcb);              /* Record the event.                                    */
;;;1848   #endif
;;;1849               *p_err =  OS_ERR_OPT_INVALID;
000018  f6456025          MOV      r0,#0x5e25
00001c  8020              STRH     r0,[r4,#0]
;;;1850                return (0u);
00001e  2000              MOVS     r0,#0
                  |L12.32|
;;;1851       }
;;;1852   #endif
;;;1853   
;;;1854   #if (OS_CFG_TS_EN == DEF_ENABLED)
;;;1855       ts = OS_TS_GET();                                           /* Get timestamp                                        */
;;;1856   #else
;;;1857       ts = 0u;
;;;1858   #endif
;;;1859   
;;;1860   #if (OS_CFG_ISR_POST_DEFERRED_EN == DEF_ENABLED)
;;;1861       if (OSIntNestingCtr > 0u) {                                 /* See if called from an ISR                            */
;;;1862           OS_IntQPost(OS_OBJ_TYPE_TASK_SIGNAL,                    /* Post to ISR queue                                    */
;;;1863                       (void      *)p_tcb,
;;;1864                       DEF_NULL,
;;;1865                       0u,
;;;1866                       0u,
;;;1867                       0u,
;;;1868                       ts,
;;;1869                       p_err);
;;;1870           return (0u);
;;;1871       }
;;;1872   #endif
;;;1873   
;;;1874   #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;1875       TRACE_OS_TASK_SEM_POST(p_tcb);                              /* Record the event.                                    */
;;;1876   #endif
;;;1877   
;;;1878       ctr = OS_TaskSemPost(p_tcb,
;;;1879                            opt,
;;;1880                            ts,
;;;1881                            p_err);
;;;1882   
;;;1883       return (ctr);
;;;1884   }
000020  e8bd81f0          POP      {r4-r8,pc}
                  |L12.36|
000024  bf00              NOP                            ;1843
000026  f7fffffe          BL       CPU_TS_TmrRd
00002a  4680              MOV      r8,r0                 ;1855
00002c  4623              MOV      r3,r4                 ;1878
00002e  4642              MOV      r2,r8                 ;1878
000030  4629              MOV      r1,r5                 ;1878
000032  4630              MOV      r0,r6                 ;1878
000034  f7fffffe          BL       OS_TaskSemPost
000038  4607              MOV      r7,r0                 ;1878
00003a  4638              MOV      r0,r7                 ;1883
00003c  e7f0              B        |L12.32|
;;;1885   
                          ENDP


                          AREA ||i.OSTaskSemSet||, CODE, READONLY, ALIGN=2

                  OSTaskSemSet PROC
;;;1909   
;;;1910   OS_SEM_CTR  OSTaskSemSet (OS_TCB      *p_tcb,
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;1911                             OS_SEM_CTR   cnt,
;;;1912                             OS_ERR      *p_err)
;;;1913   {
000004  4604              MOV      r4,r0
000006  460f              MOV      r7,r1
000008  4615              MOV      r5,r2
;;;1914       OS_SEM_CTR  ctr;
;;;1915       CPU_SR_ALLOC();
00000a  f04f0800          MOV      r8,#0
;;;1916   
;;;1917   
;;;1918   
;;;1919   #ifdef OS_SAFETY_CRITICAL
;;;1920       if (p_err == DEF_NULL) {
;;;1921           OS_SAFETY_CRITICAL_EXCEPTION();
;;;1922           return (0u);
;;;1923       }
;;;1924   #endif
;;;1925   
;;;1926   #if (OS_CFG_CALLED_FROM_ISR_CHK_EN == DEF_ENABLED)
;;;1927       if (OSIntNestingCtr > 0u) {                                 /* Not allowed to call from an ISR                      */
00000e  481d              LDR      r0,|L13.132|
000010  7800              LDRB     r0,[r0,#0]  ; OSIntNestingCtr
000012  b128              CBZ      r0,|L13.32|
;;;1928          *p_err = OS_ERR_SET_ISR;
000014  f64650c6          MOV      r0,#0x6dc6
000018  8028              STRH     r0,[r5,#0]
;;;1929           return (0u);
00001a  2000              MOVS     r0,#0
                  |L13.28|
;;;1930       }
;;;1931   #endif
;;;1932   
;;;1933       CPU_CRITICAL_ENTER();
;;;1934       if (p_tcb == DEF_NULL) {
;;;1935           p_tcb = OSTCBCurPtr;
;;;1936       }
;;;1937   
;;;1938       if (((p_tcb->TaskState   & OS_TASK_STATE_PEND) != 0u) &&    /* Not allowed when a task is waiting.                  */
;;;1939            (p_tcb->PendOn == OS_TASK_PEND_ON_TASK_SEM)) {
;;;1940           CPU_CRITICAL_EXIT();
;;;1941          *p_err = OS_ERR_TASK_WAITING;
;;;1942           return (0u);
;;;1943       }
;;;1944   
;;;1945       ctr           = p_tcb->SemCtr;
;;;1946       p_tcb->SemCtr = (OS_SEM_CTR)cnt;
;;;1947       CPU_CRITICAL_EXIT();
;;;1948      *p_err         =  OS_ERR_NONE;
;;;1949       return (ctr);
;;;1950   }
00001c  e8bd81f0          POP      {r4-r8,pc}
                  |L13.32|
000020  bf00              NOP                            ;1933
000022  bf00              NOP                            ;1933
000024  f7fffffe          BL       CPU_SR_Save
000028  4680              MOV      r8,r0                 ;1933
00002a  bf00              NOP                            ;1933
00002c  f7fffffe          BL       CPU_IntDisMeasStart
000030  bf00              NOP                            ;1933
000032  b90c              CBNZ     r4,|L13.56|
000034  4814              LDR      r0,|L13.136|
000036  6804              LDR      r4,[r0,#0]            ;1935  ; OSTCBCurPtr
                  |L13.56|
000038  f8940036          LDRB     r0,[r4,#0x36]         ;1938
00003c  f0000002          AND      r0,r0,#2              ;1938
000040  b188              CBZ      r0,|L13.102|
000042  f8940034          LDRB     r0,[r4,#0x34]         ;1939
000046  2807              CMP      r0,#7                 ;1939
000048  d10d              BNE      |L13.102|
00004a  bf00              NOP                            ;1940
00004c  f7fffffe          BL       CPU_IntDisMeasStop
000050  bf00              NOP                            ;1940
000052  4640              MOV      r0,r8                 ;1940
000054  f7fffffe          BL       CPU_SR_Restore
000058  bf00              NOP                            ;1940
00005a  bf00              NOP                            ;1940
00005c  f247105f          MOV      r0,#0x715f            ;1941
000060  8028              STRH     r0,[r5,#0]            ;1941
000062  2000              MOVS     r0,#0                 ;1942
000064  e7da              B        |L13.28|
                  |L13.102|
000066  6ce6              LDR      r6,[r4,#0x4c]         ;1945
000068  64e7              STR      r7,[r4,#0x4c]         ;1946
00006a  bf00              NOP                            ;1947
00006c  f7fffffe          BL       CPU_IntDisMeasStop
000070  bf00              NOP                            ;1947
000072  4640              MOV      r0,r8                 ;1947
000074  f7fffffe          BL       CPU_SR_Restore
000078  bf00              NOP                            ;1947
00007a  bf00              NOP                            ;1947
00007c  2000              MOVS     r0,#0                 ;1948
00007e  8028              STRH     r0,[r5,#0]            ;1948
000080  4630              MOV      r0,r6                 ;1949
000082  e7cb              B        |L13.28|
;;;1951   
                          ENDP

                  |L13.132|
                          DCD      OSIntNestingCtr
                  |L13.136|
                          DCD      OSTCBCurPtr

                          AREA ||i.OSTaskStkChk||, CODE, READONLY, ALIGN=2

                  OSTaskStkChk PROC
;;;1981   #if (OS_CFG_STAT_TASK_STK_CHK_EN == DEF_ENABLED)
;;;1982   void  OSTaskStkChk (OS_TCB        *p_tcb,
000000  e92d47f0          PUSH     {r4-r10,lr}
;;;1983                       CPU_STK_SIZE  *p_free,
;;;1984                       CPU_STK_SIZE  *p_used,
;;;1985                       OS_ERR        *p_err)
;;;1986   {
000004  4605              MOV      r5,r0
000006  460e              MOV      r6,r1
000008  4617              MOV      r7,r2
00000a  461c              MOV      r4,r3
;;;1987       CPU_STK_SIZE  free_stk;
;;;1988       CPU_STK      *p_stk;
;;;1989       CPU_SR_ALLOC();
00000c  f04f0a00          MOV      r10,#0
;;;1990   
;;;1991   
;;;1992   #ifdef OS_SAFETY_CRITICAL
;;;1993       if (p_err == DEF_NULL) {
;;;1994           OS_SAFETY_CRITICAL_EXCEPTION();
;;;1995           return;
;;;1996       }
;;;1997   #endif
;;;1998   
;;;1999   #if (OS_CFG_CALLED_FROM_ISR_CHK_EN == DEF_ENABLED)
;;;2000       if (OSIntNestingCtr > 0u) {                                 /* See if trying to check stack from ISR                */
000010  4832              LDR      r0,|L14.220|
000012  7800              LDRB     r0,[r0,#0]  ; OSIntNestingCtr
000014  b120              CBZ      r0,|L14.32|
;;;2001          *p_err = OS_ERR_TASK_STK_CHK_ISR;
000016  f2471059          MOV      r0,#0x7159
00001a  8020              STRH     r0,[r4,#0]
                  |L14.28|
;;;2002           return;
;;;2003       }
;;;2004   #endif
;;;2005   
;;;2006   #if (OS_CFG_ARG_CHK_EN == DEF_ENABLED)
;;;2007       if (p_free == DEF_NULL) {                                   /* User must specify valid destinations for the sizes   */
;;;2008          *p_err = OS_ERR_PTR_INVALID;
;;;2009           return;
;;;2010       }
;;;2011   
;;;2012       if (p_used == DEF_NULL) {
;;;2013          *p_err = OS_ERR_PTR_INVALID;
;;;2014           return;
;;;2015       }
;;;2016   #endif
;;;2017   
;;;2018       CPU_CRITICAL_ENTER();
;;;2019       if (p_tcb == DEF_NULL) {                                    /* Check the stack of the current task?                 */
;;;2020           p_tcb = OSTCBCurPtr;                                    /* Yes                                                  */
;;;2021       }
;;;2022   
;;;2023       if (p_tcb->StkPtr == DEF_NULL) {                            /* Make sure task exist                                 */
;;;2024           CPU_CRITICAL_EXIT();
;;;2025          *p_free = 0u;
;;;2026          *p_used = 0u;
;;;2027          *p_err  = OS_ERR_TASK_NOT_EXIST;
;;;2028           return;
;;;2029       }
;;;2030   
;;;2031       if ((p_tcb->Opt & OS_OPT_TASK_STK_CHK) == 0u) {             /* Make sure stack checking option is set               */
;;;2032           CPU_CRITICAL_EXIT();
;;;2033          *p_free = 0u;
;;;2034          *p_used = 0u;
;;;2035          *p_err  = OS_ERR_TASK_OPT;
;;;2036           return;
;;;2037       }
;;;2038       CPU_CRITICAL_EXIT();
;;;2039   
;;;2040       free_stk = 0u;
;;;2041   #if (CPU_CFG_STK_GROWTH == CPU_STK_GROWTH_HI_TO_LO)
;;;2042       p_stk = p_tcb->StkBasePtr;                                  /* Start at the lowest memory and go up                 */
;;;2043   #if (OS_CFG_TASK_STK_REDZONE_EN == DEF_ENABLED)
;;;2044       p_stk += OS_CFG_TASK_STK_REDZONE_DEPTH;
;;;2045   #endif
;;;2046       while (*p_stk == 0u) {                                      /* Compute the number of zero entries on the stk        */
;;;2047           p_stk++;
;;;2048           free_stk++;
;;;2049       }
;;;2050   #else
;;;2051       p_stk = p_tcb->StkBasePtr + p_tcb->StkSize - 1u;            /* Start at the highest memory and go down              */
;;;2052   #if (OS_CFG_TASK_STK_REDZONE_EN == DEF_ENABLED)
;;;2053       p_stk -= OS_CFG_TASK_STK_REDZONE_DEPTH;
;;;2054   #endif
;;;2055       while (*p_stk == 0u) {
;;;2056           free_stk++;
;;;2057           p_stk--;
;;;2058       }
;;;2059   #endif
;;;2060   #if (OS_CFG_TASK_STK_REDZONE_EN == DEF_ENABLED)
;;;2061       free_stk -= OS_CFG_TASK_STK_REDZONE_DEPTH;                  /* Compensate for stack elements used by Redzone.       */
;;;2062   #endif
;;;2063      *p_free = free_stk;
;;;2064      *p_used = (p_tcb->StkSize - free_stk);                       /* Compute number of entries used on the stack          */
;;;2065      *p_err  = OS_ERR_NONE;
;;;2066   }
00001c  e8bd87f0          POP      {r4-r10,pc}
                  |L14.32|
000020  b91e              CBNZ     r6,|L14.42|
000022  f24620d5          MOV      r0,#0x62d5            ;2008
000026  8020              STRH     r0,[r4,#0]            ;2008
000028  e7f8              B        |L14.28|
                  |L14.42|
00002a  b91f              CBNZ     r7,|L14.52|
00002c  f24620d5          MOV      r0,#0x62d5            ;2013
000030  8020              STRH     r0,[r4,#0]            ;2013
000032  e7f3              B        |L14.28|
                  |L14.52|
000034  bf00              NOP                            ;2018
000036  bf00              NOP                            ;2018
000038  f7fffffe          BL       CPU_SR_Save
00003c  4682              MOV      r10,r0                ;2018
00003e  bf00              NOP                            ;2018
000040  f7fffffe          BL       CPU_IntDisMeasStart
000044  bf00              NOP                            ;2018
000046  b90d              CBNZ     r5,|L14.76|
000048  4825              LDR      r0,|L14.224|
00004a  6805              LDR      r5,[r0,#0]            ;2020  ; OSTCBCurPtr
                  |L14.76|
00004c  6828              LDR      r0,[r5,#0]            ;2023
00004e  b978              CBNZ     r0,|L14.112|
000050  bf00              NOP                            ;2024
000052  f7fffffe          BL       CPU_IntDisMeasStop
000056  bf00              NOP                            ;2024
000058  4650              MOV      r0,r10                ;2024
00005a  f7fffffe          BL       CPU_SR_Restore
00005e  bf00              NOP                            ;2024
000060  bf00              NOP                            ;2024
000062  2000              MOVS     r0,#0                 ;2025
000064  6030              STR      r0,[r6,#0]            ;2025
000066  6038              STR      r0,[r7,#0]            ;2026
000068  f2471052          MOV      r0,#0x7152            ;2027
00006c  8020              STRH     r0,[r4,#0]            ;2027
00006e  e7d5              B        |L14.28|
                  |L14.112|
000070  f8950044          LDRB     r0,[r5,#0x44]         ;2031
000074  f0000001          AND      r0,r0,#1              ;2031
000078  b978              CBNZ     r0,|L14.154|
00007a  bf00              NOP                            ;2032
00007c  f7fffffe          BL       CPU_IntDisMeasStop
000080  bf00              NOP                            ;2032
000082  4650              MOV      r0,r10                ;2032
000084  f7fffffe          BL       CPU_SR_Restore
000088  bf00              NOP                            ;2032
00008a  bf00              NOP                            ;2032
00008c  2000              MOVS     r0,#0                 ;2033
00008e  6030              STR      r0,[r6,#0]            ;2033
000090  6038              STR      r0,[r7,#0]            ;2034
000092  f2471054          MOV      r0,#0x7154            ;2035
000096  8020              STRH     r0,[r4,#0]            ;2035
000098  e7c0              B        |L14.28|
                  |L14.154|
00009a  bf00              NOP                            ;2038
00009c  f7fffffe          BL       CPU_IntDisMeasStop
0000a0  bf00              NOP                            ;2038
0000a2  4650              MOV      r0,r10                ;2038
0000a4  f7fffffe          BL       CPU_SR_Restore
0000a8  bf00              NOP                            ;2038
0000aa  bf00              NOP                            ;2038
0000ac  f04f0800          MOV      r8,#0                 ;2040
0000b0  f8d59024          LDR      r9,[r5,#0x24]         ;2042
0000b4  e003              B        |L14.190|
                  |L14.182|
0000b6  f1090904          ADD      r9,r9,#4              ;2047
0000ba  f1080801          ADD      r8,r8,#1              ;2048
                  |L14.190|
0000be  f8d90000          LDR      r0,[r9,#0]            ;2046
0000c2  2800              CMP      r0,#0                 ;2046
0000c4  d0f7              BEQ      |L14.182|
0000c6  f8c68000          STR      r8,[r6,#0]            ;2063
0000ca  6c28              LDR      r0,[r5,#0x40]         ;2064
0000cc  eba00008          SUB      r0,r0,r8              ;2064
0000d0  6038              STR      r0,[r7,#0]            ;2064
0000d2  2000              MOVS     r0,#0                 ;2065
0000d4  8020              STRH     r0,[r4,#0]            ;2065
0000d6  bf00              NOP      
0000d8  e7a0              B        |L14.28|
;;;2067   #endif
                          ENDP

0000da  0000              DCW      0x0000
                  |L14.220|
                          DCD      OSIntNestingCtr
                  |L14.224|
                          DCD      OSTCBCurPtr

                          AREA ||i.OSTaskSuspend||, CODE, READONLY, ALIGN=2

                  OSTaskSuspend PROC
;;;2140   #if (OS_CFG_TASK_SUSPEND_EN == DEF_ENABLED)
;;;2141   void   OSTaskSuspend (OS_TCB  *p_tcb,
000000  b570              PUSH     {r4-r6,lr}
;;;2142                         OS_ERR  *p_err)
;;;2143   {
000002  4605              MOV      r5,r0
000004  460c              MOV      r4,r1
;;;2144   #ifdef OS_SAFETY_CRITICAL
;;;2145       if (p_err == DEF_NULL) {
;;;2146           OS_SAFETY_CRITICAL_EXCEPTION();
;;;2147           return;
;;;2148       }
;;;2149   #endif
;;;2150   
;;;2151   #if (OS_CFG_ISR_POST_DEFERRED_EN   == DEF_DISABLED) && \
;;;2152       (OS_CFG_CALLED_FROM_ISR_CHK_EN == DEF_ENABLED)
;;;2153       if (OSIntNestingCtr > 0u) {                                 /* Not allowed to call from an ISR                      */
000006  480a              LDR      r0,|L15.48|
000008  7800              LDRB     r0,[r0,#0]  ; OSIntNestingCtr
00000a  b118              CBZ      r0,|L15.20|
;;;2154          *p_err = OS_ERR_TASK_SUSPEND_ISR;
00000c  f247105d          MOV      r0,#0x715d
000010  8020              STRH     r0,[r4,#0]
                  |L15.18|
;;;2155           return;
;;;2156       }
;;;2157   #endif
;;;2158   
;;;2159   #if (OS_CFG_TASK_IDLE_EN == DEF_ENABLED)
;;;2160       if (p_tcb == &OSIdleTaskTCB) {                              /* Make sure not suspending the idle task               */
;;;2161          *p_err = OS_ERR_TASK_SUSPEND_IDLE;
;;;2162           return;
;;;2163       }
;;;2164   #endif
;;;2165   
;;;2166   #if (OS_CFG_ISR_POST_DEFERRED_EN == DEF_ENABLED)
;;;2167       if (p_tcb == &OSIntQTaskTCB) {                              /* Not allowed to suspend the ISR handler task          */
;;;2168          *p_err = OS_ERR_TASK_SUSPEND_INT_HANDLER;
;;;2169           return;
;;;2170       }
;;;2171   
;;;2172       if (OSIntNestingCtr > 0u) {                                 /* See if called from an ISR                            */
;;;2173           OS_IntQPost(OS_OBJ_TYPE_TASK_SUSPEND,                   /* Post to ISR queue                                    */
;;;2174                       (void *)p_tcb,
;;;2175                       DEF_NULL,
;;;2176                       0u,
;;;2177                       0u,
;;;2178                       0u,
;;;2179                       0u,
;;;2180                       p_err);
;;;2181           return;
;;;2182       }
;;;2183   #endif
;;;2184   
;;;2185       OS_TaskSuspend(p_tcb, p_err);
;;;2186   }
000012  bd70              POP      {r4-r6,pc}
                  |L15.20|
000014  4807              LDR      r0,|L15.52|
000016  4285              CMP      r5,r0                 ;2160
000018  d103              BNE      |L15.34|
00001a  f247105b          MOV      r0,#0x715b            ;2161
00001e  8020              STRH     r0,[r4,#0]            ;2161
000020  e7f7              B        |L15.18|
                  |L15.34|
000022  4621              MOV      r1,r4                 ;2185
000024  4628              MOV      r0,r5                 ;2185
000026  f7fffffe          BL       OS_TaskSuspend
00002a  bf00              NOP      
00002c  e7f1              B        |L15.18|
;;;2187   #endif
                          ENDP

00002e  0000              DCW      0x0000
                  |L15.48|
                          DCD      OSIntNestingCtr
                  |L15.52|
                          DCD      OSIdleTaskTCB

                          AREA ||i.OS_TaskChangePrio||, CODE, READONLY, ALIGN=2

                  OS_TaskChangePrio PROC
;;;3097   
;;;3098   void  OS_TaskChangePrio(OS_TCB  *p_tcb,
000000  e92d41f0          PUSH     {r4-r8,lr}
;;;3099                           OS_PRIO  prio_new)
;;;3100   {
000004  4604              MOV      r4,r0
000006  460d              MOV      r5,r1
;;;3101       OS_TCB  *p_tcb_owner;
;;;3102   #if (OS_CFG_MUTEX_EN == DEF_ENABLED)
;;;3103       OS_PRIO  prio_cur;
;;;3104   #endif
;;;3105   
;;;3106   
;;;3107       do {
000008  bf00              NOP      
                  |L16.10|
;;;3108           p_tcb_owner = DEF_NULL;
00000a  2600              MOVS     r6,#0
;;;3109   #if (OS_CFG_MUTEX_EN == DEF_ENABLED)
;;;3110           prio_cur    = p_tcb->Prio;
00000c  f8947037          LDRB     r7,[r4,#0x37]
;;;3111   #endif
;;;3112           switch (p_tcb->TaskState) {
000010  f8940036          LDRB     r0,[r4,#0x36]
000014  2808              CMP      r0,#8
000016  d25e              BCS      |L16.214|
000018  e8dff000          TBB      [pc,r0]
00001c  04191e1f          DCB      0x04,0x19,0x1e,0x1f
000020  1a1b2021          DCB      0x1a,0x1b,0x20,0x21
;;;3113               case OS_TASK_STATE_RDY:
;;;3114                    OS_RdyListRemove(p_tcb);                       /* Remove from current priority                         */
000024  4620              MOV      r0,r4
000026  f7fffffe          BL       OS_RdyListRemove
;;;3115                    p_tcb->Prio = prio_new;                        /* Set new task priority                                */
00002a  f8845037          STRB     r5,[r4,#0x37]
;;;3116                    OS_PrioInsert(p_tcb->Prio);
00002e  f8940037          LDRB     r0,[r4,#0x37]
000032  f7fffffe          BL       OS_PrioInsert
;;;3117                    if (p_tcb == OSTCBCurPtr) {
000036  482c              LDR      r0,|L16.232|
000038  6800              LDR      r0,[r0,#0]  ; OSTCBCurPtr
00003a  4284              CMP      r4,r0
00003c  d103              BNE      |L16.70|
;;;3118                        OS_RdyListInsertHead(p_tcb);
00003e  4620              MOV      r0,r4
000040  f7fffffe          BL       OS_RdyListInsertHead
000044  e002              B        |L16.76|
                  |L16.70|
;;;3119                    } else {
;;;3120                        OS_RdyListInsertTail(p_tcb);
000046  4620              MOV      r0,r4
000048  f7fffffe          BL       OS_RdyListInsertTail
                  |L16.76|
;;;3121                    }
;;;3122                    break;
00004c  e045              B        |L16.218|
;;;3123   
;;;3124               case OS_TASK_STATE_DLY:                             /* Nothing to do except change the priority in the OS_TCB*/
;;;3125               case OS_TASK_STATE_SUSPENDED:
00004e  bf00              NOP      
;;;3126               case OS_TASK_STATE_DLY_SUSPENDED:
000050  bf00              NOP      
;;;3127                    p_tcb->Prio = prio_new;                        /* Set new task priority                                */
000052  f8845037          STRB     r5,[r4,#0x37]
;;;3128                    break;
000056  e040              B        |L16.218|
;;;3129   
;;;3130               case OS_TASK_STATE_PEND:
;;;3131               case OS_TASK_STATE_PEND_TIMEOUT:
000058  bf00              NOP      
;;;3132               case OS_TASK_STATE_PEND_SUSPENDED:
00005a  bf00              NOP      
;;;3133               case OS_TASK_STATE_PEND_TIMEOUT_SUSPENDED:
00005c  bf00              NOP      
;;;3134                    p_tcb->Prio = prio_new;                        /* Set new task priority                                */
00005e  f8845037          STRB     r5,[r4,#0x37]
;;;3135                    switch (p_tcb->PendOn) {                       /* What to do depends on what we are pending on         */
000062  f8940034          LDRB     r0,[r4,#0x34]
000066  2808              CMP      r0,#8
000068  d230              BCS      |L16.204|
00006a  e8dff000          TBB      [pc,r0]
00006e  2f04              DCB      0x2f,0x04
000070  302f0a05          DCB      0x30,0x2f,0x0a,0x05
000074  0631              DCB      0x06,0x31
;;;3136                        case OS_TASK_PEND_ON_FLAG:
;;;3137   #if (OS_CFG_PEND_MULTI_EN == DEF_ENABLED)
;;;3138                        case OS_TASK_PEND_ON_MULTI:
;;;3139   #endif
;;;3140                        case OS_TASK_PEND_ON_Q:
000076  bf00              NOP      
;;;3141                        case OS_TASK_PEND_ON_SEM:
000078  bf00              NOP      
;;;3142                             OS_PendListChangePrio(p_tcb);
00007a  4620              MOV      r0,r4
00007c  f7fffffe          BL       OS_PendListChangePrio
;;;3143                             break;
000080  e027              B        |L16.210|
;;;3144   
;;;3145                        case OS_TASK_PEND_ON_MUTEX:
;;;3146   #if (OS_CFG_MUTEX_EN == DEF_ENABLED)
;;;3147                             OS_PendListChangePrio(p_tcb);
000082  4620              MOV      r0,r4
000084  f7fffffe          BL       OS_PendListChangePrio
;;;3148                             p_tcb_owner = ((OS_MUTEX *)p_tcb->PendDataTblPtr->PendObjPtr)->OwnerTCBPtr;
000088  6b20              LDR      r0,[r4,#0x30]
00008a  68c0              LDR      r0,[r0,#0xc]
00008c  6a46              LDR      r6,[r0,#0x24]
;;;3149                             if (prio_cur > prio_new) {            /* Are we increasing the priority?                      */
00008e  42af              CMP      r7,r5
000090  dd05              BLE      |L16.158|
;;;3150                                 if (p_tcb_owner->Prio <= prio_new) { /* Yes, do we need to give this prio to the owner?   */
000092  f8960037          LDRB     r0,[r6,#0x37]
000096  42a8              CMP      r0,r5
000098  dc17              BGT      |L16.202|
;;;3151                                     p_tcb_owner = DEF_NULL;
00009a  2600              MOVS     r6,#0
00009c  e015              B        |L16.202|
                  |L16.158|
;;;3152                                 } else {
;;;3153   #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;3154                                    TRACE_OS_MUTEX_TASK_PRIO_INHERIT(p_tcb_owner, prio_new);
;;;3155   #endif
;;;3156                                 }
;;;3157                             } else {
;;;3158                                 if (p_tcb_owner->Prio == prio_cur) { /* No, is it required to check for a lower prio?     */
00009e  f8960037          LDRB     r0,[r6,#0x37]
0000a2  42b8              CMP      r0,r7
0000a4  d111              BNE      |L16.202|
;;;3159                                     prio_new = OS_MutexGrpPrioFindHighest(p_tcb_owner);
0000a6  4630              MOV      r0,r6
0000a8  f7fffffe          BL       OS_MutexGrpPrioFindHighest
0000ac  4605              MOV      r5,r0
;;;3160                                     prio_new = prio_new > p_tcb_owner->BasePrio ? p_tcb_owner->BasePrio : prio_new;
0000ae  f8960038          LDRB     r0,[r6,#0x38]
0000b2  42a8              CMP      r0,r5
0000b4  da02              BGE      |L16.188|
0000b6  f8960038          LDRB     r0,[r6,#0x38]
0000ba  e000              B        |L16.190|
                  |L16.188|
0000bc  4628              MOV      r0,r5
                  |L16.190|
0000be  4605              MOV      r5,r0
;;;3161                                     if (prio_new == p_tcb_owner->Prio) {
0000c0  f8960037          LDRB     r0,[r6,#0x37]
0000c4  42a8              CMP      r0,r5
0000c6  d100              BNE      |L16.202|
;;;3162                                         p_tcb_owner = DEF_NULL;
0000c8  2600              MOVS     r6,#0
                  |L16.202|
;;;3163                                     } else {
;;;3164   #if (defined(TRACE_CFG_EN) && (TRACE_CFG_EN == DEF_ENABLED))
;;;3165                                        TRACE_OS_MUTEX_TASK_PRIO_DISINHERIT(p_tcb_owner, prio_new);
;;;3166   #endif
;;;3167                                     }
;;;3168                                 }
;;;3169                             }
;;;3170   #endif
;;;3171                            break;
0000ca  e002              B        |L16.210|
                  |L16.204|
;;;3172   
;;;3173                        case OS_TASK_PEND_ON_TASK_Q:
0000cc  bf00              NOP      
;;;3174                        case OS_TASK_PEND_ON_TASK_SEM:
0000ce  bf00              NOP      
;;;3175                        default:
;;;3176                             break;
0000d0  bf00              NOP      
                  |L16.210|
0000d2  bf00              NOP                            ;3143
;;;3177                    }
;;;3178                    break;
0000d4  e001              B        |L16.218|
                  |L16.214|
;;;3179   
;;;3180               default:
;;;3181                    return;
;;;3182           }
;;;3183           p_tcb = p_tcb_owner;
;;;3184       } while (p_tcb != DEF_NULL);
;;;3185   }
0000d6  e8bd81f0          POP      {r4-r8,pc}
                  |L16.218|
0000da  bf00              NOP                            ;3122
0000dc  4634              MOV      r4,r6                 ;3183
0000de  2c00              CMP      r4,#0                 ;3184
0000e0  d193              BNE      |L16.10|
0000e2  bf00              NOP      
0000e4  e7f7              B        |L16.214|
                          ENDP

0000e6  0000              DCW      0x0000
                  |L16.232|
                          DCD      OSTCBCurPtr

                          AREA ||i.OS_TaskDbgListAdd||, CODE, READONLY, ALIGN=2

                  OS_TaskDbgListAdd PROC
;;;2268   #if (OS_CFG_DBG_EN == DEF_ENABLED)
;;;2269   void  OS_TaskDbgListAdd (OS_TCB  *p_tcb)
000000  2100              MOVS     r1,#0
;;;2270   {
;;;2271       p_tcb->DbgPrevPtr                = DEF_NULL;
000002  f8c010b4          STR      r1,[r0,#0xb4]
;;;2272       if (OSTaskDbgListPtr == DEF_NULL) {
000006  4909              LDR      r1,|L17.44|
000008  6809              LDR      r1,[r1,#0]  ; OSTaskDbgListPtr
00000a  b919              CBNZ     r1,|L17.20|
;;;2273           p_tcb->DbgNextPtr            = DEF_NULL;
00000c  2100              MOVS     r1,#0
00000e  f8c010b8          STR      r1,[r0,#0xb8]
000012  e007              B        |L17.36|
                  |L17.20|
;;;2274       } else {
;;;2275           p_tcb->DbgNextPtr            =  OSTaskDbgListPtr;
000014  4905              LDR      r1,|L17.44|
000016  6809              LDR      r1,[r1,#0]  ; OSTaskDbgListPtr
000018  f8c010b8          STR      r1,[r0,#0xb8]
;;;2276           OSTaskDbgListPtr->DbgPrevPtr =  p_tcb;
00001c  4903              LDR      r1,|L17.44|
00001e  6809              LDR      r1,[r1,#0]  ; OSTaskDbgListPtr
000020  f8c100b4          STR      r0,[r1,#0xb4]
                  |L17.36|
;;;2277       }
;;;2278       OSTaskDbgListPtr                 =  p_tcb;
000024  4901              LDR      r1,|L17.44|
000026  6008              STR      r0,[r1,#0]  ; OSTaskDbgListPtr
;;;2279   }
000028  4770              BX       lr
;;;2280   
                          ENDP

00002a  0000              DCW      0x0000
                  |L17.44|
                          DCD      OSTaskDbgListPtr

                          AREA ||i.OS_TaskDbgListRemove||, CODE, READONLY, ALIGN=2

                  OS_TaskDbgListRemove PROC
;;;2282   
;;;2283   void  OS_TaskDbgListRemove (OS_TCB  *p_tcb)
000000  f8d020b4          LDR      r2,[r0,#0xb4]
;;;2284   {
;;;2285       OS_TCB  *p_tcb_next;
;;;2286       OS_TCB  *p_tcb_prev;
;;;2287   
;;;2288   
;;;2289       p_tcb_prev = p_tcb->DbgPrevPtr;
;;;2290       p_tcb_next = p_tcb->DbgNextPtr;
000004  f8d010b8          LDR      r1,[r0,#0xb8]
;;;2291   
;;;2292       if (p_tcb_prev == DEF_NULL) {
000008  b94a              CBNZ     r2,|L18.30|
;;;2293           OSTaskDbgListPtr = p_tcb_next;
00000a  4b0d              LDR      r3,|L18.64|
00000c  6019              STR      r1,[r3,#0]  ; OSTaskDbgListPtr
;;;2294           if (p_tcb_next != DEF_NULL) {
00000e  b111              CBZ      r1,|L18.22|
;;;2295               p_tcb_next->DbgPrevPtr = DEF_NULL;
000010  2300              MOVS     r3,#0
000012  f8c130b4          STR      r3,[r1,#0xb4]
                  |L18.22|
;;;2296           }
;;;2297           p_tcb->DbgNextPtr = DEF_NULL;
000016  2300              MOVS     r3,#0
000018  f8c030b8          STR      r3,[r0,#0xb8]
00001c  e00f              B        |L18.62|
                  |L18.30|
;;;2298   
;;;2299       } else if (p_tcb_next == DEF_NULL) {
00001e  b929              CBNZ     r1,|L18.44|
;;;2300           p_tcb_prev->DbgNextPtr = DEF_NULL;
000020  2300              MOVS     r3,#0
000022  f8c230b8          STR      r3,[r2,#0xb8]
;;;2301           p_tcb->DbgPrevPtr      = DEF_NULL;
000026  f8c030b4          STR      r3,[r0,#0xb4]
00002a  e008              B        |L18.62|
                  |L18.44|
;;;2302   
;;;2303       } else {
;;;2304           p_tcb_prev->DbgNextPtr =  p_tcb_next;
00002c  f8c210b8          STR      r1,[r2,#0xb8]
;;;2305           p_tcb_next->DbgPrevPtr =  p_tcb_prev;
000030  f8c120b4          STR      r2,[r1,#0xb4]
;;;2306           p_tcb->DbgNextPtr      = DEF_NULL;
000034  2300              MOVS     r3,#0
000036  f8c030b8          STR      r3,[r0,#0xb8]
;;;2307           p_tcb->DbgPrevPtr      = DEF_NULL;
00003a  f8c030b4          STR      r3,[r0,#0xb4]
                  |L18.62|
;;;2308       }
;;;2309   }
00003e  4770              BX       lr
;;;2310   #endif
                          ENDP

                  |L18.64|
                          DCD      OSTaskDbgListPtr

                          AREA ||i.OS_TaskInit||, CODE, READONLY, ALIGN=2

                  OS_TaskInit PROC
;;;2329   
;;;2330   void  OS_TaskInit (OS_ERR  *p_err)
000000  2100              MOVS     r1,#0
;;;2331   {
;;;2332   #if (OS_CFG_DBG_EN == DEF_ENABLED)
;;;2333       OSTaskDbgListPtr = DEF_NULL;
000002  4a04              LDR      r2,|L19.20|
000004  6011              STR      r1,[r2,#0]  ; OSTaskDbgListPtr
;;;2334   #endif
;;;2335   
;;;2336       OSTaskQty        = 0u;                                      /* Clear the number of tasks                            */
000006  4a04              LDR      r2,|L19.24|
000008  8011              STRH     r1,[r2,#0]
;;;2337   
;;;2338   #if ((OS_CFG_TASK_PROFILE_EN == DEF_ENABLED) || (OS_CFG_DBG_EN == DEF_ENABLED))
;;;2339       OSTaskCtxSwCtr   = 0u;                                      /* Clear the context switch counter                     */
00000a  4a04              LDR      r2,|L19.28|
00000c  6011              STR      r1,[r2,#0]  ; OSTaskCtxSwCtr
;;;2340   #endif
;;;2341   
;;;2342      *p_err            = OS_ERR_NONE;
00000e  8001              STRH     r1,[r0,#0]
;;;2343   }
000010  4770              BX       lr
;;;2344   
                          ENDP

000012  0000              DCW      0x0000
                  |L19.20|
                          DCD      OSTaskDbgListPtr
                  |L19.24|
                          DCD      OSTaskQty
                  |L19.28|
                          DCD      OSTaskCtxSwCtr

                          AREA ||i.OS_TaskInitTCB||, CODE, READONLY, ALIGN=2

                  OS_TaskInitTCB PROC
;;;2359   
;;;2360   void  OS_TaskInitTCB (OS_TCB  *p_tcb)
000000  b570              PUSH     {r4-r6,lr}
;;;2361   {
000002  4604              MOV      r4,r0
;;;2362   #if (OS_CFG_TASK_REG_TBL_SIZE > 0u)
;;;2363       OS_REG_ID   reg_id;
;;;2364   #endif
;;;2365   #if defined(OS_CFG_TLS_TBL_SIZE) && (OS_CFG_TLS_TBL_SIZE > 0u)
;;;2366       OS_TLS_ID   id;
;;;2367   #endif
;;;2368   
;;;2369   
;;;2370       p_tcb->StkPtr             = DEF_NULL;
000004  2000              MOVS     r0,#0
000006  6020              STR      r0,[r4,#0]
;;;2371   #if ((OS_CFG_DBG_EN == DEF_ENABLED) || (OS_CFG_STAT_TASK_STK_CHK_EN == DEF_ENABLED))
;;;2372       p_tcb->StkLimitPtr        = DEF_NULL;
000008  60e0              STR      r0,[r4,#0xc]
;;;2373   #endif
;;;2374   
;;;2375       p_tcb->ExtPtr             = DEF_NULL;
00000a  6060              STR      r0,[r4,#4]
;;;2376   
;;;2377       p_tcb->NextPtr            = DEF_NULL;
00000c  6120              STR      r0,[r4,#0x10]
;;;2378       p_tcb->PrevPtr            = DEF_NULL;
00000e  6160              STR      r0,[r4,#0x14]
;;;2379   
;;;2380   #if (OS_CFG_TASK_TICK_EN == DEF_ENABLED)
;;;2381       p_tcb->TickNextPtr        = DEF_NULL;
000010  61a0              STR      r0,[r4,#0x18]
;;;2382       p_tcb->TickPrevPtr        = DEF_NULL;
000012  61e0              STR      r0,[r4,#0x1c]
;;;2383       p_tcb->TickListPtr        = DEF_NULL;
000014  6220              STR      r0,[r4,#0x20]
;;;2384   #endif
;;;2385   
;;;2386   #if (OS_CFG_DBG_EN == DEF_ENABLED)
;;;2387       p_tcb->NamePtr            = (CPU_CHAR *)((void *)"?Task");
000016  a026              ADR      r0,|L20.176|
000018  60a0              STR      r0,[r4,#8]
;;;2388   #endif
;;;2389   
;;;2390   #if ((OS_CFG_DBG_EN == DEF_ENABLED) || (OS_CFG_STAT_TASK_STK_CHK_EN == DEF_ENABLED))
;;;2391       p_tcb->StkBasePtr         = DEF_NULL;
00001a  2000              MOVS     r0,#0
00001c  6260              STR      r0,[r4,#0x24]
;;;2392   #endif
;;;2393   
;;;2394   #if (OS_CFG_DBG_EN == DEF_ENABLED)
;;;2395       p_tcb->TaskEntryAddr      = 0u;
00001e  62a0              STR      r0,[r4,#0x28]
;;;2396       p_tcb->TaskEntryArg       = DEF_NULL;
000020  62e0              STR      r0,[r4,#0x2c]
;;;2397   #endif
;;;2398   
;;;2399   #if (OS_CFG_PEND_MULTI_EN == DEF_ENABLED)
;;;2400       p_tcb->PendDataTblPtr     = DEF_NULL;
;;;2401       p_tcb->PendDataTblEntries = 0u;
;;;2402   #endif
;;;2403   
;;;2404   #if (OS_CFG_TS_EN == DEF_ENABLED)
;;;2405       p_tcb->TS                 = 0u;
000022  64a0              STR      r0,[r4,#0x48]
;;;2406   #endif
;;;2407   
;;;2408   #if (OS_MSG_EN == DEF_ENABLED)
;;;2409       p_tcb->MsgPtr             = DEF_NULL;
000024  65a0              STR      r0,[r4,#0x58]
;;;2410       p_tcb->MsgSize            = 0u;
000026  f8a4005c          STRH     r0,[r4,#0x5c]
;;;2411   #endif
;;;2412   
;;;2413   #if (OS_CFG_TASK_Q_EN == DEF_ENABLED)
;;;2414       OS_MsgQInit(&p_tcb->MsgQ,
00002a  2100              MOVS     r1,#0
00002c  f1040060          ADD      r0,r4,#0x60
000030  f7fffffe          BL       OS_MsgQInit
;;;2415                    0u);
;;;2416   #if (OS_CFG_TASK_PROFILE_EN == DEF_ENABLED)
;;;2417       p_tcb->MsgQPendTime       = 0u;
000034  2000              MOVS     r0,#0
000036  6720              STR      r0,[r4,#0x70]
;;;2418       p_tcb->MsgQPendTimeMax    = 0u;
000038  6760              STR      r0,[r4,#0x74]
;;;2419   #endif
;;;2420   #endif
;;;2421   
;;;2422   #if (OS_CFG_FLAG_EN == DEF_ENABLED)
;;;2423       p_tcb->FlagsPend          = 0u;
00003a  67e0              STR      r0,[r4,#0x7c]
;;;2424       p_tcb->FlagsOpt           = 0u;
00003c  f8a40084          STRH     r0,[r4,#0x84]
;;;2425       p_tcb->FlagsRdy           = 0u;
000040  f8c40080          STR      r0,[r4,#0x80]
;;;2426   #endif
;;;2427   
;;;2428   #if (OS_CFG_TASK_REG_TBL_SIZE > 0u)
;;;2429       for (reg_id = 0u; reg_id < OS_CFG_TASK_REG_TBL_SIZE; reg_id++) {
000044  2500              MOVS     r5,#0
000046  e006              B        |L20.86|
                  |L20.72|
;;;2430           p_tcb->RegTbl[reg_id] = 0u;
000048  2100              MOVS     r1,#0
00004a  f1040078          ADD      r0,r4,#0x78
00004e  f8401025          STR      r1,[r0,r5,LSL #2]
000052  1c68              ADDS     r0,r5,#1              ;2429
000054  b2c5              UXTB     r5,r0                 ;2429
                  |L20.86|
000056  2d00              CMP      r5,#0                 ;2429
000058  d0f6              BEQ      |L20.72|
;;;2431       }
;;;2432   #endif
;;;2433   
;;;2434   #if defined(OS_CFG_TLS_TBL_SIZE) && (OS_CFG_TLS_TBL_SIZE > 0u)
;;;2435       for (id = 0u; id < OS_CFG_TLS_TBL_SIZE; id++) {
;;;2436           p_tcb->TLS_Tbl[id]    = 0u;
;;;2437       }
;;;2438   #endif
;;;2439   
;;;2440       p_tcb->SemCtr             = 0u;
00005a  2000              MOVS     r0,#0
00005c  3434              ADDS     r4,r4,#0x34
00005e  61a0              STR      r0,[r4,#0x18]
;;;2441   #if (OS_CFG_TASK_PROFILE_EN == DEF_ENABLED)
;;;2442       p_tcb->SemPendTime        = 0u;
000060  66e0              STR      r0,[r4,#0x6c]
;;;2443       p_tcb->SemPendTimeMax     = 0u;
000062  6720              STR      r0,[r4,#0x70]
;;;2444   #endif
;;;2445   
;;;2446   #if ((OS_CFG_DBG_EN == DEF_ENABLED) || (OS_CFG_STAT_TASK_STK_CHK_EN == DEF_ENABLED))
;;;2447       p_tcb->StkSize            = 0u;
000064  60e0              STR      r0,[r4,#0xc]
;;;2448   #endif
;;;2449   
;;;2450   
;;;2451   #if (OS_CFG_TASK_SUSPEND_EN == DEF_ENABLED)
;;;2452       p_tcb->SuspendCtr         = 0u;
000066  f8840052          STRB     r0,[r4,#0x52]
;;;2453   #endif
;;;2454   
;;;2455   #if (OS_CFG_STAT_TASK_STK_CHK_EN == DEF_ENABLED)
;;;2456       p_tcb->StkFree            = 0u;
00006a  67a0              STR      r0,[r4,#0x78]
;;;2457       p_tcb->StkUsed            = 0u;
00006c  6760              STR      r0,[r4,#0x74]
;;;2458   #endif
;;;2459   
;;;2460       p_tcb->Opt                = 0u;
00006e  8220              STRH     r0,[r4,#0x10]
;;;2461   
;;;2462   #if (OS_CFG_TASK_TICK_EN == DEF_ENABLED)
;;;2463       p_tcb->TickRemain         = 0u;
000070  61e0              STR      r0,[r4,#0x1c]
;;;2464       p_tcb->TickCtrPrev        = 0u;
000072  6220              STR      r0,[r4,#0x20]
;;;2465   #endif
;;;2466   
;;;2467   #if (OS_CFG_SCHED_ROUND_ROBIN_EN == DEF_ENABLED)
;;;2468       p_tcb->TimeQuanta         = 0u;
;;;2469       p_tcb->TimeQuantaCtr      = 0u;
;;;2470   #endif
;;;2471   
;;;2472   #if (OS_CFG_TASK_PROFILE_EN == DEF_ENABLED)
;;;2473       p_tcb->CPUUsage           = 0u;
000074  f8a40054          STRH     r0,[r4,#0x54]
;;;2474       p_tcb->CPUUsageMax        = 0u;
000078  f8a40056          STRH     r0,[r4,#0x56]
;;;2475       p_tcb->CtxSwCtr           = 0u;
00007c  65a0              STR      r0,[r4,#0x58]
;;;2476       p_tcb->CyclesDelta        = 0u;
00007e  65e0              STR      r0,[r4,#0x5c]
;;;2477   #if (OS_CFG_TS_EN == DEF_ENABLED)
;;;2478       p_tcb->CyclesStart        = OS_TS_GET();                    /* Read the current timestamp and save                    */
000080  f7fffffe          BL       CPU_TS_TmrRd
000084  6620              STR      r0,[r4,#0x60]
;;;2479   #else
;;;2480       p_tcb->CyclesStart        = 0u;
;;;2481   #endif
;;;2482       p_tcb->CyclesTotal        = 0u;
000086  2000              MOVS     r0,#0
000088  6660              STR      r0,[r4,#0x64]
;;;2483   #endif
;;;2484   
;;;2485   #ifdef CPU_CFG_INT_DIS_MEAS_EN
;;;2486       p_tcb->IntDisTimeMax      = 0u;
00008a  67e0              STR      r0,[r4,#0x7c]
;;;2487   #endif
;;;2488   #if (OS_CFG_SCHED_LOCK_TIME_MEAS_EN == DEF_ENABLED)
;;;2489       p_tcb->SchedLockTimeMax   = 0u;
;;;2490   #endif
;;;2491   
;;;2492       p_tcb->PendOn             = OS_TASK_PEND_ON_NOTHING;
00008c  7020              STRB     r0,[r4,#0]
;;;2493       p_tcb->PendStatus         = OS_STATUS_PEND_OK;
00008e  7060              STRB     r0,[r4,#1]
;;;2494       p_tcb->TaskState          = OS_TASK_STATE_RDY;
000090  70a0              STRB     r0,[r4,#2]
;;;2495   
;;;2496       p_tcb->Prio               = OS_PRIO_INIT;
000092  2020              MOVS     r0,#0x20
000094  70e0              STRB     r0,[r4,#3]
;;;2497   #if (OS_CFG_MUTEX_EN == DEF_ENABLED)
;;;2498       p_tcb->BasePrio           = OS_PRIO_INIT;
000096  7120              STRB     r0,[r4,#4]
;;;2499       p_tcb->MutexGrpHeadPtr    = DEF_NULL;
000098  2000              MOVS     r0,#0
00009a  60a0              STR      r0,[r4,#8]
;;;2500   #endif
;;;2501   
;;;2502   #if (OS_CFG_DBG_EN == DEF_ENABLED)
;;;2503       p_tcb->DbgPrevPtr         = DEF_NULL;
00009c  f8c40080          STR      r0,[r4,#0x80]
;;;2504       p_tcb->DbgNextPtr         = DEF_NULL;
0000a0  f8c40084          STR      r0,[r4,#0x84]
;;;2505       p_tcb->DbgNamePtr         = (CPU_CHAR *)((void *)" ");
0000a4  a004              ADR      r0,|L20.184|
0000a6  f8c40088          STR      r0,[r4,#0x88]
0000aa  3c34              SUBS     r4,r4,#0x34
;;;2506   #endif
;;;2507   }
0000ac  bd70              POP      {r4-r6,pc}
;;;2508   
                          ENDP

0000ae  0000              DCW      0x0000
                  |L20.176|
0000b0  3f546173          DCB      "?Task",0
0000b4  6b00    
0000b6  00                DCB      0
0000b7  00                DCB      0
                  |L20.184|
0000b8  2000              DCB      " ",0
0000ba  00                DCB      0
0000bb  00                DCB      0

                          AREA ||i.OS_TaskQPost||, CODE, READONLY, ALIGN=2

                  OS_TaskQPost PROC
;;;2551   #if (OS_CFG_TASK_Q_EN == DEF_ENABLED)
;;;2552   void  OS_TaskQPost (OS_TCB       *p_tcb,
000000  e92d47fc          PUSH     {r2-r10,lr}
;;;2553                       void         *p_void,
;;;2554                       OS_MSG_SIZE   msg_size,
;;;2555                       OS_OPT        opt,
;;;2556                       CPU_TS        ts,
;;;2557                       OS_ERR       *p_err)
;;;2558   {
000004  4604              MOV      r4,r0
000006  460f              MOV      r7,r1
000008  4690              MOV      r8,r2
00000a  4699              MOV      r9,r3
00000c  e9dd650a          LDRD     r6,r5,[sp,#0x28]
;;;2559       CPU_SR_ALLOC();
000010  f04f0a00          MOV      r10,#0
;;;2560   
;;;2561   
;;;2562   
;;;2563      *p_err = OS_ERR_NONE;                                        /* Assume we won't have any errors                      */
000014  2000              MOVS     r0,#0
000016  8028              STRH     r0,[r5,#0]
;;;2564       OS_CRITICAL_ENTER();
000018  bf00              NOP      
00001a  bf00              NOP      
00001c  f7fffffe          BL       CPU_SR_Save
000020  4682              MOV      r10,r0
000022  bf00              NOP      
000024  f7fffffe          BL       CPU_IntDisMeasStart
000028  bf00              NOP      
;;;2565       if (p_tcb == DEF_NULL) {                                    /* Post msg to 'self'?                                  */
00002a  b90c              CBNZ     r4,|L21.48|
;;;2566           p_tcb = OSTCBCurPtr;
00002c  4830              LDR      r0,|L21.240|
00002e  6804              LDR      r4,[r0,#0]  ; OSTCBCurPtr
                  |L21.48|
;;;2567       }
;;;2568       switch (p_tcb->TaskState) {
000030  f8940036          LDRB     r0,[r4,#0x36]
000034  2808              CMP      r0,#8
000036  d24b              BCS      |L21.208|
000038  e8dff000          TBB      [pc,r0]
00003c  04051a1b          DCB      0x04,0x05,0x1a,0x1b
000040  06071c1d          DCB      0x06,0x07,0x1c,0x1d
;;;2569           case OS_TASK_STATE_RDY:
;;;2570           case OS_TASK_STATE_DLY:
000044  bf00              NOP      
;;;2571           case OS_TASK_STATE_SUSPENDED:
000046  bf00              NOP      
;;;2572           case OS_TASK_STATE_DLY_SUSPENDED:
000048  bf00              NOP      
;;;2573                OS_MsgQPut(&p_tcb->MsgQ,                           /* Deposit the message in the queue                     */
00004a  464b              MOV      r3,r9
00004c  4642              MOV      r2,r8
00004e  4639              MOV      r1,r7
000050  f1040060          ADD      r0,r4,#0x60
000054  e9cd6500          STRD     r6,r5,[sp,#0]
000058  f7fffffe          BL       OS_MsgQPut
;;;2574                           p_void,
;;;2575                           msg_size,
;;;2576                           opt,
;;;2577                           ts,
;;;2578                           p_err);
;;;2579                OS_CRITICAL_EXIT();
00005c  bf00              NOP      
00005e  f7fffffe          BL       CPU_IntDisMeasStop
000062  bf00              NOP      
000064  4650              MOV      r0,r10
000066  f7fffffe          BL       CPU_SR_Restore
00006a  bf00              NOP      
00006c  bf00              NOP      
;;;2580                break;
00006e  e03c              B        |L21.234|
;;;2581   
;;;2582           case OS_TASK_STATE_PEND:
;;;2583           case OS_TASK_STATE_PEND_TIMEOUT:
000070  bf00              NOP      
;;;2584           case OS_TASK_STATE_PEND_SUSPENDED:
000072  bf00              NOP      
;;;2585           case OS_TASK_STATE_PEND_TIMEOUT_SUSPENDED:
000074  bf00              NOP      
;;;2586                if (p_tcb->PendOn == OS_TASK_PEND_ON_TASK_Q) {     /* Is task waiting for a message to be sent to it?      */
000076  f8940034          LDRB     r0,[r4,#0x34]
00007a  2802              CMP      r0,#2
00007c  d115              BNE      |L21.170|
;;;2587                    OS_Post(DEF_NULL,
00007e  4643              MOV      r3,r8
000080  463a              MOV      r2,r7
000082  4621              MOV      r1,r4
000084  2000              MOVS     r0,#0
000086  9600              STR      r6,[sp,#0]
000088  f7fffffe          BL       OS_Post
;;;2588                            p_tcb,
;;;2589                            p_void,
;;;2590                            msg_size,
;;;2591                            ts);
;;;2592                    OS_CRITICAL_EXIT_NO_SCHED();
00008c  bf00              NOP      
00008e  f7fffffe          BL       CPU_IntDisMeasStop
000092  bf00              NOP      
000094  4650              MOV      r0,r10
000096  f7fffffe          BL       CPU_SR_Restore
00009a  bf00              NOP      
00009c  bf00              NOP      
;;;2593                    if ((opt & OS_OPT_POST_NO_SCHED) == 0u) {
00009e  f4094000          AND      r0,r9,#0x8000
0000a2  b9a0              CBNZ     r0,|L21.206|
;;;2594                        OSSched();                                 /* Run the scheduler                                    */
0000a4  f7fffffe          BL       OSSched
0000a8  e011              B        |L21.206|
                  |L21.170|
;;;2595                    }
;;;2596                } else {
;;;2597                    OS_MsgQPut(&p_tcb->MsgQ,                       /* No,  Task is pending on something else ...           */
0000aa  464b              MOV      r3,r9
0000ac  4642              MOV      r2,r8
0000ae  4639              MOV      r1,r7
0000b0  f1040060          ADD      r0,r4,#0x60
0000b4  e9cd6500          STRD     r6,r5,[sp,#0]
0000b8  f7fffffe          BL       OS_MsgQPut
;;;2598                               p_void,                             /* ... Deposit the message in the task's queue          */
;;;2599                               msg_size,
;;;2600                               opt,
;;;2601                               ts,
;;;2602                               p_err);
;;;2603                    OS_CRITICAL_EXIT();
0000bc  bf00              NOP      
0000be  f7fffffe          BL       CPU_IntDisMeasStop
0000c2  bf00              NOP      
0000c4  4650              MOV      r0,r10
0000c6  f7fffffe          BL       CPU_SR_Restore
0000ca  bf00              NOP      
0000cc  bf00              NOP      
                  |L21.206|
;;;2604                }
;;;2605                break;
0000ce  e00c              B        |L21.234|
                  |L21.208|
;;;2606   
;;;2607           default:
;;;2608                OS_CRITICAL_EXIT();
0000d0  bf00              NOP      
0000d2  f7fffffe          BL       CPU_IntDisMeasStop
0000d6  bf00              NOP      
0000d8  4650              MOV      r0,r10
0000da  f7fffffe          BL       CPU_SR_Restore
0000de  bf00              NOP      
0000e0  bf00              NOP      
;;;2609               *p_err = OS_ERR_STATE_INVALID;
0000e2  f646602d          MOV      r0,#0x6e2d
0000e6  8028              STRH     r0,[r5,#0]
;;;2610                break;
0000e8  bf00              NOP      
                  |L21.234|
0000ea  bf00              NOP                            ;2580
;;;2611       }
;;;2612   }
0000ec  e8bd87fc          POP      {r2-r10,pc}
;;;2613   #endif
                          ENDP

                  |L21.240|
                          DCD      OSTCBCurPtr

                          AREA ||i.OS_TaskResume||, CODE, READONLY, ALIGN=1

                  OS_TaskResume PROC
;;;2637   #if (OS_CFG_TASK_SUSPEND_EN == DEF_ENABLED)
;;;2638   void  OS_TaskResume (OS_TCB  *p_tcb,
000000  b570              PUSH     {r4-r6,lr}
;;;2639                        OS_ERR  *p_err)
;;;2640   {
000002  4604              MOV      r4,r0
000004  460d              MOV      r5,r1
;;;2641       CPU_SR_ALLOC();
000006  2600              MOVS     r6,#0
;;;2642   
;;;2643   
;;;2644       CPU_CRITICAL_ENTER();
000008  bf00              NOP      
00000a  bf00              NOP      
00000c  f7fffffe          BL       CPU_SR_Save
000010  4606              MOV      r6,r0
000012  bf00              NOP      
000014  f7fffffe          BL       CPU_IntDisMeasStart
000018  bf00              NOP      
;;;2645      *p_err  = OS_ERR_NONE;
00001a  2000              MOVS     r0,#0
00001c  8028              STRH     r0,[r5,#0]
;;;2646       switch (p_tcb->TaskState) {
00001e  f8940036          LDRB     r0,[r4,#0x36]
000022  2808              CMP      r0,#8
000024  d268              BCS      |L22.248|
000026  e8dff000          TBB      [pc,r0]
00002a  0405              DCB      0x04,0x05
00002c  0607142b          DCB      0x06,0x07,0x14,0x2b
000030  3f53              DCB      0x3f,0x53
;;;2647           case OS_TASK_STATE_RDY:
;;;2648           case OS_TASK_STATE_DLY:
000032  bf00              NOP      
;;;2649           case OS_TASK_STATE_PEND:
000034  bf00              NOP      
;;;2650           case OS_TASK_STATE_PEND_TIMEOUT:
000036  bf00              NOP      
;;;2651                CPU_CRITICAL_EXIT();
000038  bf00              NOP      
00003a  f7fffffe          BL       CPU_IntDisMeasStop
00003e  bf00              NOP      
000040  4630              MOV      r0,r6
000042  f7fffffe          BL       CPU_SR_Restore
000046  bf00              NOP      
000048  bf00              NOP      
;;;2652               *p_err = OS_ERR_TASK_NOT_SUSPENDED;
00004a  f2471053          MOV      r0,#0x7153
00004e  8028              STRH     r0,[r5,#0]
;;;2653                break;
000050  e05f              B        |L22.274|
;;;2654   
;;;2655           case OS_TASK_STATE_SUSPENDED:
;;;2656                OS_CRITICAL_ENTER_CPU_EXIT();
;;;2657                p_tcb->SuspendCtr--;
000052  f8140f86          LDRB     r0,[r4,#0x86]!
000056  1e40              SUBS     r0,r0,#1
000058  7020              STRB     r0,[r4,#0]
;;;2658                if (p_tcb->SuspendCtr == 0u) {
00005a  f8140986          LDRB     r0,[r4],#-0x86
00005e  b928              CBNZ     r0,|L22.108|
;;;2659                    p_tcb->TaskState = OS_TASK_STATE_RDY;
000060  2000              MOVS     r0,#0
000062  f8840036          STRB     r0,[r4,#0x36]
;;;2660                    OS_RdyListInsert(p_tcb);                       /* Insert the task in the ready list                    */
000066  4620              MOV      r0,r4
000068  f7fffffe          BL       OS_RdyListInsert
                  |L22.108|
;;;2661                }
;;;2662                OS_CRITICAL_EXIT_NO_SCHED();
00006c  bf00              NOP      
00006e  f7fffffe          BL       CPU_IntDisMeasStop
000072  bf00              NOP      
000074  4630              MOV      r0,r6
000076  f7fffffe          BL       CPU_SR_Restore
00007a  bf00              NOP      
00007c  bf00              NOP      
;;;2663                break;
00007e  e048              B        |L22.274|
;;;2664   
;;;2665           case OS_TASK_STATE_DLY_SUSPENDED:
;;;2666                p_tcb->SuspendCtr--;
000080  f8140f86          LDRB     r0,[r4,#0x86]!
000084  1e40              SUBS     r0,r0,#1
000086  7020              STRB     r0,[r4,#0]
;;;2667                if (p_tcb->SuspendCtr == 0u) {
000088  f8140986          LDRB     r0,[r4],#-0x86
00008c  b910              CBNZ     r0,|L22.148|
;;;2668                    p_tcb->TaskState = OS_TASK_STATE_DLY;
00008e  2001              MOVS     r0,#1
000090  f8840036          STRB     r0,[r4,#0x36]
                  |L22.148|
;;;2669                }
;;;2670                CPU_CRITICAL_EXIT();
000094  bf00              NOP      
000096  f7fffffe          BL       CPU_IntDisMeasStop
00009a  bf00              NOP      
00009c  4630              MOV      r0,r6
00009e  f7fffffe          BL       CPU_SR_Restore
0000a2  bf00              NOP      
0000a4  bf00              NOP      
;;;2671                break;
0000a6  e034              B        |L22.274|
;;;2672   
;;;2673           case OS_TASK_STATE_PEND_SUSPENDED:
;;;2674                p_tcb->SuspendCtr--;
0000a8  f8140f86          LDRB     r0,[r4,#0x86]!
0000ac  1e40              SUBS     r0,r0,#1
0000ae  7020              STRB     r0,[r4,#0]
;;;2675                if (p_tcb->SuspendCtr == 0u) {
0000b0  f8140986          LDRB     r0,[r4],#-0x86
0000b4  b910              CBNZ     r0,|L22.188|
;;;2676                    p_tcb->TaskState = OS_TASK_STATE_PEND;
0000b6  2002              MOVS     r0,#2
0000b8  f8840036          STRB     r0,[r4,#0x36]
                  |L22.188|
;;;2677                }
;;;2678                CPU_CRITICAL_EXIT();
0000bc  bf00              NOP      
0000be  f7fffffe          BL       CPU_IntDisMeasStop
0000c2  bf00              NOP      
0000c4  4630              MOV      r0,r6
0000c6  f7fffffe          BL       CPU_SR_Restore
0000ca  bf00              NOP      
0000cc  bf00              NOP      
;;;2679                break;
0000ce  e020              B        |L22.274|
;;;2680   
;;;2681           case OS_TASK_STATE_PEND_TIMEOUT_SUSPENDED:
;;;2682                p_tcb->SuspendCtr--;
0000d0  f8140f86          LDRB     r0,[r4,#0x86]!
0000d4  1e40              SUBS     r0,r0,#1
0000d6  7020              STRB     r0,[r4,#0]
;;;2683                if (p_tcb->SuspendCtr == 0u) {
0000d8  f8140986          LDRB     r0,[r4],#-0x86
0000dc  b910              CBNZ     r0,|L22.228|
;;;2684                    p_tcb->TaskState = OS_TASK_STATE_PEND_TIMEOUT;
0000de  2003              MOVS     r0,#3
0000e0  f8840036          STRB     r0,[r4,#0x36]
                  |L22.228|
;;;2685                }
;;;2686                CPU_CRITICAL_EXIT();
0000e4  bf00              NOP      
0000e6  f7fffffe          BL       CPU_IntDisMeasStop
0000ea  bf00              NOP      
0000ec  4630              MOV      r0,r6
0000ee  f7fffffe          BL       CPU_SR_Restore
0000f2  bf00              NOP      
0000f4  bf00              NOP      
;;;2687                break;
0000f6  e00c              B        |L22.274|
                  |L22.248|
;;;2688   
;;;2689           default:
;;;2690                CPU_CRITICAL_EXIT();
0000f8  bf00              NOP      
0000fa  f7fffffe          BL       CPU_IntDisMeasStop
0000fe  bf00              NOP      
000100  4630              MOV      r0,r6
000102  f7fffffe          BL       CPU_SR_Restore
000106  bf00              NOP      
000108  bf00              NOP      
;;;2691               *p_err = OS_ERR_STATE_INVALID;
00010a  f646602d          MOV      r0,#0x6e2d
00010e  8028              STRH     r0,[r5,#0]
                  |L22.272|
;;;2692                return;
;;;2693       }
;;;2694   
;;;2695       OSSched();
;;;2696   }
000110  bd70              POP      {r4-r6,pc}
                  |L22.274|
000112  bf00              NOP                            ;2653
000114  f7fffffe          BL       OSSched
000118  bf00              NOP      
00011a  e7f9              B        |L22.272|
;;;2697   #endif
                          ENDP


                          AREA ||i.OS_TaskReturn||, CODE, READONLY, ALIGN=2

                  OS_TaskReturn PROC
;;;2714   
;;;2715   void  OS_TaskReturn (void)
000000  b508              PUSH     {r3,lr}
;;;2716   {
;;;2717       OS_ERR  err;
;;;2718   
;;;2719   
;;;2720   
;;;2721       OSTaskReturnHook(OSTCBCurPtr);                              /* Call hook to let user decide on what to do           */
000002  4806              LDR      r0,|L23.28|
000004  6800              LDR      r0,[r0,#0]  ; OSTCBCurPtr
000006  f7fffffe          BL       OSTaskReturnHook
;;;2722   #if (OS_CFG_TASK_DEL_EN == DEF_ENABLED)
;;;2723       OSTaskDel( DEF_NULL,                                        /* Delete task if it accidentally returns!              */
;;;2724                 &err);
;;;2725   #else
;;;2726       while (DEF_TRUE) {
00000a  e006              B        |L23.26|
                  |L23.12|
;;;2727           OSTimeDly(OSCfg_TickRate_Hz,
00000c  466a              MOV      r2,sp
00000e  2100              MOVS     r1,#0
000010  4803              LDR      r0,|L23.32|
000012  6800              LDR      r0,[r0,#0]  ; OSCfg_TickRate_Hz
000014  f7fffffe          BL       OSTimeDly
;;;2728                     OS_OPT_TIME_DLY,
;;;2729                     &err);
;;;2730           (void)err;
000018  bf00              NOP      
                  |L23.26|
00001a  e7f7              B        |L23.12|
;;;2731       }
;;;2732   #endif
;;;2733   }
;;;2734   
                          ENDP

                  |L23.28|
                          DCD      OSTCBCurPtr
                  |L23.32|
                          DCD      OSCfg_TickRate_Hz

                          AREA ||i.OS_TaskSemPost||, CODE, READONLY, ALIGN=2

                  OS_TaskSemPost PROC
;;;2765   
;;;2766   OS_SEM_CTR  OS_TaskSemPost (OS_TCB  *p_tcb,
000000  e92d43f8          PUSH     {r3-r9,lr}
;;;2767                               OS_OPT   opt,
;;;2768                               CPU_TS   ts,
;;;2769                               OS_ERR  *p_err)
;;;2770   {
000004  4604              MOV      r4,r0
000006  4688              MOV      r8,r1
000008  4617              MOV      r7,r2
00000a  461d              MOV      r5,r3
;;;2771       OS_SEM_CTR  ctr;
;;;2772       CPU_SR_ALLOC();
00000c  f04f0900          MOV      r9,#0
;;;2773   
;;;2774   
;;;2775   #if (OS_CFG_TS_EN == DEF_DISABLED)
;;;2776       (void)ts;                                                   /* Prevent compiler warning for not using 'ts'          */
;;;2777   #endif
;;;2778   
;;;2779       OS_CRITICAL_ENTER();
000010  bf00              NOP      
000012  bf00              NOP      
000014  f7fffffe          BL       CPU_SR_Save
000018  4681              MOV      r9,r0
00001a  bf00              NOP      
00001c  f7fffffe          BL       CPU_IntDisMeasStart
000020  bf00              NOP      
;;;2780       if (p_tcb == DEF_NULL) {                                    /* Post signal to 'self'?                               */
000022  b90c              CBNZ     r4,|L24.40|
;;;2781           p_tcb = OSTCBCurPtr;
000024  4871              LDR      r0,|L24.492|
000026  6804              LDR      r4,[r0,#0]  ; OSTCBCurPtr
                  |L24.40|
;;;2782       }
;;;2783   #if (OS_CFG_TS_EN == DEF_ENABLED)
;;;2784       p_tcb->TS = ts;
000028  64a7              STR      r7,[r4,#0x48]
;;;2785   #endif
;;;2786      *p_err     = OS_ERR_NONE;                                    /* Assume we won't have any errors                      */
00002a  2000              MOVS     r0,#0
00002c  8028              STRH     r0,[r5,#0]
;;;2787       switch (p_tcb->TaskState) {
00002e  f8940036          LDRB     r0,[r4,#0x36]
000032  2808              CMP      r0,#8
000034  d278              BCS      |L24.296|
000036  e8dff000          TBB      [pc,r0]
00003a  0405              DCB      0x04,0x05
00003c  58590607          DCB      0x58,0x59,0x06,0x07
000040  5a5b              DCB      0x5a,0x5b
;;;2788           case OS_TASK_STATE_RDY:
;;;2789           case OS_TASK_STATE_DLY:
000042  bf00              NOP      
;;;2790           case OS_TASK_STATE_SUSPENDED:
000044  bf00              NOP      
;;;2791           case OS_TASK_STATE_DLY_SUSPENDED:
000046  bf00              NOP      
;;;2792                switch (sizeof(OS_SEM_CTR)) {
000048  2004              MOVS     r0,#4
00004a  2801              CMP      r0,#1
00004c  d004              BEQ      |L24.88|
00004e  2802              CMP      r0,#2
000050  d015              BEQ      |L24.126|
000052  2804              CMP      r0,#4
000054  d139              BNE      |L24.202|
000056  e026              B        |L24.166|
                  |L24.88|
;;;2793                    case 1u:
;;;2794                         if (p_tcb->SemCtr == DEF_INT_08U_MAX_VAL) {
000058  6ce0              LDR      r0,[r4,#0x4c]
00005a  28ff              CMP      r0,#0xff
00005c  d10e              BNE      |L24.124|
;;;2795                             OS_CRITICAL_EXIT();
00005e  bf00              NOP      
000060  f7fffffe          BL       CPU_IntDisMeasStop
000064  bf00              NOP      
000066  4648              MOV      r0,r9
000068  f7fffffe          BL       CPU_SR_Restore
00006c  bf00              NOP      
00006e  bf00              NOP      
;;;2796                            *p_err = OS_ERR_SEM_OVF;
000070  f64650c5          MOV      r0,#0x6dc5
000074  8028              STRH     r0,[r5,#0]
;;;2797                             return (0u);
000076  2000              MOVS     r0,#0
                  |L24.120|
;;;2798                         }
;;;2799                         break;
;;;2800   
;;;2801                    case 2u:
;;;2802                         if (p_tcb->SemCtr == DEF_INT_16U_MAX_VAL) {
;;;2803                             OS_CRITICAL_EXIT();
;;;2804                            *p_err = OS_ERR_SEM_OVF;
;;;2805                             return (0u);
;;;2806                         }
;;;2807                         break;
;;;2808   
;;;2809                    case 4u:
;;;2810                         if (p_tcb->SemCtr == DEF_INT_32U_MAX_VAL) {
;;;2811                             OS_CRITICAL_EXIT();
;;;2812                            *p_err = OS_ERR_SEM_OVF;
;;;2813                             return (0u);
;;;2814                         }
;;;2815                         break;
;;;2816   
;;;2817                    default:
;;;2818                         break;
;;;2819                }
;;;2820                p_tcb->SemCtr++;                                   /* Task signaled is not pending on anything             */
;;;2821                ctr = p_tcb->SemCtr;
;;;2822                OS_CRITICAL_EXIT();
;;;2823                break;
;;;2824   
;;;2825           case OS_TASK_STATE_PEND:
;;;2826           case OS_TASK_STATE_PEND_TIMEOUT:
;;;2827           case OS_TASK_STATE_PEND_SUSPENDED:
;;;2828           case OS_TASK_STATE_PEND_TIMEOUT_SUSPENDED:
;;;2829                if (p_tcb->PendOn == OS_TASK_PEND_ON_TASK_SEM) {   /* Is task signaled waiting for a signal?               */
;;;2830                    OS_Post(DEF_NULL,                              /* Task is pending on signal                            */
;;;2831                            p_tcb,
;;;2832                            DEF_NULL,
;;;2833                            0u,
;;;2834                            ts);
;;;2835                    ctr = p_tcb->SemCtr;
;;;2836                    OS_CRITICAL_EXIT_NO_SCHED();
;;;2837                    if ((opt & OS_OPT_POST_NO_SCHED) == 0u) {
;;;2838                        OSSched();                                 /* Run the scheduler                                    */
;;;2839                    }
;;;2840                } else {
;;;2841                    switch (sizeof(OS_SEM_CTR)) {
;;;2842                        case 1u:
;;;2843                             if (p_tcb->SemCtr == DEF_INT_08U_MAX_VAL) {
;;;2844                                 OS_CRITICAL_EXIT();
;;;2845                                *p_err = OS_ERR_SEM_OVF;
;;;2846                                 return (0u);
;;;2847                             }
;;;2848                             break;
;;;2849   
;;;2850                        case 2u:
;;;2851                             if (p_tcb->SemCtr == DEF_INT_16U_MAX_VAL) {
;;;2852                                 OS_CRITICAL_EXIT();
;;;2853                                *p_err = OS_ERR_SEM_OVF;
;;;2854                                 return (0u);
;;;2855                             }
;;;2856                             break;
;;;2857   
;;;2858                        case 4u:
;;;2859                             if (p_tcb->SemCtr == DEF_INT_32U_MAX_VAL) {
;;;2860                                 OS_CRITICAL_EXIT();
;;;2861                                *p_err = OS_ERR_SEM_OVF;
;;;2862                                 return (0u);
;;;2863                             }
;;;2864                             break;
;;;2865   
;;;2866                        default:
;;;2867                             break;
;;;2868                    }
;;;2869                    p_tcb->SemCtr++;                               /* No,  Task signaled is NOT pending on semaphore ...   */
;;;2870                    ctr = p_tcb->SemCtr;                           /* ... it must be waiting on something else             */
;;;2871                    OS_CRITICAL_EXIT();
;;;2872                }
;;;2873                break;
;;;2874   
;;;2875           default:
;;;2876                OS_CRITICAL_EXIT();
;;;2877               *p_err = OS_ERR_STATE_INVALID;
;;;2878                ctr   = 0u;
;;;2879                break;
;;;2880       }
;;;2881       return (ctr);
;;;2882   }
000078  e8bd83f8          POP      {r3-r9,pc}
                  |L24.124|
00007c  e026              B        |L24.204|
                  |L24.126|
00007e  f64f71ff          MOV      r1,#0xffff            ;2802
000082  6ce0              LDR      r0,[r4,#0x4c]         ;2802
000084  4288              CMP      r0,r1                 ;2802
000086  d10d              BNE      |L24.164|
000088  bf00              NOP                            ;2803
00008a  f7fffffe          BL       CPU_IntDisMeasStop
00008e  bf00              NOP                            ;2803
000090  4648              MOV      r0,r9                 ;2803
000092  f7fffffe          BL       CPU_SR_Restore
000096  bf00              NOP                            ;2803
000098  bf00              NOP                            ;2803
00009a  f64650c5          MOV      r0,#0x6dc5            ;2804
00009e  8028              STRH     r0,[r5,#0]            ;2804
0000a0  2000              MOVS     r0,#0                 ;2805
0000a2  e7e9              B        |L24.120|
                  |L24.164|
0000a4  e012              B        |L24.204|
                  |L24.166|
0000a6  6ce0              LDR      r0,[r4,#0x4c]         ;2810
0000a8  1c40              ADDS     r0,r0,#1              ;2810
0000aa  b968              CBNZ     r0,|L24.200|
0000ac  bf00              NOP                            ;2811
0000ae  f7fffffe          BL       CPU_IntDisMeasStop
0000b2  bf00              NOP                            ;2811
0000b4  4648              MOV      r0,r9                 ;2811
0000b6  f7fffffe          BL       CPU_SR_Restore
0000ba  bf00              NOP                            ;2811
0000bc  bf00              NOP                            ;2811
0000be  f64650c5          MOV      r0,#0x6dc5            ;2812
0000c2  8028              STRH     r0,[r5,#0]            ;2812
0000c4  2000              MOVS     r0,#0                 ;2813
0000c6  e7d7              B        |L24.120|
                  |L24.200|
0000c8  e000              B        |L24.204|
                  |L24.202|
0000ca  bf00              NOP                            ;2818
                  |L24.204|
0000cc  bf00              NOP                            ;2799
0000ce  6ce0              LDR      r0,[r4,#0x4c]         ;2820
0000d0  1c40              ADDS     r0,r0,#1              ;2820
0000d2  64e0              STR      r0,[r4,#0x4c]         ;2820
0000d4  6ce6              LDR      r6,[r4,#0x4c]         ;2821
0000d6  bf00              NOP                            ;2822
0000d8  f7fffffe          BL       CPU_IntDisMeasStop
0000dc  bf00              NOP                            ;2822
0000de  4648              MOV      r0,r9                 ;2822
0000e0  f7fffffe          BL       CPU_SR_Restore
0000e4  bf00              NOP                            ;2822
0000e6  bf00              NOP                            ;2822
0000e8  e07d              B        |L24.486|
0000ea  bf00              NOP                            ;2826
0000ec  bf00              NOP                            ;2827
0000ee  bf00              NOP                            ;2828
0000f0  f8940034          LDRB     r0,[r4,#0x34]         ;2829
0000f4  2807              CMP      r0,#7                 ;2829
0000f6  d118              BNE      |L24.298|
0000f8  2300              MOVS     r3,#0                 ;2830
0000fa  461a              MOV      r2,r3                 ;2830
0000fc  4621              MOV      r1,r4                 ;2830
0000fe  4618              MOV      r0,r3                 ;2830
000100  9700              STR      r7,[sp,#0]            ;2830
000102  f7fffffe          BL       OS_Post
000106  6ce6              LDR      r6,[r4,#0x4c]         ;2835
000108  bf00              NOP                            ;2836
00010a  f7fffffe          BL       CPU_IntDisMeasStop
00010e  bf00              NOP                            ;2836
000110  4648              MOV      r0,r9                 ;2836
000112  f7fffffe          BL       CPU_SR_Restore
000116  bf00              NOP                            ;2836
000118  bf00              NOP                            ;2836
00011a  f4084000          AND      r0,r8,#0x8000         ;2837
00011e  2800              CMP      r0,#0                 ;2837
000120  d152              BNE      |L24.456|
000122  f7fffffe          BL       OSSched
000126  e04f              B        |L24.456|
                  |L24.296|
000128  e04f              B        |L24.458|
                  |L24.298|
00012a  2004              MOVS     r0,#4                 ;2841
00012c  2801              CMP      r0,#1                 ;2841
00012e  d004              BEQ      |L24.314|
000130  2802              CMP      r0,#2                 ;2841
000132  d014              BEQ      |L24.350|
000134  2804              CMP      r0,#4                 ;2841
000136  d138              BNE      |L24.426|
000138  e025              B        |L24.390|
                  |L24.314|
00013a  6ce0              LDR      r0,[r4,#0x4c]         ;2843
00013c  28ff              CMP      r0,#0xff              ;2843
00013e  d10d              BNE      |L24.348|
000140  bf00              NOP                            ;2844
000142  f7fffffe          BL       CPU_IntDisMeasStop
000146  bf00              NOP                            ;2844
000148  4648              MOV      r0,r9                 ;2844
00014a  f7fffffe          BL       CPU_SR_Restore
00014e  bf00              NOP                            ;2844
000150  bf00              NOP                            ;2844
000152  f64650c5          MOV      r0,#0x6dc5            ;2845
000156  8028              STRH     r0,[r5,#0]            ;2845
000158  2000              MOVS     r0,#0                 ;2846
00015a  e78d              B        |L24.120|
                  |L24.348|
00015c  e026              B        |L24.428|
                  |L24.350|
00015e  f64f71ff          MOV      r1,#0xffff            ;2851
000162  6ce0              LDR      r0,[r4,#0x4c]         ;2851
000164  4288              CMP      r0,r1                 ;2851
000166  d10d              BNE      |L24.388|
000168  bf00              NOP                            ;2852
00016a  f7fffffe          BL       CPU_IntDisMeasStop
00016e  bf00              NOP                            ;2852
000170  4648              MOV      r0,r9                 ;2852
000172  f7fffffe          BL       CPU_SR_Restore
000176  bf00              NOP                            ;2852
000178  bf00              NOP                            ;2852
00017a  f64650c5          MOV      r0,#0x6dc5            ;2853
00017e  8028              STRH     r0,[r5,#0]            ;2853
000180  2000              MOVS     r0,#0                 ;2854
000182  e779              B        |L24.120|
                  |L24.388|
000184  e012              B        |L24.428|
                  |L24.390|
000186  6ce0              LDR      r0,[r4,#0x4c]         ;2859
000188  1c40              ADDS     r0,r0,#1              ;2859
00018a  b968              CBNZ     r0,|L24.424|
00018c  bf00              NOP                            ;2860
00018e  f7fffffe          BL       CPU_IntDisMeasStop
000192  bf00              NOP                            ;2860
000194  4648              MOV      r0,r9                 ;2860
000196  f7fffffe          BL       CPU_SR_Restore
00019a  bf00              NOP                            ;2860
00019c  bf00              NOP                            ;2860
00019e  f64650c5          MOV      r0,#0x6dc5            ;2861
0001a2  8028              STRH     r0,[r5,#0]            ;2861
0001a4  2000              MOVS     r0,#0                 ;2862
0001a6  e767              B        |L24.120|
                  |L24.424|
0001a8  e000              B        |L24.428|
                  |L24.426|
0001aa  bf00              NOP                            ;2867
                  |L24.428|
0001ac  bf00              NOP                            ;2848
0001ae  6ce0              LDR      r0,[r4,#0x4c]         ;2869
0001b0  1c40              ADDS     r0,r0,#1              ;2869
0001b2  64e0              STR      r0,[r4,#0x4c]         ;2869
0001b4  6ce6              LDR      r6,[r4,#0x4c]         ;2870
0001b6  bf00              NOP                            ;2871
0001b8  f7fffffe          BL       CPU_IntDisMeasStop
0001bc  bf00              NOP                            ;2871
0001be  4648              MOV      r0,r9                 ;2871
0001c0  f7fffffe          BL       CPU_SR_Restore
0001c4  bf00              NOP                            ;2871
0001c6  bf00              NOP                            ;2871
                  |L24.456|
0001c8  e00d              B        |L24.486|
                  |L24.458|
0001ca  bf00              NOP                            ;2876
0001cc  f7fffffe          BL       CPU_IntDisMeasStop
0001d0  bf00              NOP                            ;2876
0001d2  4648              MOV      r0,r9                 ;2876
0001d4  f7fffffe          BL       CPU_SR_Restore
0001d8  bf00              NOP                            ;2876
0001da  bf00              NOP                            ;2876
0001dc  f646602d          MOV      r0,#0x6e2d            ;2877
0001e0  8028              STRH     r0,[r5,#0]            ;2877
0001e2  2600              MOVS     r6,#0                 ;2878
0001e4  bf00              NOP                            ;2879
                  |L24.486|
0001e6  bf00              NOP                            ;2823
0001e8  4630              MOV      r0,r6                 ;2881
0001ea  e745              B        |L24.120|
;;;2883   
                          ENDP

                  |L24.492|
                          DCD      OSTCBCurPtr

                          AREA ||i.OS_TaskSuspend||, CODE, READONLY, ALIGN=2

                  OS_TaskSuspend PROC
;;;2999   #if (OS_CFG_TASK_SUSPEND_EN == DEF_ENABLED)
;;;3000   void  OS_TaskSuspend (OS_TCB  *p_tcb,
000000  b570              PUSH     {r4-r6,lr}
;;;3001                         OS_ERR  *p_err)
;;;3002   {
000002  4604              MOV      r4,r0
000004  460d              MOV      r5,r1
;;;3003       CPU_SR_ALLOC();
000006  2600              MOVS     r6,#0
;;;3004   
;;;3005   
;;;3006       CPU_CRITICAL_ENTER();
000008  bf00              NOP      
00000a  bf00              NOP      
00000c  f7fffffe          BL       CPU_SR_Save
000010  4606              MOV      r6,r0
000012  bf00              NOP      
000014  f7fffffe          BL       CPU_IntDisMeasStart
000018  bf00              NOP      
;;;3007       if (p_tcb == DEF_NULL) {                                    /* See if specified to suspend self                     */
00001a  b994              CBNZ     r4,|L25.66|
;;;3008           if (OSRunning != OS_STATE_OS_RUNNING) {                 /* Can't suspend self when the kernel isn't running     */
00001c  4857              LDR      r0,|L25.380|
00001e  7800              LDRB     r0,[r0,#0]  ; OSRunning
000020  2801              CMP      r0,#1
000022  d00c              BEQ      |L25.62|
;;;3009               CPU_CRITICAL_EXIT();
000024  bf00              NOP      
000026  f7fffffe          BL       CPU_IntDisMeasStop
00002a  bf00              NOP      
00002c  4630              MOV      r0,r6
00002e  f7fffffe          BL       CPU_SR_Restore
000032  bf00              NOP      
000034  bf00              NOP      
;;;3010              *p_err = OS_ERR_OS_NOT_RUNNING;
000036  f6456089          MOV      r0,#0x5e89
00003a  8028              STRH     r0,[r5,#0]
                  |L25.60|
;;;3011               return;
;;;3012           }
;;;3013           p_tcb = OSTCBCurPtr;
;;;3014       }
;;;3015   
;;;3016       if (p_tcb == OSTCBCurPtr) {
;;;3017           if (OSSchedLockNestingCtr > 0u) {                       /* Can't suspend when the scheduler is locked           */
;;;3018               CPU_CRITICAL_EXIT();
;;;3019              *p_err = OS_ERR_SCHED_LOCKED;
;;;3020               return;
;;;3021           }
;;;3022       }
;;;3023   
;;;3024      *p_err = OS_ERR_NONE;
;;;3025       switch (p_tcb->TaskState) {
;;;3026           case OS_TASK_STATE_RDY:
;;;3027                OS_CRITICAL_ENTER_CPU_EXIT();
;;;3028                p_tcb->TaskState  =  OS_TASK_STATE_SUSPENDED;
;;;3029                p_tcb->SuspendCtr = 1u;
;;;3030                OS_RdyListRemove(p_tcb);
;;;3031                OS_CRITICAL_EXIT_NO_SCHED();
;;;3032                break;
;;;3033   
;;;3034           case OS_TASK_STATE_DLY:
;;;3035                p_tcb->TaskState  = OS_TASK_STATE_DLY_SUSPENDED;
;;;3036                p_tcb->SuspendCtr = 1u;
;;;3037                CPU_CRITICAL_EXIT();
;;;3038                break;
;;;3039   
;;;3040           case OS_TASK_STATE_PEND:
;;;3041                p_tcb->TaskState  = OS_TASK_STATE_PEND_SUSPENDED;
;;;3042                p_tcb->SuspendCtr = 1u;
;;;3043                CPU_CRITICAL_EXIT();
;;;3044                break;
;;;3045   
;;;3046           case OS_TASK_STATE_PEND_TIMEOUT:
;;;3047                p_tcb->TaskState  = OS_TASK_STATE_PEND_TIMEOUT_SUSPENDED;
;;;3048                p_tcb->SuspendCtr = 1u;
;;;3049                CPU_CRITICAL_EXIT();
;;;3050                break;
;;;3051   
;;;3052           case OS_TASK_STATE_SUSPENDED:
;;;3053           case OS_TASK_STATE_DLY_SUSPENDED:
;;;3054           case OS_TASK_STATE_PEND_SUSPENDED:
;;;3055           case OS_TASK_STATE_PEND_TIMEOUT_SUSPENDED:
;;;3056   			if (p_tcb->SuspendCtr == (OS_NESTING_CTR)-1) {
;;;3057                    CPU_CRITICAL_EXIT();
;;;3058                   *p_err = OS_ERR_TASK_SUSPEND_CTR_OVF;
;;;3059                    return;
;;;3060                }
;;;3061                p_tcb->SuspendCtr++;
;;;3062                CPU_CRITICAL_EXIT();
;;;3063                break;
;;;3064   
;;;3065           default:
;;;3066                CPU_CRITICAL_EXIT();
;;;3067               *p_err = OS_ERR_STATE_INVALID;
;;;3068                return;
;;;3069       }
;;;3070   
;;;3071       if (OSRunning == OS_STATE_OS_RUNNING) {                     /* Only schedule when the kernel is running             */
;;;3072           OSSched();
;;;3073       }
;;;3074   }
00003c  bd70              POP      {r4-r6,pc}
                  |L25.62|
00003e  4850              LDR      r0,|L25.384|
000040  6804              LDR      r4,[r0,#0]            ;3013  ; OSTCBCurPtr
                  |L25.66|
000042  484f              LDR      r0,|L25.384|
000044  6800              LDR      r0,[r0,#0]            ;3016  ; OSTCBCurPtr
000046  4284              CMP      r4,r0                 ;3016
000048  d10f              BNE      |L25.106|
00004a  484e              LDR      r0,|L25.388|
00004c  7800              LDRB     r0,[r0,#0]            ;3017  ; OSSchedLockNestingCtr
00004e  b160              CBZ      r0,|L25.106|
000050  bf00              NOP                            ;3018
000052  f7fffffe          BL       CPU_IntDisMeasStop
000056  bf00              NOP                            ;3018
000058  4630              MOV      r0,r6                 ;3018
00005a  f7fffffe          BL       CPU_SR_Restore
00005e  bf00              NOP                            ;3018
000060  bf00              NOP                            ;3018
000062  f6465063          MOV      r0,#0x6d63            ;3019
000066  8028              STRH     r0,[r5,#0]            ;3019
000068  e7e8              B        |L25.60|
                  |L25.106|
00006a  2000              MOVS     r0,#0                 ;3024
00006c  8028              STRH     r0,[r5,#0]            ;3024
00006e  f8940036          LDRB     r0,[r4,#0x36]         ;3025
000072  2808              CMP      r0,#8                 ;3025
000074  d26b              BCS      |L25.334|
000076  e8dff000          TBB      [pc,r0]               ;3025
00007a  0417              DCB      0x04,0x17
00007c  27374748          DCB      0x27,0x37,0x47,0x48
000080  494a              DCB      0x49,0x4a
000082  2004              MOVS     r0,#4                 ;3028
000084  f8840036          STRB     r0,[r4,#0x36]         ;3028
000088  2001              MOVS     r0,#1                 ;3029
00008a  f8840086          STRB     r0,[r4,#0x86]         ;3029
00008e  4620              MOV      r0,r4                 ;3030
000090  f7fffffe          BL       OS_RdyListRemove
000094  bf00              NOP                            ;3031
000096  f7fffffe          BL       CPU_IntDisMeasStop
00009a  bf00              NOP                            ;3031
00009c  4630              MOV      r0,r6                 ;3031
00009e  f7fffffe          BL       CPU_SR_Restore
0000a2  bf00              NOP                            ;3031
0000a4  bf00              NOP                            ;3031
0000a6  e05f              B        |L25.360|
0000a8  2005              MOVS     r0,#5                 ;3035
0000aa  f8840036          STRB     r0,[r4,#0x36]         ;3035
0000ae  2001              MOVS     r0,#1                 ;3036
0000b0  f8840086          STRB     r0,[r4,#0x86]         ;3036
0000b4  bf00              NOP                            ;3037
0000b6  f7fffffe          BL       CPU_IntDisMeasStop
0000ba  bf00              NOP                            ;3037
0000bc  4630              MOV      r0,r6                 ;3037
0000be  f7fffffe          BL       CPU_SR_Restore
0000c2  bf00              NOP                            ;3037
0000c4  bf00              NOP                            ;3037
0000c6  e04f              B        |L25.360|
0000c8  2006              MOVS     r0,#6                 ;3041
0000ca  f8840036          STRB     r0,[r4,#0x36]         ;3041
0000ce  2001              MOVS     r0,#1                 ;3042
0000d0  f8840086          STRB     r0,[r4,#0x86]         ;3042
0000d4  bf00              NOP                            ;3043
0000d6  f7fffffe          BL       CPU_IntDisMeasStop
0000da  bf00              NOP                            ;3043
0000dc  4630              MOV      r0,r6                 ;3043
0000de  f7fffffe          BL       CPU_SR_Restore
0000e2  bf00              NOP                            ;3043
0000e4  bf00              NOP                            ;3043
0000e6  e03f              B        |L25.360|
0000e8  2007              MOVS     r0,#7                 ;3047
0000ea  f8840036          STRB     r0,[r4,#0x36]         ;3047
0000ee  2001              MOVS     r0,#1                 ;3048
0000f0  f8840086          STRB     r0,[r4,#0x86]         ;3048
0000f4  bf00              NOP                            ;3049
0000f6  f7fffffe          BL       CPU_IntDisMeasStop
0000fa  bf00              NOP                            ;3049
0000fc  4630              MOV      r0,r6                 ;3049
0000fe  f7fffffe          BL       CPU_SR_Restore
000102  bf00              NOP                            ;3049
000104  bf00              NOP                            ;3049
000106  e02f              B        |L25.360|
000108  bf00              NOP                            ;3053
00010a  bf00              NOP                            ;3054
00010c  bf00              NOP                            ;3055
00010e  f8940086          LDRB     r0,[r4,#0x86]         ;3056
000112  28ff              CMP      r0,#0xff              ;3056
000114  d10c              BNE      |L25.304|
000116  bf00              NOP                            ;3057
000118  f7fffffe          BL       CPU_IntDisMeasStop
00011c  bf00              NOP                            ;3057
00011e  4630              MOV      r0,r6                 ;3057
000120  f7fffffe          BL       CPU_SR_Restore
000124  bf00              NOP                            ;3057
000126  bf00              NOP                            ;3057
000128  f2471060          MOV      r0,#0x7160            ;3058
00012c  8028              STRH     r0,[r5,#0]            ;3058
00012e  e785              B        |L25.60|
                  |L25.304|
000130  f8940086          LDRB     r0,[r4,#0x86]         ;3061
000134  1c40              ADDS     r0,r0,#1              ;3061
000136  f8840086          STRB     r0,[r4,#0x86]         ;3061
00013a  bf00              NOP                            ;3062
00013c  f7fffffe          BL       CPU_IntDisMeasStop
000140  bf00              NOP                            ;3062
000142  4630              MOV      r0,r6                 ;3062
000144  f7fffffe          BL       CPU_SR_Restore
000148  bf00              NOP                            ;3062
00014a  bf00              NOP                            ;3062
00014c  e00c              B        |L25.360|
                  |L25.334|
00014e  bf00              NOP                            ;3066
000150  f7fffffe          BL       CPU_IntDisMeasStop
000154  bf00              NOP                            ;3066
000156  4630              MOV      r0,r6                 ;3066
000158  f7fffffe          BL       CPU_SR_Restore
00015c  bf00              NOP                            ;3066
00015e  bf00              NOP                            ;3066
000160  f646602d          MOV      r0,#0x6e2d            ;3067
000164  8028              STRH     r0,[r5,#0]            ;3067
000166  e769              B        |L25.60|
                  |L25.360|
000168  bf00              NOP                            ;3032
00016a  4804              LDR      r0,|L25.380|
00016c  7800              LDRB     r0,[r0,#0]            ;3071  ; OSRunning
00016e  2801              CMP      r0,#1                 ;3071
000170  d101              BNE      |L25.374|
000172  f7fffffe          BL       OSSched
                  |L25.374|
000176  bf00              NOP      
000178  e760              B        |L25.60|
;;;3075   #endif
                          ENDP

00017a  0000              DCW      0x0000
                  |L25.380|
                          DCD      OSRunning
                  |L25.384|
                          DCD      OSTCBCurPtr
                  |L25.388|
                          DCD      OSSchedLockNestingCtr
